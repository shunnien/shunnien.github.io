<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ShunNien&#39;s Blog</title>
  
  <subtitle>不積跬步，無以致千里；不積小流，無以成江海。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://shunnien.github.io/"/>
  <updated>2019-06-28T08:43:44.029Z</updated>
  <id>https://shunnien.github.io/</id>
  
  <author>
    <name>ShunNien Yu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>PowerShell 美化配置</title>
    <link href="https://shunnien.github.io/2019/06/28/powershell-theme-and-font/"/>
    <id>https://shunnien.github.io/2019/06/28/powershell-theme-and-font/</id>
    <published>2019-06-28T08:41:09.000Z</published>
    <updated>2019-06-28T08:43:44.029Z</updated>
    
    <content type="html"><![CDATA[<h2 id="PowerShell-美化配置"><a href="#PowerShell-美化配置" class="headerlink" title="PowerShell 美化配置"></a>PowerShell 美化配置</h2><p><strong>powershell</strong> 是 windows 目前很好用的工具，可以調整一些設定與安裝一些模組功能來美化它。<a id="more"></a></p><h2 id="Terminal-與-Shell"><a href="#Terminal-與-Shell" class="headerlink" title="Terminal 與 Shell"></a>Terminal 與 Shell</h2><ul><li>Windows 的<strong>命令提示字元 (Command Prompt)</strong>，實際上就是打開了一個終端 (Terminal)</li><li>在終端裡面<strong>輸入命令，得到結果</strong>的互動程式，就是命令行解釋器 (Shell)</li></ul><h2 id="主題樣式"><a href="#主題樣式" class="headerlink" title="主題樣式"></a>主題樣式</h2><p>個人推薦的主題樣式是 <a href="https://github.com/JanDeDobbeleer/oh-my-posh" target="_blank" rel="noopener"><strong>oh-my-posh</strong></a>，此主題類似 <strong>Mac OS X</strong> 的 <a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener"><strong>oh-my-zsh</strong></a>，不過因為 <a href="https://github.com/JanDeDobbeleer/oh-my-posh" target="_blank" rel="noopener"><strong>oh-my-posh</strong></a> 有部分的指令倚賴 <a href="https://github.com/dahlbyk/posh-git" target="_blank" rel="noopener"><strong>post-git</strong></a>，所以需要兩者都安裝。注意需要使用<strong>系統管理員權限</strong>啟動 <strong>powershell</strong> 來安裝，安裝指令如下：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> posh-git -Scope CurrentUser</span><br><span class="line"><span class="built_in">Install-Module</span> oh-my-posh -Scope CurrentUser</span><br><span class="line">Set-Theme Paradox</span><br></pre></td></tr></table></figure><p>安裝好之後，不滿意 <strong>Paradox</strong> 樣式的話，可以自行更換，<a href="https://github.com/JanDeDobbeleer/oh-my-posh" target="_blank" rel="noopener"><strong>oh-my-posh</strong></a> 提供了 10 個主題樣式，只要在 <strong>PowerShell</strong> 中輸入 <code>Theme</code> 就可以查看有哪些主題樣式</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">❯ theme</span><br><span class="line"></span><br><span class="line">Name         Type     Location</span><br><span class="line">----         ----     --------</span><br><span class="line">Agnoster     Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\Agnoster.psm1</span><br><span class="line">Avit         Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\Avit.psm1</span><br><span class="line">Darkblood    Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\Darkblood.psm1</span><br><span class="line">Fish         Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\Fish.psm1</span><br><span class="line">Honukai      Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\Honukai.psm1</span><br><span class="line">Paradox      Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\Paradox.psm1</span><br><span class="line">PowerLine    Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\PowerLine.psm1</span><br><span class="line">pure         Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\pure.psm1</span><br><span class="line">robbyrussell Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\robbyrussell.psm1</span><br><span class="line">Sorin        Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\Sorin.psm1</span><br><span class="line">tehrob       Defaults C:\Program Files\WindowsPowerShell\Modules\oh-my-posh\<span class="number">2.0</span>.<span class="number">263</span>\Themes\tehrob.psm1</span><br></pre></td></tr></table></figure><p>想要更換主題樣式的話，設定指令如下，<code>Set-Theme</code> 指令後接上想要設定主題樣式名稱</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Theme Darkblood</span><br></pre></td></tr></table></figure><h3 id="設定每次啟用-Powershell-的主題"><a href="#設定每次啟用-Powershell-的主題" class="headerlink" title="設定每次啟用 Powershell 的主題"></a>設定每次啟用 Powershell 的主題</h3><p>上述設定完成後，現在使用的 <strong>PowerShell</strong> 畫面變漂亮了，但是 <strong>PowerShell</strong> 每次執行都是原始介面，所以需要設定，以下是設定步驟</p><h4 id="新增或修改-profile-檔案"><a href="#新增或修改-profile-檔案" class="headerlink" title="新增或修改 $profile 檔案"></a>新增或修改 <strong>$profile</strong> 檔案</h4><p>先開啟 <strong>powershell</strong> 輸入以下指令</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果之前沒有檔案，就建立一個新檔案</span></span><br><span class="line"><span class="keyword">if</span> (!(<span class="built_in">Test-Path</span> -Path <span class="variable">$PROFILE</span> )) &#123; <span class="built_in">New-Item</span> -Type File -Path <span class="variable">$PROFILE</span> -Force &#125;</span><br><span class="line"><span class="comment"># 用 vscode 開啟檔案</span></span><br><span class="line">code <span class="variable">$profile</span></span><br></pre></td></tr></table></figure><p>上述指令會建立 <strong>profile</strong> 檔案，但是需要注意的是，使用<strong>管理者權限執行的路徑</strong>與現在使用者的 <strong>profile</strong> 路徑不同，在 <strong>powershell</strong> 內，<strong>$profile</strong> 預設就是目前使用者的路徑(等同 <strong>$profile.CurrentUserCurrentHost</strong> )，一共有四種選擇，但是檔案路徑組合(32位元與64位元的搭配)會有多達 <strong>9</strong> 種，有興趣的可以參考<a href="https://blog.simonw.se/using-powershell-profiles/" target="_blank" rel="noopener">此篇文章</a></p><ul><li><code>$profile.CurrentUserAllHosts</code></li><li><code>$profile.CurrentUserCurrentHost</code></li><li><code>$profile.AllUsersAllHosts</code></li><li><code>$profile.AllUsersCurrentHost</code></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">❯ <span class="variable">$PROFILE</span> | <span class="built_in">Select-Object</span> -Property *</span><br><span class="line">AllUsersAllHosts       : C:\Windows\System32\WindowsPowerShell\v1.<span class="number">0</span>\profile.ps1</span><br><span class="line">AllUsersCurrentHost    : C:\Windows\System32\WindowsPowerShell\v1.<span class="number">0</span>\Microsoft.PowerShell_profile.ps1</span><br><span class="line">CurrentUserAllHosts    : C:\Users\Shunnien Yu\Documents\WindowsPowerShell\profile.ps1</span><br><span class="line">CurrentUserCurrentHost : C:\Users\Shunnien Yu\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</span><br><span class="line">Length                 : <span class="number">81</span></span><br></pre></td></tr></table></figure><p>想要設定為不管是否使用管理者權限執行都是相同的畫面的話，需要設定 <strong>AllUsersAllHosts</strong> ，設定這個檔案後，其他檔案就可以不用設定了，網路上有可以<a href="https://github.com/microexs/PowerAdmin/blob/master/PCInit.md" target="_blank" rel="noopener">參考的設定範本</a>，以下是我自己的設定</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">chcp <span class="number">65001</span></span><br><span class="line"><span class="built_in">Set-PSReadlineOption</span> -EditMode Emacs</span><br><span class="line"><span class="keyword">function</span> which(<span class="variable">$name</span>) &#123; <span class="built_in">Get-Command</span> <span class="variable">$name</span> | <span class="built_in">Select-Object</span> Definition &#125;</span><br><span class="line"><span class="keyword">function</span> rmrf(<span class="variable">$item</span>) &#123; <span class="built_in">Remove-Item</span> <span class="variable">$item</span> -Recurse -Force &#125;</span><br><span class="line"><span class="keyword">function</span> mkfile(<span class="variable">$file</span>) &#123; <span class="string">""</span> | <span class="built_in">Out-File</span> <span class="variable">$file</span> -Encoding ASCII &#125;</span><br><span class="line"><span class="keyword">function</span> getMyDoc() &#123; <span class="built_in">Set-Location</span> <span class="string">"C:\Users\Shunnien Yu\Documents\"</span> &#125;</span><br><span class="line"><span class="keyword">function</span> getGitOneLineGraphLog() &#123; git log --oneline --all --graph --decorate &#125;</span><br><span class="line"><span class="built_in">Import-Module</span> posh-git</span><br><span class="line"><span class="built_in">Import-Module</span> oh-my-posh</span><br><span class="line"><span class="built_in">Import-Module</span> Get-ChildItemColor</span><br><span class="line"><span class="built_in">Set-Alias</span> l Get-ChildItemColor -option AllScope</span><br><span class="line"><span class="built_in">Set-Alias</span> ls Get-ChildItemColorFormatWide -option AllScope</span><br><span class="line"><span class="built_in">Set-Alias</span> ... getMyDoc -option AllScope</span><br><span class="line"><span class="built_in">Set-Alias</span> ggl getGitOneLineGraphLog -option AllScope</span><br><span class="line">Set-Theme PowerLine</span><br></pre></td></tr></table></figure><h2 id="字型"><a href="#字型" class="headerlink" title="字型"></a>字型</h2><p>設定為上述的檔案後，<strong>powershell</strong> 在有 <strong>git</strong> 版控的資料夾路徑時，會使用 <strong>PowerLine</strong> 字體，但是由於目前的字型不支援會像下圖</p><p><img src="https://lh3.googleusercontent.com/ydZPSwjcR6TwBreZBDL5_7CTTysc4jg2Djdn2SsRtJh3EtUX69N_qqfpYLYT_54GPRKB5Cq2_6K2wmVU4AVM3kMUYwB_hefoAEapzuQ1Z-mqqcFCdvo258pKBYr4z4t3nzzuHRyNFBONGqQHtZ1L7C-swmLZHIKyA_guEtxw-N5lR9rMXO8ZdO7vQLVv5_f8dWhn3bhMvUDa75H0ZurXtUiMmi1qpUKFo2z0ycwL8mdvMOwAyGe-9zSeSzf9UqyC5eyfgmIxzH2yS1GvVmLvl04QArsi8gGUt65GDQRQHuXFffwZxHWujk4uvNzOKY9M5F5RmcT6OQzNl_8nK6SaHD4yaeFkI4nLSiSuiQ3NVY9pARNlstg16-wJuDDHjZVWNZ1RLve-SwqxQrZWrcgDDeXR08gClzJeudzJbJnfhMMcr1-w6lwUiURq27I-c5_zJyjLXu1NnN7Sx-KNElSnokqHGhiQlCrWjmOaPEJootMFtiSrwzA7_naE2ZAOnoPAEMEGMppvdhBkRHn7IZhvD0YcDnXznM3ggx7YKOJ3swkfYdBiDSAQurh2mY5oLnlfGq5tU-b8CH0XbIcQqb_xiMY1b01_NYViW1QQ3rtnLiBh8nkiVdHM2LbRkDD_Ynue-UDFYP-6Xzf8Fh-WiYjkuGjKbTfNjrt-l6ZDnJzBUmU8rlR3mfiUKXLn3pYHjIsGkFaOrKJsTdi5dXWrKCwZb8FV=w959-h145-no" alt="no powerline font"></p><p>所以需要裝有支援 <strong>PowerLine</strong> 的字型，我個人使用 <a href="https://github.com/be5invis/Sarasa-Gothic" target="_blank" rel="noopener">Sarasa Gothic (更纱黑体 / 更紗黑體 / 更紗ゴシック) 字型</a>，可以由<a href="https://github.com/be5invis/Sarasa-Gothic" target="_blank" rel="noopener">Sarasa Gothic 字型</a>的 Github Release 下載</p><p><img src="https://lh3.googleusercontent.com/nY-3twm_cW385iVETvxfsNqSIqUufYHdUg3A-nxKY4DA-YsIYTFq57rGuz6Vjj9cTEqePsvJULa8D2WKFQDz1FeRvgktP5uw929rvDQDR-zWLt_u5eMAF1dFNyVYLmuMTRhq7Y67Hk3S41rhROf047quXgvSNA-aFiz4tRGgaxLItIxEA5vkGDtdrU2WDUvVUv-_64RShhtyIKuE504s9kvFhbtyEaUATAfey7HUB4-uFa4bbcrwBjr-pufGW66uncSI7WiBkxNIufrLGVA0GCWKkZakNgghl4XKpXQ0qqnX6E67Ye8wNGlyI1DuCz2TvncJRiI-IY2nkXLeRnMlgRbrsJRojyx2RLldEbx1mRqYoD1q-wNKF3kwD6CpHQuY5O7zucyb5vKOZDki_xkcWgJEEC_C9UvxPxala_c2kbncF_242Uvr7S-WX9g4DqLPKAuDKIlRNjYaIJo9-3gV-4FoqKBdjk8vd-n3Qlg3Ox1O0VGbGWGNC9enkjHMmxXAaJ_zeXASH7fNNd5v2QVzFNjrC2WMbraaoOT-T8545bC5VESXqIwvJwE6a_NR_-NSEeCNZE6zkquiXDkHhniWDybSazCHxXfAntgGJkosu2VAwuMweYGYXBuX6x2afnnn7vm49VC9Es6cr8hyrQkM8Zgw-yWN-DJvKOfXbqeV8SGxa0miIb7rai4_VZoVTqq4L51mFvGoTuCj9Kd0pq25f6Vf=w795-h691-no" alt="Sarasa Gothic github release"></p><p>之後直接在 <strong>Powershell</strong> 的 <strong>Properties</strong> 內設定字型，我個人使用 <strong>Sarasa Term TC</strong></p><p><img src="https://lh3.googleusercontent.com/rYo4MF1iQkB0VhhWxETUJ50-zlN8dOYmFVYg0pkiX0X7XHJ2zljNl05Te0yWm79NBFfyz5bnckVeR4YJHxas-iqseUbyXs-nCJmKyjMEqCdTCliuwVMDdyBsx3REHRe-2jvPu9mJeiaj5jJZY_KbD5-Tl_ibppn4MbBUqIlMAC8tkAPra_jtDX6sG7S79rRgCzncEQmnqLwxfP3zQfFYPbKqetEK3xoI_8cz0gW94R4MxFYRqIXMjTpfN-iec3zKhTdTqbvIr_R8HVKf_fZM0_wS_kD-zD2Exv186uU9MY8PZkYXdVK3MGUzgKAxIhqSHgG4VWaKkXs_zB_OBWWm78N85qzlrwAV8dXEn7QkHDK0ZIkK_BnZAL7UHwbVP_pXRPYiXgrDOjShru30SbKaa2Y7-7fTvGnxH0pLmK7WW9ObsMGgn3vu_tDmLL9JfCWq4XuMIpVMrC9WqZebnurNmx2g7XuFKmvO28aJ1JQne0hQ6eSsImanoKg2q8ieTeJiuVFPf7Aazl0iejgVaUDX3JrM8l3nTUjrabfh1pS_LRbf8dCS-WhsF8Z0mbn-nOwZ6QaijJ2zQFKYckIivYMCwC0fXUcpQ9IQ9dG-p2_Fkj570QdiYF1Kbfc3Uhm2DpmY5cPK-GP8JFgsa1zFlho9FZgmFAtWD9_STX06w_5QCea1CqSoLg-2WEK3egjUwuNHE1tNs_Pnx7v-LpkvK76rzqNc=w456-h136-no" alt="powershell properties font set"></p><p>設定好之後，<strong>powershell</strong> 的畫面中就可以顯示符號</p><p><img src="https://lh3.googleusercontent.com/Rc_cU4rb9QIfRWd-Lft2plHvrnQstqjjo8rGjN9KOTw1v4ylskW1yCH90N4bqJabTPOsdz5UbUr85zjl6pOLIEjoaLK2l99gL0LI3ddE2-bXWXzFYeSUm3SN-oyEHGe-OBh6JExA7lRe2-6FEcL2NAa71lUMCslSBlJ4npOdVTDOkICvKwkVdfZvQZLWvZOQi_9s69EscbWytOvo6C_feaDPliCw_nzx1-QuOBSBrWhtuadHQsd7uhOFspvEdIoC7p0KeWQpeBRxRhhedFf2uCCEFI7XXskdUZuegaI3mtD6qBvJLv1oYb_x9J5GTGCbG8gfTNyTc8nCXGndl6qwc-2EfB57FhrCMSBE5cGNrEm9NaYq6tZsRyT1a5Ah_0ax1sEY3nwi9qaH8gF53Brwc-V3iwvLWezFxtjZ4pnZ5_-4F5SUxGNk6qLWMoRoqIl5g649rbi2tjRFLIADLTiDvGkuNoN3WVkNfyyqyFHfNwLRQWc6TIOatf4C2BENJ5uKyOQPG5H1N-olcRG6nqvwnnkMNl_wt7rMkosd5-SBtRnbCzmvv9C2kCh8pBS9e_86XdHcC2wAPTPzk6Xp7uWkbUzsAq7EyT42-tXYDh48o8FXSnxcAJtHWAxcC79OdXMM9qEtZWQH9wPkDwTeFJICCy0Zrn9CpuWzfMVbvDrycojUJ2lgN0NJxR6jexLe4kxNWSw5TDIKpQ781ihLJYFfboS7=w800-h143-no" alt="powershll have powerline font"></p><h2 id="PowerShell-配色"><a href="#PowerShell-配色" class="headerlink" title="PowerShell 配色"></a>PowerShell 配色</h2><p>都設定好之後，如果對於 <strong>powershell</strong> 的配色不滿意的話，可以安裝 <a href="https://github.com/microsoft/terminal/releases" target="_blank" rel="noopener"><strong>ColorTool</strong></a> 這個微軟提供的工具，安裝方式直接下載 <strong>Release</strong>，解壓縮後的資料夾路徑加入倒環境變數中，直接就可以執行指令 <code>colortool</code><br>想添加新的樣式的話，可以上 <a href="https://github.com/mbadolato/iTerm2-Color-Schemes" target="_blank" rel="noopener">iTerm2-Color-Schemes</a> 尋找符合各自需求的樣式，加入至 <strong>schemes</strong> 資料夾內即可；假如是透過 <strong>chocolatey</strong> 安裝的話，添加樣式的路徑在 <code>C:\ProgramData\chocolatey\lib\colortool\content\schemes</code></p><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://sspai.com/post/52868" target="_blank" rel="noopener">告别 Windows 终端的难看难用，从改造 PowerShell 的外观开始</a></li><li><a href="https://sspai.com/post/52907" target="_blank" rel="noopener">5 个 PowerShell 主题，让你的 Windows 终端更好看</a></li><li><a href="https://zhuanlan.zhihu.com/p/51901035" target="_blank" rel="noopener">超酷的 PowerShell 美化指南</a></li><li><a href="https://github.com/microexs/PowerAdmin/blob/master/PCInit.md" target="_blank" rel="noopener">配置命令行界面的初始化配置</a></li><li><a href="https://github.com/dahlbyk/posh-git" target="_blank" rel="noopener">Github posh-git</a></li><li><a href="https://github.com/JanDeDobbeleer/oh-my-posh" target="_blank" rel="noopener">Github oh-my-posh</a></li><li><a href="https://coolcode.org/2018/03/16/how-to-make-your-powershell-beautiful/" target="_blank" rel="noopener">PowerShell 美化指南</a></li><li><a href="https://github.com/be5invis/Sarasa-Gothic" target="_blank" rel="noopener">Github Sarasa Gothic (更纱黑体 / 更紗黑體 / 更紗ゴシック) 字型</a></li><li><a href="https://github.com/microsoft/terminal/releases" target="_blank" rel="noopener">Github Microsoft ColorTool download</a></li><li><a href="https://github.com/Microsoft/Terminal/tree/master/src/tools/ColorTool" target="_blank" rel="noopener">Github Microsoft ColorTool</a></li><li><a href="https://blog.simonw.se/using-powershell-profiles/" target="_blank" rel="noopener">PowerShell profiles</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;PowerShell-美化配置&quot;&gt;&lt;a href=&quot;#PowerShell-美化配置&quot; class=&quot;headerlink&quot; title=&quot;PowerShell 美化配置&quot;&gt;&lt;/a&gt;PowerShell 美化配置&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;powershell&lt;/strong&gt; 是 windows 目前很好用的工具，可以調整一些設定與安裝一些模組功能來美化它。
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="Windows" scheme="https://shunnien.github.io/tags/Windows/"/>
    
      <category term="powershell" scheme="https://shunnien.github.io/tags/powershell/"/>
    
  </entry>
  
  <entry>
    <title>解決 Microsoft.SqlServer.Types 參考使用的問題</title>
    <link href="https://shunnien.github.io/2019/06/24/Microsoft-SqlServer-Types-assembly/"/>
    <id>https://shunnien.github.io/2019/06/24/Microsoft-SqlServer-Types-assembly/</id>
    <published>2019-06-24T04:01:14.000Z</published>
    <updated>2019-06-24T04:02:59.710Z</updated>
    
    <content type="html"><![CDATA[<h2 id="解決-Microsoft-SqlServer-Types-參考使用的問題"><a href="#解決-Microsoft-SqlServer-Types-參考使用的問題" class="headerlink" title="解決 Microsoft.SqlServer.Types 參考使用的問題"></a>解決 Microsoft.SqlServer.Types 參考使用的問題</h2><p>透過 <strong>Entity Framework</strong> 使用 <strong>SQL Server</strong> 的空間資料 (<strong>DbGeography</strong>) 相當便利，但是需要 <a href="https://www.nuget.org/packages/Microsoft.SqlServer.Types/" target="_blank" rel="noopener"><strong>Microsoft.SqlServer.Types</strong></a> 參考，而有時參考後又出現問題。</p><p>Exception 訊息：</p><blockquote><p>System.InvalidOperationException</p><blockquote><p>HResult=0x80131509</p><p>Message=Spatial types and functions are not available for this provider because the &gt; assembly ‘Microsoft.SqlServer.Types’ version 10 or higher could not be found.</p><p>Source=EntityFramework.SqlServer</p></blockquote></blockquote><a id="more"></a><h2 id="Microsoft-SqlServer-Types-安裝"><a href="#Microsoft-SqlServer-Types-安裝" class="headerlink" title="Microsoft.SqlServer.Types 安裝"></a><a href="https://www.nuget.org/packages/Microsoft.SqlServer.Types/" target="_blank" rel="noopener">Microsoft.SqlServer.Types</a> 安裝</h2><p>透過 <strong>Nuget</strong> 安裝 <a href="https://www.nuget.org/packages/Microsoft.SqlServer.Types/" target="_blank" rel="noopener"><strong>Microsoft.SqlServer.Types</strong></a> 套件，可以透過介面安裝或是透過指令安裝，安裝指令如下：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Package</span> Microsoft.SqlServer.Types</span><br></pre></td></tr></table></figure><p>安裝好之後，請仔細閱讀 <strong>readme.htm</strong> ，其中說明如何將套件註冊進程式中</p><h3 id="ASP-NET-Web-Sites"><a href="#ASP-NET-Web-Sites" class="headerlink" title="ASP.NET Web Sites"></a>ASP.NET Web Sites</h3><p>在 <strong>Web Form</strong> 中，開啟 <strong>Default.aspx.cs</strong></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public partial class _Default : System.Web.UI.Page</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> _isSqlTypesLoaded = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> _Default()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!_isSqlTypesLoaded)</span><br><span class="line">        &#123;</span><br><span class="line">            SqlServerTypes.Utilities.LoadNativeAssemblies(Server.MapPath(<span class="string">"~"</span>));</span><br><span class="line">            _isSqlTypesLoaded = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ASP-NET-Web-Applications"><a href="#ASP-NET-Web-Applications" class="headerlink" title="ASP.NET Web Applications"></a>ASP.NET Web Applications</h3><p>開啟 <strong>Global.asax.cs</strong> 添加以下程式碼：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlServerTypes.Utilities.LoadNativeAssemblies(Server.MapPath(<span class="string">"~/bin"</span>));</span><br></pre></td></tr></table></figure><h3 id="Desktop-Applications"><a href="#Desktop-Applications" class="headerlink" title="Desktop Applications"></a>Desktop Applications</h3><p>在執行空間操作前執行以下程式碼：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlServerTypes.Utilities.LoadNativeAssemblies(AppDomain.CurrentDomain.BaseDirectory);</span><br></pre></td></tr></table></figure><h2 id="解決引用錯誤"><a href="#解決引用錯誤" class="headerlink" title="解決引用錯誤"></a>解決引用錯誤</h2><p>就如同此文一開始所提到的 <strong>exception</strong>，按照<a href="https://www.nuget.org/packages/Microsoft.SqlServer.Types/" target="_blank" rel="noopener"><strong>Microsoft.SqlServer.Types</strong></a>套件的說明註冊引用，有時還是會出現問題，可能是 <strong>Entity Framework</strong> 版本因素或是伺服器沒有對應版本的<a href="https://www.nuget.org/packages/Microsoft.SqlServer.Types/" target="_blank" rel="noopener"><strong>Microsoft.SqlServer.Types</strong></a>或是沒有註冊引用到；<a href="https://stackoverflow.com/questions/13174197/microsoft-sqlserver-types-version-10-or-higher-could-not-be-found-on-azure/40166192#40166192" target="_blank" rel="noopener">stack overflow</a> 此篇的討論方法可以解決我此次遇到的問題</p><ul><li>方法一</li></ul><p>添加參照</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlProviderServices.SqlServerTypesAssemblyName = Assembly.GetAssembly(<span class="keyword">typeof</span>(Microsoft.SqlServer.Types.SqlGeography)).FullName;</span><br></pre></td></tr></table></figure><ul><li>方法二</li></ul><p>直接在 <strong>config</strong> 檔案中進行參照，需要注意版本號</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">assemblyBinding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependentAssembly</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">assemblyIdentity</span> <span class="attr">name</span>=<span class="string">"Microsoft.SqlServer.Types"</span> <span class="attr">publicKeyToken</span>=<span class="string">"89845dcd8080cc91"</span> <span class="attr">culture</span>=<span class="string">"neutral"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bindingRedirect</span> <span class="attr">oldVersion</span>=<span class="string">"10.0.0.0-11.0.0.0"</span> <span class="attr">newVersion</span>=<span class="string">"14.0.0.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependentAssembly</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">assemblyBinding</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="取得-PublicKeyToken"><a href="#取得-PublicKeyToken" class="headerlink" title="取得 PublicKeyToken"></a>取得 <strong>PublicKeyToken</strong></h2><p>[<strong>Microsoft.SqlServer.Types</strong>] 的 DLL 的路徑，可以從以下路徑查找</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\assembly\GAC_MSIL\Microsoft.SqlServer.Types</span><br></pre></td></tr></table></figure><p>根據以上的 DLL 取得 <strong>PublicKeyToken</strong> 的方式，可以透過 <strong>powershell</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">([system.reflection.assembly]::loadfile(<span class="string">"c:\MyDLL.dll"</span>)).FullName</span><br></pre></td></tr></table></figure><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://stackoverflow.com/questions/54004109/how-use-microsoft-sqlserver-types-in-wcf-service-application" target="_blank" rel="noopener">stack overflow how use Microsoft.SqlServer.Types in WCF Service Application</a></li><li><a href="https://github.com/aspnet/EntityFramework6/issues/244" target="_blank" rel="noopener">Github EntityFramework6 issue #244</a></li><li><a href="https://social.msdn.microsoft.com/Forums/vstudio/en-US/bc51cd91-0c76-40c7-ab1a-f9dadb9f067a/mismatch-using-microsoftsqlservertypes?forum=visualstudiogeneral" target="_blank" rel="noopener">Mismatch using Microsoft.SqlServer.Types</a></li><li><a href="https://www.andrewcbancroft.com/2017/03/27/solving-spatial-types-and-functions-are-not-available-with-entity-framework/" target="_blank" rel="noopener">solving spatial types and functions are not available with entity framework</a></li><li><a href="https://stackoverflow.com/questions/1710935/how-do-i-find-the-publickeytoken-for-a-particular-dll" target="_blank" rel="noopener">find publickeytoken</a></li><li><a href="https://blog.developer.money/dapper-%E4%BD%BF%E7%94%A8-microsoft-sqlserver-types-%E6%89%BE%E4%B8%8D%E5%88%B0%E6%AD%A3%E7%A2%BA%E7%89%88%E6%9C%AC%E5%95%8F%E9%A1%8C-a7848b95b6e5" target="_blank" rel="noopener">Microsoft.SqlServer.Types 找不到正確版本問題</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;解決-Microsoft-SqlServer-Types-參考使用的問題&quot;&gt;&lt;a href=&quot;#解決-Microsoft-SqlServer-Types-參考使用的問題&quot; class=&quot;headerlink&quot; title=&quot;解決 Microsoft.SqlServer.Types 參考使用的問題&quot;&gt;&lt;/a&gt;解決 Microsoft.SqlServer.Types 參考使用的問題&lt;/h2&gt;&lt;p&gt;透過 &lt;strong&gt;Entity Framework&lt;/strong&gt; 使用 &lt;strong&gt;SQL Server&lt;/strong&gt; 的空間資料 (&lt;strong&gt;DbGeography&lt;/strong&gt;) 相當便利，但是需要 &lt;a href=&quot;https://www.nuget.org/packages/Microsoft.SqlServer.Types/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;Microsoft.SqlServer.Types&lt;/strong&gt;&lt;/a&gt; 參考，而有時參考後又出現問題。&lt;/p&gt;
&lt;p&gt;Exception 訊息：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;System.InvalidOperationException&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;HResult=0x80131509&lt;/p&gt;
&lt;p&gt;Message=Spatial types and functions are not available for this provider because the &amp;gt; assembly ‘Microsoft.SqlServer.Types’ version 10 or higher could not be found.&lt;/p&gt;
&lt;p&gt;Source=EntityFramework.SqlServer&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="Asp.Net MVC" scheme="https://shunnien.github.io/tags/Asp-Net-MVC/"/>
    
      <category term="Troubleshooting" scheme="https://shunnien.github.io/tags/Troubleshooting/"/>
    
  </entry>
  
  <entry>
    <title>Sqlserver 停用與啟用條件約束</title>
    <link href="https://shunnien.github.io/2019/02/26/sqlserver-diable-constraint/"/>
    <id>https://shunnien.github.io/2019/02/26/sqlserver-diable-constraint/</id>
    <published>2019-02-26T11:19:41.000Z</published>
    <updated>2019-06-14T05:58:19.701Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sqlserver-停用與啟用條件約束"><a href="#sqlserver-停用與啟用條件約束" class="headerlink" title="sqlserver 停用與啟用條件約束"></a>sqlserver 停用與啟用條件約束</h1><p>紀錄停用與啟用條件約束的 sql ，還有檢查目前資料表條件約束的語法<br><a id="more"></a></p><h2 id="語法"><a href="#語法" class="headerlink" title="語法"></a>語法</h2><p>全部條件約束停用</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 全部條件約束停用</span></span><br><span class="line">EXEC sp_MSforeachtable "<span class="keyword">ALTER</span> <span class="keyword">TABLE</span> ? <span class="keyword">NOCHECK</span> <span class="keyword">CONSTRAINT</span> <span class="keyword">ALL</span><span class="string">"</span></span><br><span class="line"><span class="string">GO</span></span><br></pre></td></tr></table></figure><p>刪除全部資料表資料</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 刪除全部資料表資料</span></span><br><span class="line">EXEC sp_MSForEachTable "<span class="keyword">DELETE</span> <span class="keyword">FROM</span> ?<span class="string">"</span></span><br><span class="line"><span class="string">GO</span></span><br></pre></td></tr></table></figure><p>全部資料表增值索引重設</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 全部資料表增值索引重設</span></span><br><span class="line">EXEC sp_MSforeachtable "DBCC CHECKIDENT('?', RESEED, 0)"</span><br><span class="line">Go</span><br></pre></td></tr></table></figure><p>全部條件約束啟用</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 全部條件約束啟用</span></span><br><span class="line">EXEC sp_MSforeachtable "<span class="keyword">ALTER</span> <span class="keyword">TABLE</span> ? <span class="keyword">WITH</span> <span class="keyword">NOCHECK</span> <span class="keyword">CHECK</span> <span class="keyword">CONSTRAINT</span> <span class="keyword">ALL</span><span class="string">"</span></span><br><span class="line"><span class="string">GO</span></span><br></pre></td></tr></table></figure><p>檢查目前資料表條件約束狀態的語法</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> f.NAME         N<span class="string">'物件名稱'</span>,</span><br><span class="line">       is_disabled    N<span class="string">'已停用(1)'</span>,</span><br><span class="line">       is_not_trusted N<span class="string">'不檢查現有資料(1)'</span>,</span><br><span class="line">       s.NAME         N<span class="string">'結構描述'</span>,</span><br><span class="line">       o.NAME         N<span class="string">'外部索引資料表'</span>,</span><br><span class="line">       sc.NAME        N<span class="string">'結構描述'</span>,</span><br><span class="line">       r.NAME         N<span class="string">'主索引資料表'</span>,</span><br><span class="line">       delete_referential_action_desc</span><br><span class="line">                      N<span class="string">'在進行刪除時，宣告的參考動作之描述'</span>,</span><br><span class="line">       update_referential_action_desc</span><br><span class="line">                      N<span class="string">'在進行更新時，宣告的參考動作之描述'</span>,</span><br><span class="line">       f.type_desc    N<span class="string">'物件描述'</span></span><br><span class="line"><span class="keyword">FROM</span>   sys.foreign_keys f</span><br><span class="line">       <span class="keyword">INNER</span> <span class="keyword">JOIN</span> sys.objects o</span><br><span class="line">               <span class="keyword">ON</span> f.parent_object_id = o.object_id</span><br><span class="line">       <span class="keyword">INNER</span> <span class="keyword">JOIN</span> sys.schemas s</span><br><span class="line">               <span class="keyword">ON</span> o.schema_id = s.schema_id</span><br><span class="line">       <span class="keyword">INNER</span> <span class="keyword">JOIN</span> sys.objects r</span><br><span class="line">               <span class="keyword">ON</span> f.referenced_object_id = r.object_id</span><br><span class="line">       <span class="keyword">INNER</span> <span class="keyword">JOIN</span> sys.schemas sc</span><br><span class="line">               <span class="keyword">ON</span> r.schema_id = sc.schema_id</span><br><span class="line"><span class="keyword">ORDER</span>  <span class="keyword">BY</span> o.NAME</span><br><span class="line"><span class="keyword">GO</span></span><br></pre></td></tr></table></figure><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="http://sharedderrick.blogspot.com/2017/06/sql-server-disable-foreign-key.html" target="_blank" rel="noopener">德瑞克：SQL Server 學習筆記</a></li><li><a href="https://docs.microsoft.com/zh-tw/sql/relational-databases/tables/disable-check-constraints-with-insert-and-update-statements?view=sql-server-2017" target="_blank" rel="noopener">microsoft docs</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;sqlserver-停用與啟用條件約束&quot;&gt;&lt;a href=&quot;#sqlserver-停用與啟用條件約束&quot; class=&quot;headerlink&quot; title=&quot;sqlserver 停用與啟用條件約束&quot;&gt;&lt;/a&gt;sqlserver 停用與啟用條件約束&lt;/h1&gt;&lt;p&gt;紀錄停用與啟用條件約束的 sql ，還有檢查目前資料表條件約束的語法&lt;br&gt;
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="SQLServer" scheme="https://shunnien.github.io/tags/SQLServer/"/>
    
  </entry>
  
  <entry>
    <title>IIS 應用程式設定資料夾權限</title>
    <link href="https://shunnien.github.io/2019/02/04/Granting-folder-permissions-to-IIS-application-pools/"/>
    <id>https://shunnien.github.io/2019/02/04/Granting-folder-permissions-to-IIS-application-pools/</id>
    <published>2019-02-04T15:57:23.000Z</published>
    <updated>2019-06-14T05:58:19.701Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IIS-應用程式設定資料夾權限"><a href="#IIS-應用程式設定資料夾權限" class="headerlink" title="IIS 應用程式設定資料夾權限"></a>IIS 應用程式設定資料夾權限</h1><p>在 <strong>windows</strong> 環境針對 <strong>IIS 應用程式集區</strong>設定的應用程式設定資料夾權限，設定方法很簡易，紀錄一下資料。<a id="more"></a></p><h2 id="簡介"><a href="#簡介" class="headerlink" title="簡介"></a>簡介</h2><p>當建立新的<strong>應用程式集區</strong>時，<strong>IIS</strong> 都會建立一個<a href="https://support.microsoft.com/zh-tw/help/243330/well-known-security-identifiers-in-windows-operating-systems" target="_blank" rel="noopener">安全性識別碼 (SID)</a>，表示此建立的應用程式集區。但是此識別不是真實的帳戶，所以不會在控制台顯示。<br>以下方法，假定應用程式區建立完畢。</p><p><img src="https://lh3.googleusercontent.com/wCkqOKGlW2TzeyS-wLnVitZDeg19HZ5UngjE_kEM-8D-dqb1BHDnKlnAFabpv4YF4OcWBhYDeABhlZ5VehvwqbTwmAxC5ZZGEMVL-FI03se23bpCHPV3tn6G5UxQx8WpOl7W4yGjoqO6Xbuz4dC2irk8ceAyiYrZmuFxBvKcNz4N9MXjleLAk24VrgMMUpeYsqCBLQmlIcMomuNW1tmP2Dsbscb_P1A7rciXG8cJ6g9OaS_vZGzWxwQA6qMeGHNekD1Z0GOK8i1xOmgn3zjdKGH6uxh2-L7CfFYT1HY9dWzTuSsUm9t9G0IOalqaiTIBQJ_A6CjLcYVhMCXWQZBQWgikns8JfEzwvWj2TksDJuw-XKvjLJGU20fZcGSwbUPJXouKFFYZZXO3DejQDO2qSa7gvGXL1qpaZuch7fGXhjTEI4S3NWYkQsQbbAeJO-ymx8wH8fALUiCIS58AO0W6G69HpAxgdxV5k02JHdYI7Cj0qzxxJE09KmPFx7Eq9R_kMFzPnIYSf-G5MPXXZkWhYXXbAHvSgVgidZz1vjIjI_8vsXoxXEQjiKay8NkDaWOmgg6dFzcmfXFrrMz7af5onfLK7lCVWiru4aiKgr9gXHVpCHgtsi2PhyNYLDMKVnkPXbxLD-8gEmUmrF3NcR_ov9rofqsSV4-Jb9AkbVsg6bD9KgzhRhac6OhQKskjG-yA66NSRa5JHdTt5D9j_P7PFqCn=w691-h286-no" alt="IIS 應用程式集區"></p><h2 id="方法-1"><a href="#方法-1" class="headerlink" title="方法 1"></a>方法 1</h2><p>直接針對資料夾設定權限，在 <strong>windows</strong> 中，直接透過介面操作</p><ul><li>在需要設定權限的資料夾上點擊<strong>滑鼠右鍵</strong></li><li>選擇<strong>屬性(Properties)</strong></li><li>在屬性畫面中，選擇<strong>安全性(Security)</strong>，在按下<strong>編輯(Edit…)</strong><br><img src="https://lh3.googleusercontent.com/KhfbtzN8esZXN4SGEtvTtJAk9QZNJkkiFbABByLwjUSodg_UVO55Q7Mt4bPyPF9aFASPiDRfpgIGeF4kcmZlxi1P8Iv77jj_axf_JG5X4D7bcugUa-d5n2c-q9jnD_7mG6AOE_afNVSc9JAKM6ZXrCXrNjOLhcfx3osEWa9FPYGtErAo-01btX10jWBx52cosSmM3QqwSbn18nqigNmTBiJRt3E6sW8RpI9P7B33jhd1u_2X6_IvW4y-IOtL-jedcurS-d-HJ3ifTsB51jGRcurNW7pCiIgYlcFWw0WvS-ffdEyM7DkgYjvcf56I6wc2Wr84ieDpUZhnk1U-ibqJkdMoQo15db3m_qqlUkxLY_Q412UtIcPCd7quXqmyYVHbITMM3sjhe6aNHWppxE26QAzIn_2teZ64M4V13DsgSz7jW65b2wf7IliM-QUoRlF9yxExp5Xm5bs5rn4EKwOZbTUsBqyM5wyfgi4FKIrhkVYbnXbgOG0ufLygmAMrZa7lJMVwFw9eB0HNR1oKtOGXu6ahMhzmasI2p4OhR8NVxsDpfejcDuB0g7j2CZuqXlc6CM-eWPm4zGTSvlN113rcqGCPodvPnVIbHCntVE6uL-L5_CeeXGZSxiIPfsEZTOq54B8VhAXVu8M1nbUskjGKBOTZMoZ-iGQoohyb1f8FZO-wS1OXJ6vhGsQo41vQxydios6riNPLr8yLYTnX91gJJLh-=w484-h594-no" alt="Properties window"></li><li>在 <strong>Permissions 視窗</strong>中，點擊<strong>新增(Add…)</strong><br><img src="https://lh3.googleusercontent.com/xGoV3LaViVXBgBey50E86csfeZDbfdEcjEXBr5VjmDo5Mqq5GyUBmJyp7IJYrZANwaSf3xbZJ63CXy0ze_Qb8MWT-Mtz3DMDA7YN9lO-ZXwXj9XBqdlj8KuflWlQNDZ1yvUtiGnJ67frXfOXhRZXTWM070tQ75gN9ssHibQamnEXvyW_PuySTA18fkmceDoQZE5lT2iXG8u6jOvWp7cWdwBEtTijGf2ogTLu_IuwGTm660LoiDsaHwp0jNYB2pC959Z2VWZBHK1-X4p6TrC-5nbUqMUQbBW3xJoTIsmfhbXiNy_rHtRYwg1BJ6dMei8_x794M57InD7SMI6ELw02u_1UXOoFeHqLJ0TaxI06Bae-ofshiyyfx-7YHh75AIhbukSyF2loLVIxDJGsb0Vi_7no9h4xyoMtCSlULjdbY5JOAG_M4-_coFmXdc3WoPMxlTK1wJRIgRh7WuHRZkJgLXqPpGPzt8x2OLMkaDzsbcCiDZaOkrrWUS4Eu5qeHfQvZe-FnLPys94-fc6fYY8Oon_PKQGkVWBl5ax0h5GNSwjX_4sMjyI-9DnbvmSpFCJfI3PFDw2w3-cKPgXECFQeIqlZhBzCeKAQIRxO3hakXa4nSD_v_IYodP0IOQ7Xr80s2LSH7RACzS9j4fFsI7VZI-GNoVIcTe4PECB0L8JfwqqyiAmpXyxYDrs-jTcQrX9EUg1SMC5qSQ7T4VUZN3Rx5Yi0=w484-h556-no" alt="Permissions window"></li><li>在<strong>輸入要選擇的對象名稱</strong>的輸入框中輸入 <code>IIS AppPool\myAppPoolName</code>。例如：<code>IIS AppPool\temp</code></li><li>輸入後，點擊<strong>檢查名稱</strong>，然後按下確定</li></ul><h2 id="方法-2"><a href="#方法-2" class="headerlink" title="方法 2"></a>方法 2</h2><p>透過 <strong>ICACLS</strong> 工具來使用 <strong>command line</strong> 來設定權限，以下範例為設定 <code>D:\temp</code> 此資料夾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ICACLS <span class="string">"D:\temp"</span> /grant <span class="string">"IIS AppPool\temp"</span>:M /t</span><br></pre></td></tr></table></figure><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://support.pkware.com/display/SMAR/KB+-+Granting+folder+permissions+to+IIS+application+pools" target="_blank" rel="noopener">pkware Granting folder permissions to IIS application pools</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;IIS-應用程式設定資料夾權限&quot;&gt;&lt;a href=&quot;#IIS-應用程式設定資料夾權限&quot; class=&quot;headerlink&quot; title=&quot;IIS 應用程式設定資料夾權限&quot;&gt;&lt;/a&gt;IIS 應用程式設定資料夾權限&lt;/h1&gt;&lt;p&gt;在 &lt;strong&gt;windows&lt;/strong&gt; 環境針對 &lt;strong&gt;IIS 應用程式集區&lt;/strong&gt;設定的應用程式設定資料夾權限，設定方法很簡易，紀錄一下資料。
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="IIS" scheme="https://shunnien.github.io/tags/IIS/"/>
    
      <category term="other" scheme="https://shunnien.github.io/tags/other/"/>
    
      <category term="security" scheme="https://shunnien.github.io/tags/security/"/>
    
  </entry>
  
  <entry>
    <title>GoogleMap Polyline 線</title>
    <link href="https://shunnien.github.io/2018/10/04/GoogleMap-draw-line/"/>
    <id>https://shunnien.github.io/2018/10/04/GoogleMap-draw-line/</id>
    <published>2018-10-04T15:26:08.000Z</published>
    <updated>2019-06-14T05:58:19.700Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GoogleMap-Polyline"><a href="#GoogleMap-Polyline" class="headerlink" title="GoogleMap Polyline"></a><a href="https://developers.google.com/maps/documentation/javascript/shapes#polylines" target="_blank" rel="noopener">GoogleMap Polyline</a></h1><p>透過 <strong>GoogleMap</strong> 操作 <a href="https://developers.google.com/maps/documentation/javascript/shapes#polylines" target="_blank" rel="noopener"><strong>polyline</strong></a> 的顯示<a id="more"></a>，不管是要顯示線，或是編輯線，繪製線等，使用 <a href="https://developers.google.com/maps/documentation/javascript/shapes#polylines" target="_blank" rel="noopener"><strong>polyline</strong></a> 就可以操作</p><h2 id="polyline"><a href="#polyline" class="headerlink" title="polyline"></a><a href="https://developers.google.com/maps/documentation/javascript/shapes#polylines" target="_blank" rel="noopener"><strong>polyline</strong></a></h2><p><strong>Google</strong> 提供了簡單的<a href="https://developers.google.com/maps/documentation/javascript/examples/polyline-simple" target="_blank" rel="noopener">範例</a>與詳細的<a href="https://developers.google.com/maps/documentation/javascript/shapes#polylines" target="_blank" rel="noopener">參考文件</a>，使用上也很簡易，需要注意在 <strong>HTML</strong> 中宣告使用地圖的 <strong>div</strong> 要設定明確大小(css 設定的大小)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"initial-scale=1.0, user-scalable=no"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Simple Polylines<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">      <span class="comment">/* Always set the map height explicitly to define the size of the div</span></span></span><br><span class="line">       * element that contains the map. */</span><br><span class="line"><span class="css">      <span class="selector-id">#map</span> &#123;</span></span><br><span class="line">        height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="comment">/* Optional: Makes the sample page fill the window. */</span></span></span><br><span class="line">      html, body &#123;</span><br><span class="line">        height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"map"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">initMap</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> map = <span class="keyword">new</span> google.maps.Map(<span class="built_in">document</span>.getElementById(<span class="string">'map'</span>), &#123;</span></span><br><span class="line">          zoom: 3,</span><br><span class="line">          center: &#123;lat: 24.977179, lng: 121.312848&#125;,</span><br><span class="line"><span class="javascript">          mapTypeId: <span class="string">'ROADMAP'</span>,</span></span><br><span class="line">          zoom: 13,</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> bikeLaneCoordinates = [</span></span><br><span class="line">          &#123;lat: 24.977685, lng: 121.310424&#125;,</span><br><span class="line">          &#123;lat: 24.977179, lng: 121.312848&#125;,</span><br><span class="line">          &#123;lat: 24.977879, lng: 121.317708&#125;,</span><br><span class="line">          &#123;lat: 24.978132, lng: 121.319951&#125;</span><br><span class="line">        ];</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> bikeLanePath = <span class="keyword">new</span> google.maps.Polyline(&#123;</span></span><br><span class="line">          path: bikeLaneCoordinates,</span><br><span class="line"><span class="javascript">          geodesic: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">          strokeColor: <span class="string">'#FF0000'</span>,</span></span><br><span class="line">          strokeOpacity: 1.0,</span><br><span class="line">          strokeWeight: 2,</span><br><span class="line"><span class="javascript">          editable: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">          draggable: <span class="literal">true</span></span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        bikeLanePath.setMap(map);</span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="comment">// no display polyline</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//bikeLanePath.setMap(null);</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">defer</span></span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&amp;callback=initMap"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>google.maps.Polyline 屬性說明</p></blockquote><ul><li>path : 線條的座標點集合陣列</li><li>strokeColor : 線條顏色</li><li>strokeOpacity : 線條透明度</li><li>strokeWeight : 線條粗細</li><li>editable : 可以編輯，值為 <strong>true</strong> 或是 <strong>false</strong></li><li>draggable : 是否可以拖動，值為 <strong>true</strong> 或是 <strong>false</strong></li></ul><blockquote><p>線上範例</p></blockquote><iframe scrolling="no" width="100%" height="300" src="//jsfiddle.net/71csbo3q/embedded/html,js,css,result/dark" frameborder="0" allowfullscreen></iframe><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li>Google <a href="https://developers.google.com/maps/documentation/javascript/examples/polyline-simple" target="_blank" rel="noopener">simple polyline example</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;GoogleMap-Polyline&quot;&gt;&lt;a href=&quot;#GoogleMap-Polyline&quot; class=&quot;headerlink&quot; title=&quot;GoogleMap Polyline&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://developers.google.com/maps/documentation/javascript/shapes#polylines&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GoogleMap Polyline&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;透過 &lt;strong&gt;GoogleMap&lt;/strong&gt; 操作 &lt;a href=&quot;https://developers.google.com/maps/documentation/javascript/shapes#polylines&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;polyline&lt;/strong&gt;&lt;/a&gt; 的顯示
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="Google Map" scheme="https://shunnien.github.io/tags/Google-Map/"/>
    
      <category term="Google" scheme="https://shunnien.github.io/tags/Google/"/>
    
      <category term="JavaScript" scheme="https://shunnien.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>IIS 的 CORS 設定</title>
    <link href="https://shunnien.github.io/2018/10/03/CORS-in-IIS-setting/"/>
    <id>https://shunnien.github.io/2018/10/03/CORS-in-IIS-setting/</id>
    <published>2018-10-03T14:41:50.000Z</published>
    <updated>2019-06-14T05:58:19.700Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IIS-的-CORS-設定"><a href="#IIS-的-CORS-設定" class="headerlink" title="IIS 的 CORS 設定"></a>IIS 的 CORS 設定</h1><p>說明在 IIS 設如何設定 <a href="https://developer.mozilla.org/zh-TW/docs/Web/HTTP/CORS" target="_blank" rel="noopener">CORS</a><a id="more"></a></p><h2 id="內文"><a href="#內文" class="headerlink" title="內文"></a>內文</h2><p>在 IIS 中，透過 <strong>web.config</strong> 直接設定 <strong>header</strong> ，針對 <strong>header</strong> 添加 <strong>Access-Control-Allow-Origin</strong> 此屬性即可，但是此種設定只能針對一組 Domain 設定，或是全開放；設定範例如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">httpProtocol</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">customHeaders</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 全部開放 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;add name="Access-Control-Allow-Origin" value="*" /&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 指定一個Domain --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"Access-Control-Allow-Origin"</span> <span class="attr">value</span>=<span class="string">"http://localhost:21259"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">customHeaders</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">httpProtocol</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>另一種則是為 <strong>IIS</strong> 安裝 <a href="https://www.iis.net/downloads/microsoft/iis-cors-module" target="_blank" rel="noopener">cors</a> 模組，其設定變得更方便，<a href="https://docs.microsoft.com/en-us/iis/extensions/cors-module/cors-module-configuration-reference" target="_blank" rel="noopener">官方文件</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cors</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">failUnlistedOrigins</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">add</span> <span class="attr">origin</span>=<span class="string">"*"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">add</span> <span class="attr">origin</span>=<span class="string">"https://*.microsoft.com"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">allowCredentials</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">maxAge</span>=<span class="string">"120"</span>&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">allowHeaders</span> <span class="attr">allowAllRequestedHeaders</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">add</span> <span class="attr">header</span>=<span class="string">"header1"</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">add</span> <span class="attr">header</span>=<span class="string">"header2"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">allowHeaders</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">allowMethods</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">add</span> <span class="attr">method</span>=<span class="string">"DELETE"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">allowMethods</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exposeHeaders</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">add</span> <span class="attr">header</span>=<span class="string">"header1"</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">add</span> <span class="attr">header</span>=<span class="string">"header2"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exposeHeaders</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">add</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">add</span> <span class="attr">origin</span>=<span class="string">"http://*"</span> <span class="attr">allowed</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/HTTP/CORS" target="_blank" rel="noopener">MDN CORS</a></li><li><a href="https://enable-cors.org/server_iis7.html" target="_blank" rel="noopener">Enable CORS IIS</a></li><li><a href="https://docs.microsoft.com/en-us/iis/extensions/cors-module/cors-module-configuration-reference" target="_blank" rel="noopener">microsoft cors module</a></li><li><a href="https://www.iis.net/downloads/microsoft/iis-cors-module" target="_blank" rel="noopener">IIS CORS Module Download</a></li><li>topcat <a href="https://dotblogs.com.tw/topcat/archive/2014/01/21/141979.aspx" target="_blank" rel="noopener">xdomain.js 多組(Multiple) 跨 Domain</a> 另一作法</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;IIS-的-CORS-設定&quot;&gt;&lt;a href=&quot;#IIS-的-CORS-設定&quot; class=&quot;headerlink&quot; title=&quot;IIS 的 CORS 設定&quot;&gt;&lt;/a&gt;IIS 的 CORS 設定&lt;/h1&gt;&lt;p&gt;說明在 IIS 設如何設定 &lt;a href=&quot;https://developer.mozilla.org/zh-TW/docs/Web/HTTP/CORS&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CORS&lt;/a&gt;
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="IIS" scheme="https://shunnien.github.io/tags/IIS/"/>
    
  </entry>
  
  <entry>
    <title>透過 X2js 自由轉換 XML 與 Json</title>
    <link href="https://shunnien.github.io/2018/09/29/javascript-xml2json/"/>
    <id>https://shunnien.github.io/2018/09/29/javascript-xml2json/</id>
    <published>2018-09-29T07:19:12.000Z</published>
    <updated>2019-06-14T05:58:19.699Z</updated>
    
    <content type="html"><![CDATA[<h1 id="x2js"><a href="#x2js" class="headerlink" title="x2js"></a><a href="https://github.com/abdmob/x2js" target="_blank" rel="noopener">x2js</a></h1><p>在前端中，有許多工具可以轉換 <a href="https://zh.wikipedia.org/zh-tw/XML" target="_blank" rel="noopener">XML</a> 與 <a href="https://zh.wikipedia.org/wiki/JSON" target="_blank" rel="noopener">JSON</a> ，此篇介紹 <a href="https://github.com/abdmob/x2js" target="_blank" rel="noopener">x2js</a><a id="more"></a></p><h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><p>可以使用 <strong>CDN</strong> 方式， <a href="https://cdnjs.com/libraries/x2js" target="_blank" rel="noopener"><strong>x2js CDN</strong></a> 或是手動引入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/x2js/1.2.0/xml2json.min.js&quot; integrity=&quot;sha256-RbFvov4fXA9DW/RzOAcIC0ZHIDmghGdsoug5slJHMMI=&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="基本語法"><a href="#基本語法" class="headerlink" title="基本語法"></a>基本語法</h3><ul><li><p>XML to JSON</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create x2js instance with default config</span></span><br><span class="line"><span class="keyword">var</span> x2js = <span class="keyword">new</span> X2JS();</span><br><span class="line"><span class="keyword">var</span> xmlText = <span class="string">"&lt;MyRoot&gt;&lt;test&gt;Success&lt;/test&gt;&lt;test2&gt;&lt;item&gt;val1&lt;/item&gt;&lt;item&gt;val2&lt;/item&gt;&lt;/test2&gt;&lt;/MyRoot&gt;"</span>;</span><br><span class="line"><span class="keyword">var</span> jsonObj = x2js.xml_str2json( xmlText );</span><br></pre></td></tr></table></figure></li><li><p>JSON to XML</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create x2js instance with default config</span></span><br><span class="line"><span class="keyword">var</span> x2js = <span class="keyword">new</span> X2JS();</span><br><span class="line"><span class="keyword">var</span> jsonObj = &#123; </span><br><span class="line">    MyRoot : &#123;</span><br><span class="line">                test: <span class="string">'success'</span>,</span><br><span class="line">                test2 : &#123; </span><br><span class="line">                    item : [ <span class="string">'val1'</span>, <span class="string">'val2'</span> ]</span><br><span class="line">                &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> xmlAsStr = x2js.json2xml_str( jsonObj );</span><br></pre></td></tr></table></figure></li></ul><p>此工具轉換 <a href="https://zh.wikipedia.org/zh-tw/XML" target="_blank" rel="noopener">XML</a> 會自動解析 <strong>namespaces</strong> ，這還挺方便的</p><h2 id="線上範例"><a href="#線上範例" class="headerlink" title="線上範例"></a>線上範例</h2><iframe scrolling="no" width="100%" height="300" src="//jsfiddle.net/fe8rkwxy/embedded/html,js,result/dark" frameborder="0" allowfullscreen></iframe><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://github.com/abdmob/x2js" target="_blank" rel="noopener">Github x2js</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;x2js&quot;&gt;&lt;a href=&quot;#x2js&quot; class=&quot;headerlink&quot; title=&quot;x2js&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://github.com/abdmob/x2js&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;x2js&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;在前端中，有許多工具可以轉換 &lt;a href=&quot;https://zh.wikipedia.org/zh-tw/XML&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;XML&lt;/a&gt; 與 &lt;a href=&quot;https://zh.wikipedia.org/wiki/JSON&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;JSON&lt;/a&gt; ，此篇介紹 &lt;a href=&quot;https://github.com/abdmob/x2js&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;x2js&lt;/a&gt;
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="JavaScript" scheme="https://shunnien.github.io/tags/JavaScript/"/>
    
      <category term="tools" scheme="https://shunnien.github.io/tags/tools/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript 浮點數取整數</title>
    <link href="https://shunnien.github.io/2018/09/29/javascript-floor-round-ceil/"/>
    <id>https://shunnien.github.io/2018/09/29/javascript-floor-round-ceil/</id>
    <published>2018-09-28T18:47:41.000Z</published>
    <updated>2019-06-14T05:58:19.699Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JavaScript-浮點數取整數"><a href="#JavaScript-浮點數取整數" class="headerlink" title="JavaScript 浮點數取整數"></a>JavaScript 浮點數取整數</h1><p>浮點數取整數，在數學中有<strong>四捨五入</strong>、<strong>無條件進位</strong>、<strong>無條件捨去</strong>三種方式，在 <strong>JavaScript</strong> 中，可以利用 <a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Math/ceil" target="_blank" rel="noopener"><strong>ceil</strong></a> 、<a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Math/floor" target="_blank" rel="noopener"><strong>floor</strong></a> 和 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round" target="_blank" rel="noopener"><strong>round</strong></a> 來達到<a id="more"></a></p><h2 id="ceil"><a href="#ceil" class="headerlink" title="ceil"></a><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Math/ceil" target="_blank" rel="noopener">ceil</a></h2><p>此方法會回傳大於或等於的最小整數，就是無條件進位</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">0.95</span>));</span><br><span class="line"><span class="comment">// output: 1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">2</span>));</span><br><span class="line"><span class="comment">// output: 2</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">3.024</span>));</span><br><span class="line"><span class="comment">// output: 4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">3.624</span>));</span><br><span class="line"><span class="comment">// output: 4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">-3.654</span>));</span><br><span class="line"><span class="comment">// output: -3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">-3.054</span>));</span><br><span class="line"><span class="comment">// output: -3</span></span><br></pre></td></tr></table></figure><h2 id="floor"><a href="#floor" class="headerlink" title="floor"></a><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Math/floor" target="_blank" rel="noopener">floor</a></h2><p>此方法回傳小於或等於的最大整數，就是無條件捨去</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">0.95</span>));</span><br><span class="line"><span class="comment">// output: 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">2</span>));</span><br><span class="line"><span class="comment">// output: 2</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">3.024</span>));</span><br><span class="line"><span class="comment">// output: 3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">3.624</span>));</span><br><span class="line"><span class="comment">// output: 3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">-3.654</span>));</span><br><span class="line"><span class="comment">// output: -4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">-3.054</span>));</span><br><span class="line"><span class="comment">// output: -4</span></span><br></pre></td></tr></table></figure><h2 id="round"><a href="#round" class="headerlink" title="round"></a><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round" target="_blank" rel="noopener">round</a></h2><p>此方法近似四捨五入，注意正負的差異</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">0.95</span>));</span><br><span class="line"><span class="comment">// output: 1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">2</span>));</span><br><span class="line"><span class="comment">// output: 2</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">3.024</span>));</span><br><span class="line"><span class="comment">// output: 3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">3.624</span>));</span><br><span class="line"><span class="comment">// output: 4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">-3.654</span>));</span><br><span class="line"><span class="comment">// output: -4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">-3.054</span>));</span><br><span class="line"><span class="comment">// output: -3</span></span><br></pre></td></tr></table></figure><h2 id="線上範例"><a href="#線上範例" class="headerlink" title="線上範例"></a>線上範例</h2><iframe height="279" scrolling="no" title="float get integer part in javascript" src="//codepen.io/shunnien/embed/KGKOEZ/?height=279&theme-id=0&default-tab=js&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;">See the Pen <a href="https://codepen.io/shunnien/pen/KGKOEZ/" target="_blank" rel="noopener">float get integer part in javascript</a> by allen_yu (<a href="https://codepen.io/shunnien" target="_blank" rel="noopener">@shunnien</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Math/ceil" target="_blank" rel="noopener">MDN ceil</a></li><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Math/floor" target="_blank" rel="noopener">MDN floor</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round" target="_blank" rel="noopener">MDN round</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JavaScript-浮點數取整數&quot;&gt;&lt;a href=&quot;#JavaScript-浮點數取整數&quot; class=&quot;headerlink&quot; title=&quot;JavaScript 浮點數取整數&quot;&gt;&lt;/a&gt;JavaScript 浮點數取整數&lt;/h1&gt;&lt;p&gt;浮點數取整數，在數學中有&lt;strong&gt;四捨五入&lt;/strong&gt;、&lt;strong&gt;無條件進位&lt;/strong&gt;、&lt;strong&gt;無條件捨去&lt;/strong&gt;三種方式，在 &lt;strong&gt;JavaScript&lt;/strong&gt; 中，可以利用 &lt;a href=&quot;https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Math/ceil&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;ceil&lt;/strong&gt;&lt;/a&gt; 、&lt;a href=&quot;https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Math/floor&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;floor&lt;/strong&gt;&lt;/a&gt; 和 &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;round&lt;/strong&gt;&lt;/a&gt; 來達到
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="JavaScript" scheme="https://shunnien.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Google Map Js Api 串接 Kml/kmz 檔案</title>
    <link href="https://shunnien.github.io/2018/09/27/google-map-js-api-access-kml/"/>
    <id>https://shunnien.github.io/2018/09/27/google-map-js-api-access-kml/</id>
    <published>2018-09-27T12:52:27.000Z</published>
    <updated>2019-06-14T05:58:19.698Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Google-Map-呈現-KML"><a href="#Google-Map-呈現-KML" class="headerlink" title="Google Map 呈現 KML"></a>Google Map 呈現 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML</a></h1><p>使用 google map js API 來串接 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML/KMZ</a> 檔案，其中需要注意的事項<br><a id="more"></a></p><h2 id="KML-KMZ"><a href="#KML-KMZ" class="headerlink" title="KML/KMZ"></a><a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML/KMZ</a></h2><ul><li><a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML (Keyhole Markup Language)</a>，是基於 <a href="https://zh.wikipedia.org/zh-tw/XML" target="_blank" rel="noopener">XML (eXtensible Markup Language,可擴展標記語言)</a>語法標準的一種標記語言 (markup language)</li><li><a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KMZ</a> 為 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML</a> 的壓縮格式，所以可以透過解壓縮得到 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML</a></li></ul><h2 id="Google-Map-js-API-kmllayer"><a href="#Google-Map-js-API-kmllayer" class="headerlink" title="Google Map js API kmllayer"></a><a href="https://developers.google.com/maps/documentation/javascript/kmllayer" target="_blank" rel="noopener">Google Map js API kmllayer</a></h2><p>要使用 <strong>Google Map js API</strong> 串接 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML/KMZ</a> ，需要透過 <strong>kmllayer</strong> 這類別，而 Google 在處理這部分有一些注意事項</p><ul><li>取得最大檔案(包含原始 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML</a>、原始 GeoRSS、壓縮後的 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KMZ</a>)大小是 <strong>3 MB</strong></li><li>最大未壓縮 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML</a> 檔案是 <strong>10 MB</strong></li><li>最大的網路連線是 <strong>10</strong></li><li>最大文件內容數量是 <strong>1000</strong></li><li>KML 圖層數量，官方說明在單一地圖顯示中，有數量限制，平均在 <strong>10 ～ 20</strong> 左右</li></ul><p>最後，最重要的是，google 官方有註記上述的注意事項隨時都可能變更，所以要隨時關注 <a href="https://developers.google.com/maps/documentation/javascript/kmllayer" target="_blank" rel="noopener">google document kmllayer</a></p><p>另外串接的 <a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">KML/KMZ</a> 連結必須是公開的網址，不能使用相對路徑進行連接</p><h2 id="範例"><a href="#範例" class="headerlink" title="範例"></a>範例</h2><p><a href="https://developers.google.com/maps/documentation/javascript/kmllayer" target="_blank" rel="noopener"><strong>kml Layer</strong></a> 參數的設定</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layer = <span class="keyword">new</span> google.maps.KmlLayer([opts]);</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">屬性</th><th style="text-align:center">說明</th></tr></thead><tbody><tr><td style="text-align:center">clickable</td><td style="text-align:center">圖層是否接收滑鼠事件，預設值為 true</td></tr><tr><td style="text-align:center">map</td><td style="text-align:center">顯示圖層的地圖物件</td></tr><tr><td style="text-align:center">preserveViewport</td><td style="text-align:center">自動縮放到 KML 圖層的中心，但是 KML 必須設定圖層的範圍邊界，假如沒有設定，則不會移動</td></tr><tr><td style="text-align:center">screenOverlays</td><td style="text-align:center">是否渲染至 overlays. 預設值為 true</td></tr><tr><td style="text-align:center">uppressInfoWindows</td><td style="text-align:center">點擊地圖時，禁止顯示跳出訊息視窗；預設值為 false</td></tr><tr><td style="text-align:center">url</td><td style="text-align:center">KML 的 url</td></tr><tr><td style="text-align:center">zIndex</td><td style="text-align:center">顯示圖層的 z-index</td></tr></tbody></table><p>所以在電腦的網頁上， <strong>clickable</strong> 設定為 <strong>false</strong> 時，因為事件冒泡被取消，所以 <strong>uppressInfoWindows</strong> 不管有無設定，都不會顯示 KML 圖層的訊息視窗。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> kmzLayer,kmlLayer;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initMap</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  map = <span class="keyword">new</span> google.maps.Map(<span class="built_in">document</span>.getElementById(<span class="string">'map'</span>), &#123;</span><br><span class="line">    zoom: <span class="number">12</span>,</span><br><span class="line">    center: <span class="keyword">new</span> google.maps.LatLng(<span class="number">25.04</span>, <span class="number">121.505</span>)</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> loadKmz = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  kmzLayer = <span class="keyword">new</span> google.maps.KmlLayer(&#123;</span><br><span class="line">    url: <span class="string">'https://shunnien.github.io/Victoria/sample.kmz'</span>,</span><br><span class="line">    map: map</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> loadKml = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  kmlLayer = <span class="keyword">new</span> google.maps.KmlLayer(&#123;</span><br><span class="line">    url: <span class="string">'https://shunnien.github.io/Victoria/ty_bike_lane.kml'</span>,</span><br><span class="line">    <span class="comment">//suppressInfoWindows: true,</span></span><br><span class="line">    map: map</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>線上範例</p><iframe scrolling="no" width="100%" height="300" src="//jsfiddle.net/ytucdm74/embedded/html,js,result/dark" frameborder="0" allowfullscreen></iframe><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://zh.wikipedia.org/zh-tw/KML" target="_blank" rel="noopener">Wiki KML</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/examples/layer-kml" target="_blank" rel="noopener">google KML layer example</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/kmllayer" target="_blank" rel="noopener">google document KML and GeoRSS Layers</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/kml" target="_blank" rel="noopener">google document Displaying KML</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/reference/kml" target="_blank" rel="noopener">google document KmlLayer class</a></li><li><a href="https://developers.google.com/kml/documentation/kmlreference" target="_blank" rel="noopener">google document Kml 說明</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Google-Map-呈現-KML&quot;&gt;&lt;a href=&quot;#Google-Map-呈現-KML&quot; class=&quot;headerlink&quot; title=&quot;Google Map 呈現 KML&quot;&gt;&lt;/a&gt;Google Map 呈現 &lt;a href=&quot;https://zh.wikipedia.org/zh-tw/KML&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;KML&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;使用 google map js API 來串接 &lt;a href=&quot;https://zh.wikipedia.org/zh-tw/KML&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;KML/KMZ&lt;/a&gt; 檔案，其中需要注意的事項&lt;br&gt;
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="Google Map" scheme="https://shunnien.github.io/tags/Google-Map/"/>
    
      <category term="Google" scheme="https://shunnien.github.io/tags/Google/"/>
    
      <category term="JavaScript" scheme="https://shunnien.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>TLS/SSL 簡介</title>
    <link href="https://shunnien.github.io/2018/09/27/EncrEncrypt-t-free-SSL/"/>
    <id>https://shunnien.github.io/2018/09/27/EncrEncrypt-t-free-SSL/</id>
    <published>2018-09-27T01:11:44.000Z</published>
    <updated>2019-06-14T05:58:19.698Z</updated>
    
    <content type="html"><![CDATA[<h1 id="TLS-SSL-簡介"><a href="#TLS-SSL-簡介" class="headerlink" title="TLS/SSL 簡介"></a><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">TLS/SSL</a> 簡介</h1><p>此篇已經紀錄一段時間，但是沒有把筆記整理好，這次把此篇筆記整理一下。<a id="more"></a></p><h2 id="HTTPS-Hypertext-Transfer-Protocol-Secure"><a href="#HTTPS-Hypertext-Transfer-Protocol-Secure" class="headerlink" title="HTTPS (Hypertext Transfer Protocol Secure)"></a><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">HTTPS</a> (Hypertext Transfer Protocol Secure)</h2><p><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">HTTPS</a> = 加密過的 HTTP 連線</p><p><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">HTTPS</a> = HTTP over <a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">TLS/SSL</a></p><ul><li><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">TLS/SSL</a> 是一個介於 HTTP 與 TCP/IP 之間的安全通訊協定</li></ul><p><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">TLS</a> &gt; <a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">SSL</a></p><p><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">HTTPS</a> != 安全的連線<br>HTTP = 不安全的連線<br>HTTP/2 與 ServiceWorker 僅支援 <a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">HTTPS</a> 連線</p><h2 id="SSL-安全通訊協定"><a href="#SSL-安全通訊協定" class="headerlink" title="SSL 安全通訊協定"></a><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">SSL</a> 安全通訊協定</h2><p><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener"><strong>SSL</strong></a> 的全名 <strong>Secure Sockets Layer</strong> (<strong>安全通訊協定</strong>)，後來改名為 <a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener"><strong>TLS</strong></a> (<strong>Transport Layer Security</strong>)(<strong>傳輸層安全協議</strong>)，不過大家在口語上還是通稱 <a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener"><strong>SSL</strong></a><br><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener"><strong>SSL</strong></a> 是一種<strong>安全協議</strong>或<strong>加密協議</strong>，一種以密碼學為基礎的訊息交換協議，目的是為為網際網路通訊，提供安全及資料完整性保障。</p><h2 id="PKI-公開金鑰基礎建設"><a href="#PKI-公開金鑰基礎建設" class="headerlink" title="PKI 公開金鑰基礎建設"></a>PKI 公開金鑰基礎建設</h2><ul><li><p>Public Key Infrastructure (PKI)(公開金鑰基礎建設)</p><p>一組由硬體、軟體、參與者、管理政策與流程組成的基礎架構，其目的在於創造、管理、分配、使用、儲存以及撤銷數位憑證；簡單說就是一份基本規則。</p></li><li><p>Certificate Authority(CA)(數位憑證認證機構)</p><p>負責儲存與簽發數位憑證</p></li><li><p>Registration Authority(RA)(註冊管理中心)</p><p>確保<strong>公開金鑰</strong>和<strong>特定個人或組織的身分</strong>鏈結(辨識身分)</p></li><li><p>Central Directory(中央目錄)</p></li><li>Certificate Management System</li><li><a href="https://en.wikipedia.org/wiki/Certificate_policy" target="_blank" rel="noopener">Certificate Policy(CP)</a> 憑證策略</li></ul><h2 id="SSL-伺服器憑證種類"><a href="#SSL-伺服器憑證種類" class="headerlink" title="SSL 伺服器憑證種類"></a><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">SSL</a> 伺服器憑證種類</h2><ul><li>SSL 伺服器數位憑證</li><li>EV SSL 伺服器數位憑證</li><li>萬用子網域 SSL 伺服器數位憑證</li></ul><h2 id="不同驗證等級的憑證"><a href="#不同驗證等級的憑證" class="headerlink" title="不同驗證等級的憑證"></a>不同驗證等級的憑證</h2><h3 id="Domain-Validated-SSL-DV-SSL"><a href="#Domain-Validated-SSL-DV-SSL" class="headerlink" title="Domain Validated SSL (DV SSL)"></a>Domain Validated SSL (DV SSL)</h3><ul><li><strong>驗證等級最低</strong>的 <a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">SSL</a> 憑證</li><li>通常此類憑證不是免費就是價格極其低廉</li><li>此類憑證通常不適合企業或電子商務網站</li><li>僅做網域認證</li></ul><p><img src="https://lh3.googleusercontent.com/N0Hj4QRTrETqfYsWlZIeJ_EOQPKcJHnvc4qw3WY5kD0xC-d7pRwNKhxNtVGsmPPD0h9tg9FzAhFk_JDDRwPmtJsqEZyLNTbGRRkzjRcyjGI3whA2CLusdQfkvlXjsikHSPDipVaVo94KR9zxh5695alWVEtsd78sY8uw_u_xZkftuDZomdCTdb7xetescHK7pxL9BYZz2vd17VejQ87aMZZDZOqYFWhqnIizq7S6eo3uC9w4yFrv8My-I5Qe2skAXaUXpCbcRYpFgKWloefH9viMY30XW-RuK1-0vgl6s-D3aYlN9LPJBK14I9XifdAjKLJWa1kYFy0PX3cAlIYAQmj20AejssHrlRUrBwAtz9kfuaWwkxs-w3jIIi6h0bqPjWCPsrK_ssJT97Ljt6MoDXk7rlEAwRpJfGTVkL1Qb5HrAzRNtntrB1v6RL3jwX-aneYRqvFmyN7F4bpINe4xiqpPquonzFcMrC1LUwIeFs5LysOBSUWqqt49TAiHn5HKsNaxoGkiuz8J3AmcAcc53njcZG1q96G5O6UCzxrFF5hS4KLmFXhPPM1wuyoYVvX2Dmo_b_XrI7H0CZnQ7_o1gYlJ_aB96w_VOQzDDFunxrR2PZO_23vv50VC6zAfp2uEE0HyMwLQfg7SrFaQKzPT0iDOHWdJ7Ew0oP4nR2EApVnCrobq96g6Tan4=w1206-h417-no" alt="DV SSL"></p><h3 id="Organization-Validated-SSL-OV-SSL"><a href="#Organization-Validated-SSL-OV-SSL" class="headerlink" title="Organization Validated SSL (OV SSL)"></a>Organization Validated SSL (OV SSL)</h3><ul><li>公司組織認證</li><li>在憑證的 Organization(O)，含有組織資訊</li></ul><p><img src="https://lh3.googleusercontent.com/K635GESidYbmXa8xrEOW9ILZ4ytZ4SIBNaORr33RmJvcDPkIFjW1DRh4tzhfJdxdpjO_PpEGrsNU0uPXyKJYxr2hbuVeVa52Ff6bw2EOsdsqAVYjJ3z8NtkozchpP8lvv6cHAV_5REbsxKQ2dmKJZ9zGIDCbiQ6c03eB1yKcKfGL56WO_sgpqZqgcDRrYG_IQvZjY2sE2BHyfb0Je4Fkll3zOQOIcbW8bdAvEHLRBb56FGoU2MEGTnHH-AnABi-Yg4NmFUX2-mRRZqAnjNKzuwwidfErq0_wak2Rl6-pnH66qta6crXHN18BixnT7hj9gLFQAsBRnDLNlAIQ4BqswzYzOUPxzFYD4vEkp65KBfOA7-Mp9tI17_bDRbsR407Pb78adlWbcBqgWNaZ7LzZcXqZaXL1Rx4DvIyyXbCbVxirCSHTzCZGlU81maHmB3sLL_CkJCkPgQUL9D032y2V-jy2r1QrrrdjAysI7dyYLsfrOxHS8aNU74dyIZ_BAYgC6nOV8KtxX-SglePxAYq4DcSEFAs_crJWTOtZMehdDgcGfkDqFSPMIctvztRA-g39mYDqIuVdgLDkEMwXocXAtOzaearMaHdFPBcsvshErIc5hJX-p99iUTRRRBKzi9Fx7GC_HTwSTtAz6Jl-0BMJgu_IeLXns5Ll2OSBlA3_AkLoqItHTPmF_IBP=w1201-h424-no" alt="OV SSL"></p><h3 id="Extended-Validated-SSL-EV-SSL"><a href="#Extended-Validated-SSL-EV-SSL" class="headerlink" title="Extended Validated SSL (EV SSL)"></a>Extended Validated SSL (EV SSL)</h3><ul><li>驗證等級最高的憑證，會打電話到公司確認該公司存在</li><li>各瀏覽器網址列安全顯示公司名稱</li></ul><p><img src="https://lh3.googleusercontent.com/HhNgvSwKXo9eQKylWcYnkY9Y48YJ3xaFLtXRZ8OaB1a1AHh33naakaJaoTgK4lIdPB6Y5RumwAEquvqU_zNDm27FrN5FDoNxTQW4Jhsjl2kQ_szz4TD4Qbszs60w0GZIjzzxSW1o3jByRHeaF28QmFj19HLn_De5eFHQ6jd5k9jjWGjY1Ci_q0b3Z9ToVHiCe_4B01u75Y_v5r3fcmXOmVcO7VlkWS22CV0D7ryeiA7CRJUf6tqxv1HoYYOpjAa5SXrDDwWMlCm2EjSnOZnPU5mh_SvOXzV8PjNOJ6xnfXkSDgO6KH6Vz1kNfQZVhTG-EMCgs6pT3caEEvlDgMjkKHZ9XTC_7X_si-Unr3Xe6sbVKIPHIekg0ip0IhBE-Ew45Cj0ZEoH5zD1KD6fUxzFVF9i9lO6GxrApqxbHA5j1cygHT6yleDwQpohMQOwyrCs2YCyEtjzmV5KdsAKnTu4v8EaZpoRLX-cx1kX6tghnm9tqocUytXiBDDaLqaGP9JwZW0iNphq698kvW29U1hNko2q03P9jkxSGY63I7V4olWuRCp_5pEJZb95duFy7oEeAAIiO1Xk5vnf29TiSskYzpA3tlLc9ikUxt_VL1nq0Veh3sSQ6_NHtz7rOmTz-hr6AxDTwbmwQT7T_lyaNYZWRHmDdpe9VSGbRVqgpdOwt8b-v8fCh8KJIowx=w915-h152-no" alt="EV SSL"></p><h2 id="備註"><a href="#備註" class="headerlink" title="備註"></a>備註</h2><ul><li><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">HTTPS</a> 相對 HTTP 而言會吃到一點點效能，因為需要加解密。</li><li>Chrome 瀏覽器中網址列驚嘆號，表示網站是安全的但是裡面內容有些是不安全的</li></ul><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">wiki HTTPS</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">wiki TLS SSL</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;TLS-SSL-簡介&quot;&gt;&lt;a href=&quot;#TLS-SSL-簡介&quot; class=&quot;headerlink&quot; title=&quot;TLS/SSL 簡介&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;TLS/SSL&lt;/a&gt; 簡介&lt;/h1&gt;&lt;p&gt;此篇已經紀錄一段時間，但是沒有把筆記整理好，這次把此篇筆記整理一下。
    
    </summary>
    
      <category term="心得筆記" scheme="https://shunnien.github.io/categories/%E5%BF%83%E5%BE%97%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="other" scheme="https://shunnien.github.io/tags/other/"/>
    
      <category term="notes" scheme="https://shunnien.github.io/tags/notes/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript 透過 DOMParser 讀取 XML</title>
    <link href="https://shunnien.github.io/2018/09/27/javascript-read-xml-by-DOMParser/"/>
    <id>https://shunnien.github.io/2018/09/27/javascript-read-xml-by-DOMParser/</id>
    <published>2018-09-26T20:17:39.000Z</published>
    <updated>2019-06-14T05:58:19.699Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DOMParser"><a href="#DOMParser" class="headerlink" title="DOMParser"></a><a href="https://developer.mozilla.org/zh-TW/docs/Web/API/DOMParser" target="_blank" rel="noopener">DOMParser</a></h1><p>在前端讀取 XML 的 response 已經是字串了，再透過 <a href="https://developer.mozilla.org/zh-TW/docs/Web/API/DOMParser" target="_blank" rel="noopener">DOMParser</a> 來解析 XML ，使 XML 內容好取得。<a id="more"></a>如果 response 指定 XML 格式，就直接已經讀取 XML 檔案，可以直接操作</p><h2 id="DOMParser-轉換-XML-字串"><a href="#DOMParser-轉換-XML-字串" class="headerlink" title="DOMParser 轉換 XML 字串"></a><a href="https://developer.mozilla.org/zh-TW/docs/Web/API/DOMParser" target="_blank" rel="noopener">DOMParser</a> 轉換 XML 字串</h2><p>主要關鍵在於使用 <a href="https://developer.mozilla.org/zh-TW/docs/Web/API/DOMParser" target="_blank" rel="noopener">DOMParser</a> 轉換字串</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> text, parser, xmlDoc;</span><br><span class="line"></span><br><span class="line">text = <span class="string">"&lt;bookstore&gt;&lt;book&gt;"</span> +</span><br><span class="line"><span class="string">"&lt;title&gt;Everyday Italian&lt;/title&gt;"</span> +</span><br><span class="line"><span class="string">"&lt;author&gt;Giada De Laurentiis&lt;/author&gt;"</span> +</span><br><span class="line"><span class="string">"&lt;year&gt;2005&lt;/year&gt;"</span> +</span><br><span class="line"><span class="string">"&lt;/book&gt;&lt;/bookstore&gt;"</span>;</span><br><span class="line"></span><br><span class="line">parser = <span class="keyword">new</span> DOMParser();</span><br><span class="line">xmlDoc = parser.parseFromString(text,<span class="string">"text/xml"</span>);</span><br><span class="line"><span class="keyword">var</span> title = xmlDoc.getElementsByTagName(<span class="string">"title"</span>)[<span class="number">0</span>].textContent;</span><br></pre></td></tr></table></figure><iframe scrolling="no" width="100%" height="300" src="//jsfiddle.net/1w86ofyz/embedded/html,js,result/dark" frameborder="0" allowfullscreen></iframe><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/API/DOMParser" target="_blank" rel="noopener">MDN DOMParser</a></li><li><a href="https://maps.nlsc.gov.tw/" target="_blank" rel="noopener">國土測繪中心</a></li><li><a href="http://maps.nlsc.gov.tw/S09SOA/" target="_blank" rel="noopener">國土測繪中心 WMTS</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;DOMParser&quot;&gt;&lt;a href=&quot;#DOMParser&quot; class=&quot;headerlink&quot; title=&quot;DOMParser&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://developer.mozilla.org/zh-TW/docs/Web/API/DOMParser&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;DOMParser&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;在前端讀取 XML 的 response 已經是字串了，再透過 &lt;a href=&quot;https://developer.mozilla.org/zh-TW/docs/Web/API/DOMParser&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;DOMParser&lt;/a&gt; 來解析 XML ，使 XML 內容好取得。
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="JavaScript" scheme="https://shunnien.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>無瑕的程式碼 番外篇讀書筆記</title>
    <link href="https://shunnien.github.io/2018/09/21/The-Clean-Coder-A-Code-of-Conduct-for-Professional-Programmers/"/>
    <id>https://shunnien.github.io/2018/09/21/The-Clean-Coder-A-Code-of-Conduct-for-Professional-Programmers/</id>
    <published>2018-09-21T02:26:07.000Z</published>
    <updated>2019-06-14T05:58:19.697Z</updated>
    
    <content type="html"><![CDATA[<h1 id="讀書筆記"><a href="#讀書筆記" class="headerlink" title="讀書筆記"></a>讀書筆記</h1><p>無瑕的程式碼 番外篇－專業程式設計師的生存之道(The Clean Coder: A Code of Conduct for Professional Programmers)讀書筆記，摘要記錄個人筆記 <a id="more"></a></p><p>三元分析法 (<strong>P</strong>rogram <strong>E</strong>valuation and <strong>R</strong>eview <strong>T</strong>echnique)</p><blockquote><p>樂觀預估 O<br>常規預估 N<br>悲觀預估 P</p></blockquote><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="問題追蹤"><a href="#問題追蹤" class="headerlink" title="問題追蹤"></a>問題追蹤</h3><p>針對問題追蹤可以使用一下工具紀錄追蹤</p><ul><li><a href="https://www.pivotaltracker.com/" title="Pivotal Tracker" target="_blank" rel="noopener">Pivotal Tracker</a></li><li>WiKi</li><li><a href="https://lighthouseapp.com/" target="_blank" rel="noopener">Lighthouse</a></li><li><a href="https://www.atlassian.com/software/jira" target="_blank" rel="noopener">JIRA</a></li><li><a href="http://www.redmine.org/" target="_blank" rel="noopener">Redmine</a></li></ul><h3 id="編輯器"><a href="#編輯器" class="headerlink" title="編輯器"></a>編輯器</h3><ul><li><a href="https://www.gnu.org/software/emacs/" target="_blank" rel="noopener">Emacs</a></li><li><a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">IntelliJ</a></li><li><a href="https://macromates.com/" target="_blank" rel="noopener">TextMate</a> 文本編輯器，羽量級編輯器</li><li>Vi 功能雖然齊全，但是有比 Vi 便利的編輯器工具</li></ul><h3 id="測試工具"><a href="#測試工具" class="headerlink" title="測試工具"></a>測試工具</h3><ul><li><a href="http://docs.fitnesse.org/FrontPage" target="_blank" rel="noopener">Fitnesse</a> 此書作者主力開發的 Java 單元測試工具</li><li><a href="https://www.seleniumhq.org/" target="_blank" rel="noopener">Selenium</a></li><li><a href="https://robotfx.ro/" target="_blank" rel="noopener">RobotFX</a></li><li><a href="https://cucumber.io/" target="_blank" rel="noopener">Cucumber</a></li></ul><h3 id="Coutinuous-Build-CI"><a href="#Coutinuous-Build-CI" class="headerlink" title="Coutinuous Build (CI)"></a>Coutinuous Build (CI)</h3><ul><li><a href="https://jenkins.io/" target="_blank" rel="noopener">Jenkins</a></li></ul><h2 id="練習場-Kata"><a href="#練習場-Kata" class="headerlink" title="練習場 (Kata)"></a>練習場 (Kata)</h2><p>練習是培養類似熟能生巧的能力與思考方向</p><ul><li><a href="http://butunclebob.com/" target="_blank" rel="noopener">butunclebob.com</a></li><li><a href="http://katas.softwarecraftsmanship.org/" target="_blank" rel="noopener">Code Kata</a></li><li><a href="http://codekata.pragprog.com/" target="_blank" rel="noopener">CodeKata</a> 另一練習網址</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;讀書筆記&quot;&gt;&lt;a href=&quot;#讀書筆記&quot; class=&quot;headerlink&quot; title=&quot;讀書筆記&quot;&gt;&lt;/a&gt;讀書筆記&lt;/h1&gt;&lt;p&gt;無瑕的程式碼 番外篇－專業程式設計師的生存之道(The Clean Coder: A Code of Conduct for Professional Programmers)讀書筆記，摘要記錄個人筆記
    
    </summary>
    
      <category term="讀書筆記" scheme="https://shunnien.github.io/categories/%E8%AE%80%E6%9B%B8%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="notes" scheme="https://shunnien.github.io/tags/notes/"/>
    
  </entry>
  
  <entry>
    <title>API 壓力測試工具 SuperBenchmarker</title>
    <link href="https://shunnien.github.io/2018/09/20/SuperBenchmarker/"/>
    <id>https://shunnien.github.io/2018/09/20/SuperBenchmarker/</id>
    <published>2018-09-20T01:21:29.000Z</published>
    <updated>2019-06-14T05:58:19.697Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SuperBenchmarker"><a href="#SuperBenchmarker" class="headerlink" title="SuperBenchmarker"></a>SuperBenchmarker</h1><p>這工具使用也一段時間，這次順手紀錄下來<a id="more"></a>；這是一個 command-line 工具，可以很便利使用。</p><h2 id="安裝方式"><a href="#安裝方式" class="headerlink" title="安裝方式"></a>安裝方式</h2><p>可以透過 <a href="https://chocolatey.org/" target="_blank" rel="noopener"><strong>chocolatey</strong></a> 來安裝，安裝指令如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install superbenchmarker</span><br></pre></td></tr></table></figure><h2 id="指令與參數說明"><a href="#指令與參數說明" class="headerlink" title="指令與參數說明"></a>指令與參數說明</h2><p>指令範例如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sb -u <span class="string">"https://reqres.in/api/users?page=&#123;&#123;&#123;Id&#125;&#125;&#125;"</span> -n 800 -c 5 -m GET -t D:\temp\template.txt -f D:\temp\values.csv -v -h</span><br></pre></td></tr></table></figure><p>常用參數說明</p><table><thead><tr><th style="text-align:center">參數</th><th style="text-align:center">說明</th></tr></thead><tbody><tr><td style="text-align:center">-u</td><td style="text-align:center">設定要測試的 url</td></tr><tr><td style="text-align:center">-n</td><td style="text-align:center">要發出的 request 數量</td></tr><tr><td style="text-align:center">-c</td><td style="text-align:center">同時的連線數</td></tr><tr><td style="text-align:center">-m</td><td style="text-align:center">http method</td></tr><tr><td style="text-align:center">-t</td><td style="text-align:center">template 範本，要設定 header 可以使用此參數</td></tr><tr><td style="text-align:center">-f</td><td style="text-align:center">使用 csv 檔案來取代參數的指令</td></tr><tr><td style="text-align:center">-v</td><td style="text-align:center">顯示詳細訊息</td></tr><tr><td style="text-align:center">-h</td><td style="text-align:center">顯示 header 訊息</td></tr></tbody></table><p>另外執行結束會產生報告圖表的 html 頁面，此 html 會儲存在指令執行的路徑下，所以需要注意登入帳號是否有權限寫入檔案</p><p><img src="https://lh3.googleusercontent.com/GoYY_-i8_sF5Waez3c21XwvEo4rBbMH5HDd1w0rnBnLyb1hSJpVL3s6QjxsTW6kn7FrdOrZ86_3AK9BnBMO5NevBRah6sXkF5dVF49kJOqPRSlFYbOofBcMLOubEfIYWMugGRiMibtXGP7aQES3TutmzCy0HPqbXRowB2KqaDW1f15PNaVMWR8Nk_7GgDvfgseY0j0dLXpy0rAz-e2ivzcvcxn1RJu-6FX5w_Vrja5-Msq6ljdAKfNFysQ6gJfeqyLBwcbPVs-Tv3J33z01WU7VpP5R0vMSA3r69tp4uoHSsT-IWqIvMR72aJFgCZIdwS89qk-dJxoSnJkvWJAUNyJjPYAXbWkDzgF82v06lXpjQcOHYmGSYxvd1xESiMVHIPSnqN4dflI069Oc1-MRnaufJiUJtLJMhi_lOzSi6IyZoGvi9DdOp7ZOSzghQ-689sKddoAL-ft6-ZwywfcUcqHrm9R557iAOcqOcxnJ9pldSjsQTk7HqOv1G9XE95G-8DCnC-Cm84Nso8JRgA3MzFXE9hru6zazangmPviklviA1qPvKMYzCMz9i51OloSrWI7YFqU8iq8ybSmRjcsPaS5YVOsMeSuXukzkjAfOpNSsG4sPwE-zoaQ_9Os1PBch2V7ZmHt8Jc-OE10sn5dc1SUFeMkQv5bMljCLcGiPuwJl4l2ywQdKaVZ5j=w1267-h826-no" alt="output result"></p><h3 id="名詞說明"><a href="#名詞說明" class="headerlink" title="名詞說明"></a>名詞說明</h3><blockquote><p>每秒需求處理能力 RPS( Requests Per Second)</p></blockquote><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://github.com/aliostad/SuperBenchmarker" target="_blank" rel="noopener">Github SuperBenchmarker</a></li><li><a href="http://larrynung.github.io/2013/10/27/superbenchmarker-a-load-generator-command-line-tool-for-testing-websites-and-http-apis/" target="_blank" rel="noopener">Level Up SuperBenchmarker</a></li><li><a href="https://blog.kkbruce.net/2013/09/free-website-rest-service-stress-test-tool.html#.W6IDSGgzaCg" target="_blank" rel="noopener">kkbruce 免費網站與REST服務壓力測試工具</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;SuperBenchmarker&quot;&gt;&lt;a href=&quot;#SuperBenchmarker&quot; class=&quot;headerlink&quot; title=&quot;SuperBenchmarker&quot;&gt;&lt;/a&gt;SuperBenchmarker&lt;/h1&gt;&lt;p&gt;這工具使用也一段時間，這次順手紀錄下來
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="tools" scheme="https://shunnien.github.io/tags/tools/"/>
    
  </entry>
  
  <entry>
    <title>IIS 設定 MIME Type</title>
    <link href="https://shunnien.github.io/2018/09/13/mime-type-set-for-iis/"/>
    <id>https://shunnien.github.io/2018/09/13/mime-type-set-for-iis/</id>
    <published>2018-09-13T07:00:44.000Z</published>
    <updated>2019-06-14T05:58:19.696Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IIS-設定-MIME-Type"><a href="#IIS-設定-MIME-Type" class="headerlink" title="IIS 設定 MIME Type"></a>IIS 設定 MIME Type</h1><p>簡單記錄一下設定方式<a id="more"></a>，因為 <strong>IIS</strong> 預設的副檔名還是有些不足，有些部分需要擴充設定，設定方式有兩種，一種是直接撰寫在 <strong>web.config</strong> 內，但是需要注意 <strong>IIS 7.0</strong> 以上版本才有支援，主要是 <strong>staticContent</strong> 此元素，詳情可以參考 <a href="https://docs.microsoft.com/en-us/iis/configuration/system.webserver/staticcontent/" target="_blank" rel="noopener">microsoft docs</a></p><h2 id="環境資訊"><a href="#環境資訊" class="headerlink" title="環境資訊"></a>環境資訊</h2><p>我的 IIS 環境</p><p><img src="https://lh3.googleusercontent.com/nFGHoiNAh5Ex6Ys84aPauKybjHRm8_Xx--qbGzR_56mIFBOQ2PU9N93dInBKgV2HVf9hq4xXvHSUb5j5Kf08r5gchzK1SRe-u_YWX-Dvf6YGNbAXVSbTyxvSlHHAAcpVymYgch-Q5qSg83uQtlXeqtOlqoICiCltaG6dD7uZ5Bv1Bk7Klb19NLf2J-R70BZhBSIZ_VODZiVY7Yodk3Z9RKo78cxMmgIR_tNpcAdqK8unyQTU6AhIbV9ZWLHj9iGMv-njKqgXA_OWFxL1nr9B5khwhu3XkbiNP2RMYoAcNes_NxrQOXx77bwmP6a-eBuvYxkF_Cq4aXBcTaVB19iFIgpAukWSkl6KEkqAUE50Qcl-NQ0SVFrdOK6QHVKtI6mIDDsJgUyFsyPavdkE7CuOyMWg-zXhw36gdgWZ-rVdsCK9Qqx0T4GdRn1-g8HuGcEFcia7BeGzblhimrOmSmRTtDfgMyZxJi1BKrh0rjBekYDsIcexfYaz_Bvz2r8oP5bXDot8T32i38TzR9Gn-42GvD4Q7N00g0Q_cHswv4JFpwdS0crDc2kmUNs7CA4FfIX7oVIwSgyARbCX0kcw57G9jbKfwZ4TKN35F4sBbm3moZtj_l9qBNNDnCRFI06EV6U1q5RnVNly-LjY6OX3gKP55Rr5CTqvcr5hfWCy7yCJGXwX8z_SOLnIeqcN=w616-h252-no" alt="my iis version"></p><h2 id="介面設定步驟"><a href="#介面設定步驟" class="headerlink" title="介面設定步驟"></a>介面設定步驟</h2><blockquote><p>步驟 1</p></blockquote><p><img src="https://lh3.googleusercontent.com/3HVMwl2jqvB9N1qQp78E_tPvVO-A9Df4QsnOlUNB2HTajLEC42cjiMaFEfY4UWs6YyLOvN2E6C2tk_KrMX3V1OtjQRyTO1YkXbcpz9gS1ItZrsiftdo5KSh9yx5JghOMLe-6SeEuT-ASaUOGquFaY5qfZyu53R7IE0pjX5P1iL4ExLIbkEhrOccUsa7DlUW-0GQKxHYdCV0FUzR3gRhkECqvI2nQgUwoFeRN5JBn9Fd_h8_nfn5nbSXXl_u2LCARGP9_5CFLdKvC4v0gcQ3RC9k0HgNlbB-SDrXSB0Se51zpH1Iy8q11guLNa35cf_bYEyTIAM8p6YSpbOP3b_CvoodcNrqy9Ph3ah4LwIE0GnMh4woJ9SAkOgoIRNz9me172JghKCsLHOfQ7y6sHE2fgRpebYrmB4EqTb041_MzDZevUayyLTkGsfB4nhCCKitW2if-2OF_ApHdcV3eOXiUh1qRB5AeD2FQQJS2CclD11VQObbkkX_XGSsUOttIlJQJ44P9WQCGdP5uPdjqN4aCW44B3rcKRKm3Un4zdqDvhQ7WLWEwk0z-20oMBvxsmvGCQL8D9u9mFYsqk5YSiaxzkAXyMqNvUwxvkJHQQhyxj4Hf0-Ja5WGCFdUcK7jE2cJ8NeOniqUcf9fqVAyZJS7SgGvnk41KKM0PfkfealjcDZPtILG69Qr6CC-J=w619-h346-no" alt="click MIME type"></p><blockquote><p>步驟 2</p></blockquote><p><img src="https://lh3.googleusercontent.com/CnPAHXZaIyJvazQDr988X8TChyQPCZB1FWse3cLIm2OrHQjx3DEbapKfWgj2o5w5toTAk61F_zjEFsu-MWlrsNeRxxKGzbw_csXgbxhr2H5UmV-HJvJZ7AbjYZ0ZSWT91hx3VK-HD0Ss-XamGUHIgm2iAVO0FPk3vS7Kbdo47LzHweb10GxUSyZahKZEghW-oFbntC1ljBRQ2zyQ0IKyQ9Pd4welY2B-y72jptqWi0LY8AcSmPhdr7ilhnyjOvnpnP82wRmK_T32z-J4GiE4Lqh08YuWMPOOOmInJBbQhb7HoLHR4T-c9WGuCzys3bTFG4W6uAZsD-rAp0-wIG4q77QuRBIU5oLeRba-fED_bCAd5oc8PFtN_wLowvEFZ-MlKK18ofzOnUiGwG7ZjKiF-ZIlEPq5IV2_jVO3hR5AuY4eBdtnZkThdAkqYtfxxFTCAYqpQe_Y4wP0QnBqsGeolkTPp-o_UNDpTL_F9p3nSosFQvE5wV-zb91FBcDEDdQB905XvOogEkJhE6a_7wYANLXgByANSYL_la1Lk1ETgvT5bZfvNn_2uaJUYdp1qxvwUvwaq5PzJvxwpmTqVWjWH-Zmd4Z2zEGp2UWKW_MU57_jhvqJAZI6cjPAKF3cRe9_1fYqxX05VmcFMIXhu6SViI2DL42GgL7j-6Nh8X8nZTSW1wm80zWMLx1q=w828-h504-no" alt="add new MIME type"></p><blockquote><p>步驟 3</p></blockquote><p><img src="https://lh3.googleusercontent.com/2SYx8vgzDtjvVy2vcu13OJnki5NGvX3ZyAoyphrc0dBM6soYscAjsEUopD3P321LnanDlsFJ0oFqR9NKwyTelXCpFcixHnt6vc3XaUohAUGJBw2rx0ax4CYoOLGH2DOtzzkjcDoCXbLRQ8RccIzauYBXNGCBNOXJVq56Ppt8x3aqu_wPGxOGr9G97xd9dHVs0k6m49V5gf6RW9g8GVDaXivlufbGi687Y81anuHgBvSOrhgQbmRCoBhElsrg1TefeDG2wSlfQCfxhZ4fGAL6XNx3Dzr6qPkusoVKs4QLls1iYAXK_wd27a8zVhYf2v4T4_toEjQnlF7lrkuVjdGEAzkAVhThimAcvDsd5ZyWxKPnD6MT3oUHcxj73gra8viL2IdiJhMKuTeV1j4RXinzzhJwrJ7kQ9cxL9bv7sfjPLDMASWDJDeZe8KCLElcu4RgZGIiRGczyvKQPptd3tJp8JjuRIobY67Tptx6vSDH35VCjo-gcbdqqyXvW9eV1g2TPzMhT4SwvpbkLK2p1JLhfQoso6a6mbCAwnyRaN8e4yVKhX_za1tNxe8Z9vSdzB9D6rnLFxVbfEUoWslvywHIm2wvoEjhyC07q30VX2byVJS8e_jlWte8a-dlBFRzKQR_9dkHXCZfwh9yy2S4mmCU1kydsSkvgZvdbbagHGFroMRvMx-3nfagFYBm=w660-h676-no" alt="fill MIME type"></p><h2 id="採用-web-config"><a href="#採用-web-config" class="headerlink" title="採用 web.config"></a>採用 web.config</h2><p>使用 <strong>config</strong> 的話，為了避免版本不同的預設設定，先使用 remove 移除預設值再添加</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">staticContent</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".eot"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".eot"</span> <span class="attr">mimeType</span>=<span class="string">"application/vnd.ms-fontobject"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".ttf"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".ttf"</span> <span class="attr">mimeType</span>=<span class="string">"font/ttf"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".otf"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".otf"</span> <span class="attr">mimeType</span>=<span class="string">"font/otf"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".woff"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".woff"</span> <span class="attr">mimeType</span>=<span class="string">"application/font-woff"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".woff2"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".woff2"</span> <span class="attr">mimeType</span>=<span class="string">"application/font-woff2"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".kml"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".kml"</span> <span class="attr">mimeType</span>=<span class="string">"application/vnd.google-earth.kml+xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".kmz"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".kmz"</span> <span class="attr">mimeType</span>=<span class="string">"application/vnd.google-earth.kmz"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".json"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".json"</span> <span class="attr">mimeType</span>=<span class="string">"application/json"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".mp4"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".mp4"</span> <span class="attr">mimeType</span>=<span class="string">"video/mp4"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".ogv"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".ogv"</span> <span class="attr">mimeType</span>=<span class="string">"video/ogg"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".webm"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".webm"</span> <span class="attr">mimeType</span>=<span class="string">"video/webm"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".svg"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".svg"</span> <span class="attr">mimeType</span>=<span class="string">"image/svg+xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".svgz"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".svgz"</span> <span class="attr">mimeType</span>=<span class="string">"images/svg+xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".geojson"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".geojson"</span> <span class="attr">mimeType</span>=<span class="string">"application/json"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">remove</span> <span class="attr">fileExtension</span>=<span class="string">".csv"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mimeMap</span> <span class="attr">fileExtension</span>=<span class="string">".csv"</span> <span class="attr">mimeType</span>=<span class="string">"text/csv"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">staticContent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://support.microsoft.com/zh-tw/help/2621229" target="_blank" rel="noopener">microsoft support</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Complete_list_of_MIME_types" target="_blank" rel="noopener">MDN_完整的 MIME Type 列表</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;IIS-設定-MIME-Type&quot;&gt;&lt;a href=&quot;#IIS-設定-MIME-Type&quot; class=&quot;headerlink&quot; title=&quot;IIS 設定 MIME Type&quot;&gt;&lt;/a&gt;IIS 設定 MIME Type&lt;/h1&gt;&lt;p&gt;簡單記錄一下設定方式
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="IIS" scheme="https://shunnien.github.io/tags/IIS/"/>
    
  </entry>
  
  <entry>
    <title>Google Map Api 使用自訂底圖</title>
    <link href="https://shunnien.github.io/2018/09/06/google-map-api-custom-basemap/"/>
    <id>https://shunnien.github.io/2018/09/06/google-map-api-custom-basemap/</id>
    <published>2018-09-06T09:27:08.000Z</published>
    <updated>2019-06-14T05:58:19.696Z</updated>
    
    <content type="html"><![CDATA[<h1 id="google-map-api-使用自訂底圖"><a href="#google-map-api-使用自訂底圖" class="headerlink" title="google map api 使用自訂底圖"></a>google map api 使用自訂底圖</h1><p>在 Google map js api 中，不使用其預設底圖，改採用國土測繪中心的通用電子地圖<a id="more"></a></p><p>參考 Google 官方的 <a href="https://developers.google.com/maps/documentation/javascript/maptypes" target="_blank" rel="noopener"><strong>Map Types</strong></a> 說明文件，提到可以使用 <strong>setMapTypeId</strong> 此方法來指定底圖，記得更換以下的 <strong>google api key</strong> ，可以參考<a href="https://developers.google.com/maps/documentation/javascript/tutorial" target="_blank" rel="noopener">此篇</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Overlay map types<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        html,</span><br><span class="line">        body &#123;</span><br><span class="line">            height: 100%;</span><br><span class="line">            margin: 0;</span><br><span class="line">            padding: 0;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">        <span class="selector-id">#map</span> &#123;</span></span><br><span class="line">            height: 100%;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"map"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">initMap</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> wmsMapType = <span class="keyword">new</span> google.maps.ImageMapType(&#123;</span></span><br><span class="line">                maxZoom: 18,</span><br><span class="line">                minZoom: 7,</span><br><span class="line"><span class="javascript">                name: <span class="string">"test"</span>,</span></span><br><span class="line"><span class="javascript">                tileSize: <span class="keyword">new</span> google.maps.Size(<span class="number">256</span>, <span class="number">256</span>),</span></span><br><span class="line"><span class="javascript">                isPng: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                getTileUrl: <span class="function"><span class="keyword">function</span> (<span class="params">coord, zoom</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> <span class="string">`http://wmts.nlsc.gov.tw/wmts/EMAP/default/GoogleMapsCompatible/<span class="subst">$&#123;zoom&#125;</span>/<span class="subst">$&#123;coord.y&#125;</span>/<span class="subst">$&#123;coord.x&#125;</span>`</span>;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> map = <span class="keyword">new</span> google.maps.Map(<span class="built_in">document</span>.getElementById(<span class="string">'map'</span>), &#123;</span></span><br><span class="line">                zoom: 12,</span><br><span class="line"><span class="javascript">                center: <span class="keyword">new</span> google.maps.LatLng(<span class="number">25.04</span>, <span class="number">121.505</span>)</span></span><br><span class="line">            &#125;);</span><br><span class="line"><span class="javascript">            map.mapTypes.set(<span class="string">'test'</span>, wmsMapType);</span></span><br><span class="line"><span class="javascript">            map.setMapTypeId(<span class="string">'test'</span>);</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">"https://maps.googleapis.com/maps/api/js?key=AIzaSyCmg6WKhPyvaIM7yJI-x3LtXkgvWJzjiZE&amp;callback=initMap"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><iframe height="265" scrolling="no" title="GoogleMapCustomBaseMap" src="//codepen.io/shunnien/embed/EewaEJ/?height=265&theme-id=0&default-tab=html&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;">See the Pen <a href="https://codepen.io/shunnien/pen/EewaEJ/" target="_blank" rel="noopener">GoogleMapCustomBaseMap</a> by allen_yu (<a href="https://codepen.io/shunnien" target="_blank" rel="noopener">@shunnien</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://developers.google.com/maps/documentation/javascript/maptypes" target="_blank" rel="noopener">Google doc Map Types</a></li><li><a href="https://developers.google.com/maps/documentation/javascript/tutorial" target="_blank" rel="noopener">Google doc tutorial</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;google-map-api-使用自訂底圖&quot;&gt;&lt;a href=&quot;#google-map-api-使用自訂底圖&quot; class=&quot;headerlink&quot; title=&quot;google map api 使用自訂底圖&quot;&gt;&lt;/a&gt;google map api 使用自訂底圖&lt;/h1&gt;&lt;p&gt;在 Google map js api 中，不使用其預設底圖，改採用國土測繪中心的通用電子地圖
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="Google Map" scheme="https://shunnien.github.io/tags/Google-Map/"/>
    
      <category term="Google" scheme="https://shunnien.github.io/tags/Google/"/>
    
  </entry>
  
  <entry>
    <title>ArcGIS JavaScript API 安裝在 IIS</title>
    <link href="https://shunnien.github.io/2018/09/06/ArcGIS-js-API-isolated-install/"/>
    <id>https://shunnien.github.io/2018/09/06/ArcGIS-js-API-isolated-install/</id>
    <published>2018-09-06T09:06:02.000Z</published>
    <updated>2019-06-14T05:58:19.695Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ArcGIS-JavaScript-API-安裝在-IIS"><a href="#ArcGIS-JavaScript-API-安裝在-IIS" class="headerlink" title="ArcGIS JavaScript API 安裝在 IIS"></a>ArcGIS JavaScript API 安裝在 IIS</h1><p><strong>ArcGIS JavaScript API</strong> 提供的是類似 <strong>CDN</strong> 的服務，但是假如客戶是內部系統並不對外的時候，就無法使用了，由於該 API 包含許多功能模組，官方提供了此<a href="https://support.esri.com/en/technical-article/000011974" target="_blank" rel="noopener">說明</a>步驟來設定<a id="more"></a>，不只 js api ， SDK 也是類似的設定。</p><h2 id="安裝設定"><a href="#安裝設定" class="headerlink" title="安裝設定"></a>安裝設定</h2><h3 id="步驟-1"><a href="#步驟-1" class="headerlink" title="步驟 1"></a>步驟 1</h3><p><a href="https://developers.arcgis.com/downloads/" target="_blank" rel="noopener">下載安裝程式</a>， ESRI 的下載頁面僅提供會員使用，所以先註冊或是使用 google 帳號快速註冊(免費)，登入後在<a href="https://developers.arcgis.com/downloads/" target="_blank" rel="noopener">此連結</a>即可下載。<br>此次安裝使用 3.25 版本，<strong>API</strong> 會下載 <strong>arcgis_js_v325_api.zip</strong> ， <strong>Documentation</strong> 則是 <strong>arcgis_js_v325_sdk.zip</strong> ，假如只使用 JS 部分，可以只安裝 <strong>API</strong> 就好</p><p><img src="https://lh3.googleusercontent.com/4S8RWiivvmDb8SNBERU2818cxEXydYXvbBb3PkQF_1IpEH-MGGew-d3grCfNdgGYjPeEhywia_J8BKmKFaeUWKlR1jpn5qPZfFkJKX5tdwjMDkOiU7YzV6SGINPGB-joSXpc_Ahs9WLetuluBHH4ZAujeXF3FqJzfJAUx7Cf1YAhbwNtjxgoCcLaqOm4pnZbpAX8ulGQjyDT1wqSk9DmLWXjgTVVPsRBD29ph4OJ1IvW1Sz4zA18TBdoOobzNQA54njKy5tGniySDhZrolp0ZJpP9M1r_We6gt4f_9PYbMt21SSlwSQPRKu5su5_vSQKPSqW6GDJeAXPiB5loXxgs_eh8dktdhwDAehp4yMvW3h9vqFXXoov_4mge6hZojbXl1C2mxI2Gw06sfMWnXmwdfkLI11qYMgDSreSjYydcnFD0HqH0Pzh3q0wIcuC3uhRlNva561fbmtyJSUMqpcxwUk8sAUOJUlKZD919gP1Eac-VlwVk9jXrpJgo7rrc4fle5kUP-aYQ35BDMWo0opkCVl5cl4uZGWAzK0vPrAJCOYxpxnkCKgTaZolX3v2KHiALZi9rd0NLhfrxWXvRsByX-fYLP0nbb5OXqA43Cmw_P4ocPmY31oZzMlTb4bv9MCPI-VEPacNT2MaOeLYRBB0U6uwRKO5GUv76o6QWmtojTzFFbdThPs5UVKt=w1451-h476-no" alt="download page"></p><h3 id="步驟-2"><a href="#步驟-2" class="headerlink" title="步驟 2"></a>步驟 2</h3><p>將下載檔案解壓縮<br><img src="https://lh3.googleusercontent.com/jWHbm5wPINIVGPsI550NtGhlxdX_PszPfGbSIF5C2iwOonFkB2OVeag414Gi1XNA9TtHHPxsWEMVXPZV-gaTfGtskmXq6T9qjzpvJY_zSuoZmdSAgvKEkeYYbaYE5Bjz52wsqHcM034LW0icLdamhfOCUPHt07SouUp_kdR51WGou1UJrBb3oJyYzWZuOqI2EKzC53yfVDm9lP2StpFrlG9OQ-U1_cdDA5NrvpTXakEPZhmnzw97Gvq0UDjfk2l0YaK4kyd4GCVj8z3069C_yqTQNocbbRrTlqaOxJHWN6NsQNdjeecxlH_sGthy1pkxzmUGW9WQvzsXYKEB7-XuRWSxb9xHGTPpStJuqkMFWI0Vazc-xJv-Oj9z7SWpr6zrTVunoGdIVt6lnE-K9Q1qS4w3ZNrqULyYEwFSESjlhQbMVsH312l6DHVs8VlsF_JnCouIO2998zcY4IpGWsUvHOhrtlwaIb8slnbC2CgiD-0f_4S9LNfEu0qLbEP-ph-1tduY2fKZTxHObtCVjVoSAeWbzx6gkqVzyPQQG_f2KiCwwOTuDPgSpo1uAGxHk1MSOlz_B0Psd1pX0CAdRpG41gKA6pI2EN8XOo0um_Wp_MwLo9QyHxpWsV3dMG_d4KPBNiMl_iYOMAXo3hO66wCPB_2YLCeMbBSTrGa98w5ToT9Gyo1Jv7b4fLx6=w245-h132-no" alt="unzip file"></p><h3 id="步驟-3"><a href="#步驟-3" class="headerlink" title="步驟 3"></a>步驟 3</h3><p>在 IIS 根目錄中建立一個虛擬目錄 <strong>arcgis_js_api</strong> ，選擇剛剛解壓縮後的檔案路徑，注意是要選擇 <strong>rcgis_js_v325_api\arcgis_js_api</strong> 這個資料夾</p><p><img src="https://lh3.googleusercontent.com/tdxDWQhkuDaNxE1XKgWVE8LMQXXAhoBrv7vrsMX-GyQ6Sj974Wi42m_EawS3zrUCESUZsVdK_soMetIB7YsQqCPfYCJOLq7CTVA2nOdiLG5vVBmqFKiQVJ_CV5US0ITYUWSWscGz7FNdQqBlzHK7MpW20-NArXT0_Zlilj3DMCbQrEnaZ-qWcOhPkATIAl2oRPxQoGY6_5sOR2KeNcUp2FeLhE8-20V_gJnm4s0yno6zQ3864Ro_VIJdtzgaiOBzx2JoiJS-SdXK6cViLeXQyQZzfXnQSkU2I-gDNlZEKu8BN0MgpAUZOVaeoHfR6CieZLNjjwE_tcSk9K-fcWdjX4N3hbg4RF7Qjs1ZGmnjacmmvPXxuLFH--95foKE9htowAt6iCjHNrrEbdBbcb17wV3sy46oVPAUeToVBNzYOuOa0cer39txeC7LSH9GKQNM5_FezE3jycUCpfehBwv9kZZFJPdPksUnCd3HR6UmrS4bsBW-cKAzhOEjBp-7eZ5shhJRv4rL9xQ_wvQlXPBUKxMHZhadcwMecpR3cCByaQ54pro8vMjcYRQHglvQmZUnTp6n-_kRX5UbpTpVGd886gVgOKYyUob0Y7AqTJ2CWFl9DlnwlKjQYFxJJxgNf7qUqPz1s3duhiIuIZTOQn9lKTb_wsUlvWB_yGVJ6jCGddky_xEo-Mkgqdl2=w550-h452-no" alt="virtual directory arcgis_js_api"></p><h3 id="步驟-4"><a href="#步驟-4" class="headerlink" title="步驟 4"></a>步驟 4</h3><p>上述都是 IIS 部分的設定，接下來則是修改 javascript 內容；按照以下路徑(前一步驟設定的實體路徑)開啟 <strong>init.js</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arcgis_js_api\library\3.25\3.25\init.js</span><br></pre></td></tr></table></figure><p>找尋 <strong>[HOSTNAME_AND_PATH_TO_JSAPI]</strong> 此關鍵字，替換成各自設定的網域與資料夾路徑，如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;myhost.example.com&gt;/arcgis_js_api/library/&lt;myVersion&gt;/&lt;myVersion&gt;/</span><br></pre></td></tr></table></figure><p>以我此次 3.25 的設定則是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/arcgis_js_api/library/3.25/3.25/</span><br></pre></td></tr></table></figure><p><img src="https://lh3.googleusercontent.com/Nz3_35XAOtCE8e1bl0myQlD-2OUh9eOsE-Ocfw4u5QUJ1uwzYlqd48NqUThhsFA8HsquXF9FiZBHL6tpWlUo6bj74VxCFJEsGXtIZ2fHv4ouDaFUVfvc8WH8p5OfrpqIre0sAc8-ueyN2h_IX3UrdKvObP_qj_tR55FNmeJLZBP7z5WoHFlwzyXZaNv5mSiEiB0poHIjiUOTI-Tiry0Ol2N3feMu9s_2Bx0OGqh3C5Sckn3ouTlnZGV4oESwDWAvaJqk982eTl7LSXCYxO75WBrLU1aRTMWtXt0rqzmeBsI1LpXdaQyOjym98UgrnrCrDgzAX3uY6XE365w2xwhXYO5q986mlM40H3Xxl4LqSGZexcfSVN9KgMEvALfZljJvyPiIqQyrMsYWc-cjfGTBgD5ZccKR5XBurx0M40XWzaBDOD1rg6XWi8m1uL0jB6mAz2yzC20MnZhD0i0-pbySJ2PBefmPfzvqSTt4XcQPQyks0Szj0P7osXhlFbift8c1i0v0z388y24zqAZhfwarrIa_jvrRF9ENQya9rNLLGZME3o6U4bIA1sutMEeet1PGiz1BorDSWy_qSbZj1yF_bErcxMpNzkqsHclfNjbfmfoGftZZxk1lZbGpryMTAa4ZeyJ0ZKz9pgJGXcMWHZALCpFmfA3L2KoW8t-8L_7iA_iurhmaV-unk7yP=w825-h191-no" alt="init.js setting"></p><h3 id="步驟-5"><a href="#步驟-5" class="headerlink" title="步驟 5"></a>步驟 5</h3><p>開啟 IIS 路徑下的 <strong>dojo.js</strong> ，就是設定的實體路徑</p><p><img src="https://lh3.googleusercontent.com/eFKzlgFrbIH2PBqM2Pnw_ZzOZ3Vp4xFGSdaHSNnx9CS6G0EzWpaE4vABJJuopKzUccml39BfXLTIeic0Pim_8IrdlWU6FfEFJFzRmXE7wRmqm451nNk0-obHUCGNN9GqDE11RTuPXOddxZScb2aq1boXXndeo6dWA-ydbeLC8NJodxECP1F4ofkzNRvcirdZ5nKftV62rtQ8AGauIzYV0Q2fiu7UGIs7kVdrpGE0oO1gRLXeHv4vKTBmMzlZBmkYvfKNA1NUQ_M9I2kVsJrh6wJPVGRqH_NblJ3IdFqN74qx1Hy_11wV-WKqOWHglQ0R8vqQ76gyXT1BqLR7VhkSvefS2Ry0UhHyrF_eVDTNKLO-uya7u0wKECi4pswdb84LvoL2q4h_oCq7Lk21P90NN6MG04HST6Le_rp9_q9f-tvpDMeXE0lW2K5_CmDHWi_nhJkrhjYG5QTWYp2pHSkAJ5PEMFP4LBiKGyznXTEqv0mNPezc0tPT9FufKCS00tjTm_X7NOJ6L3r1tTTq0kn98ql1iRXwoGFzYMQSW6GoFPuy3BZXNzASs96XbbLZlmS9QbKaLguBrQBp5CGsYUF2yB_OjC-UDxB3Nq1Hmc42swXYE270__Hf7GWu54kmJJeGD9rJYOpPlmzGH4y-daM_6B8V9cfOf265yw_jk39v5GJpG_Zxe1WLFPBK=w797-h833-no" alt="dojo file"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Default Web Site\arcgis_js_api\library\3.25\3.25\dojo\dojo.js</span><br></pre></td></tr></table></figure><p>一樣找尋 <strong>[HOSTNAME_AND_PATH_TO_JSAPI]</strong> 關鍵字，用以下規則替換，同樣注意一下 <strong>protocol</strong> (http 與 https) 的差異</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;myhost.example.com&gt;/arcgis_js_api/library/&lt;myVersion&gt;/&lt;myVersion&gt;/</span><br></pre></td></tr></table></figure><h3 id="測試"><a href="#測試" class="headerlink" title="測試"></a>測試</h3><p>其實安裝檔案裏面都有說明教學檔案，裡面也有附上此測試頁面，將 <strong>link</strong> 與 <strong>script</strong> 替換成設定的路徑即可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Test Map<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"http://127.0.0.1/arcgis_js_api/library/3.25/3.25/esri/css/esri.css"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://127.0.0.1/arcgis_js_api/library/3.25/3.25/init.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      html,</span><br><span class="line">      body,</span><br><span class="line"><span class="css">      <span class="selector-id">#map</span> &#123;</span></span><br><span class="line">        height: 100%;</span><br><span class="line">        width: 100%;</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">          <span class="string">"esri/map"</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">"esri/layers/ArcGISTiledMapServiceLayer"</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">"dojo/domReady!"</span></span></span><br><span class="line"><span class="javascript">      ],<span class="function"><span class="keyword">function</span>(<span class="params">Map, ArcGISTiledMapServiceLayer</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">"map"</span>);</span></span><br><span class="line"><span class="javascript">          <span class="comment">//If you do not have Internet access then you will need to point this url to your own locally accessible tiled service.</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> tiled = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(<span class="string">"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"</span>);</span></span><br><span class="line">          map.addLayer(tiled);</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"map"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://lh3.googleusercontent.com/k3uwByjDg8x1ZhuJTv_XjLOkJPcRy88x-bPJWu3812Yb64DfG53ccTDajHfWTMmgoLVeO-xTDPCsJWgPlolE_pD18SGws95vg0W4wu7FJlYD3XwdeYmoaAVnjjkqh-VN0D4UjYQyg-fbkvTakUMid-mL0DpFDItKGcnfjszwqJ2YuxVtAyKXctXXwobfyHJ84U9lxN5LohrCFMngmyufn7yoKNXHn9yyy7w5TTwE-xGb2yFKGNYzQM0b7Bv08o1Tzk5P2O6XyMzSgk4nA5N9KSVY3wr0kDpgWhH4F_EM9OHk1_V_yFDfjLJyRSGkRenUsMQFkyBSdUMAWQ9jM4ZguKrbjNxazl7DdhZYhYuQOShPmixMPRixaCiZ5-GEa2hgFp_DMgby0-ZAFSNSzbES95tf-JXA4LXRZf2HhaBpDRC7fmvpV4QFYeAK2m0KUevdzgovDJd7q1QWuSV_cKzcP8IFFWwafTQBf5HszNZidqb5s4MVf_eigQC61y5JKpSkxzxeAVHgYqKZ7vEY-MoAKnPj2x6JeMEtvll32V2frEnK4_GF6vihTWoNtBmqCtrzW0Uj6W7A_DjI5C4bZ61orh-WsLrxeKtPylzT2jXPfSZo5i2JmPJCl1UzOqT4B9mp9lCCyJNEcWYjNEFE2VpUpiGy3ecGmQdmcE9IozXod1GuRt3AMz4p0pha=w872-h543-no" alt="test page"></p><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://support.esri.com/en/technical-article/000011974" target="_blank" rel="noopener">esri 設定步驟</a></li><li><a href="https://developers.arcgis.com/downloads/" target="_blank" rel="noopener">esri 安裝程式下載</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ArcGIS-JavaScript-API-安裝在-IIS&quot;&gt;&lt;a href=&quot;#ArcGIS-JavaScript-API-安裝在-IIS&quot; class=&quot;headerlink&quot; title=&quot;ArcGIS JavaScript API 安裝在 IIS&quot;&gt;&lt;/a&gt;ArcGIS JavaScript API 安裝在 IIS&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;ArcGIS JavaScript API&lt;/strong&gt; 提供的是類似 &lt;strong&gt;CDN&lt;/strong&gt; 的服務，但是假如客戶是內部系統並不對外的時候，就無法使用了，由於該 API 包含許多功能模組，官方提供了此&lt;a href=&quot;https://support.esri.com/en/technical-article/000011974&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;說明&lt;/a&gt;步驟來設定
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="IIS" scheme="https://shunnien.github.io/tags/IIS/"/>
    
      <category term="ArcGIS Js API" scheme="https://shunnien.github.io/tags/ArcGIS-Js-API/"/>
    
  </entry>
  
  <entry>
    <title>PHP 安裝 MSSQL Driver</title>
    <link href="https://shunnien.github.io/2018/08/10/php-install-sqlsrv-dll-on-windows/"/>
    <id>https://shunnien.github.io/2018/08/10/php-install-sqlsrv-dll-on-windows/</id>
    <published>2018-08-09T17:49:07.000Z</published>
    <updated>2019-06-14T05:58:19.695Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安裝-php-sqlsrv-與-php-pdo-sqlsrv"><a href="#安裝-php-sqlsrv-與-php-pdo-sqlsrv" class="headerlink" title="安裝 php_sqlsrv 與 php_pdo_sqlsrv"></a>安裝 <strong>php_sqlsrv</strong> 與 <strong>php_pdo_sqlsrv</strong></h1><p>使用 <strong>PHP</strong> 連接 MSSQL 進行 database migrate 時，發現出現以下訊息</p><p><img src="https://lh3.googleusercontent.com/rUs6dN2BgmXZxn1Fkdf9y9wPlrEkUPai6UC50O_UktnCjzB_6es_Yq_s0YZn1ZcHcsFR53f0DTsgl2X63xVtreav4FFH5coZfiuFYz2TSOUwiRWJZraAA8x4yxnIY4tKKTcrEK-QcOvTuN3OfCgsqgtIscCfd8bBTZl-y4rxQmTeH1qDzZwdIxoaExCloWkYU_oS7RWO58njlu74_2Cjw4R4aVxFiUsyyKtjZEjnNxJc9dTHDDmnYbMeGVSMO6X4_fcU_8-jZytlH9WZrNOof4pw95L1dBpgTJMKMe5GRnXjrkAEU7SGAFX0CEAfyG1a7smaIiAV6WE1CQedbRUfhj8ZYX9MA_SfRTzWFBR5VoFM5yhOWtjUGLxqJpQi0tTAMvj3poH2fJxRJIUVaFXyHQQrYR-ehST5mgjBkrKRfgGlcr2xTsmCO28y1ttUQeut3aFFSjQwqGHOhlNjNxoHVKXWDPvAP9kWJKJiAU6Zh_2jvnOlT_kpVlSJrxmK3wA_U4bUdzXjjNUgeFdk6gcy4jKj-W0TtLJJq7OaZ4EB010E8seYcASu2zpg4oNLjTGH_YeVcFd0UP8fL8jr57W10AOJvzY-e6uy1N-JyyHpXAuqcmunYjamdkxgiHQG6Ztv80vwM43iZMpaawX6BBx8dH0sPm_AhP1J=w494-h340-no" alt="command line error message]"><br><a id="more"></a></p><p>瀏覽頁面也出現以下錯誤</p><p><img src="https://lh3.googleusercontent.com/_wQX8-85GNXb53XFySs3IJX6Y324GZiR8JjNLFC0Bf_GknTa6emaIpbyS-YkKc5pK7Pf7JRrEdFivRagRD5AUnROiyiJIctAEUorOP7d0Cx5XEb5LG7zE9Vm2lz42G2kUmAEAquFwXsW8FOtvUf0AiFwK9PlpQoX88xk0YOTRcL1vaTcZbtAVf9rEPARz3KP1dvCFGFkhY-Q_D0ihYDHcEppYWqk-qZ8Avfx9EeW74Y9lssnoz6CxIaiBSPjN9yjxf5538uwAsRMvut3Sefizhu7LQJ17JMf4uixQ-igNL_7pGu14zxBuSUI9_fzrZ9x8mKa59-noH4KvAx3W1jv08c3AfRGwTQCKaUSv_a5hwCCUZYRRjE4rSLfNiypmP2caaQhyWvor5KAOdtQP_cTeBM6gMwN69eyHIwkczWxbfTL1frBoUy6-iV9xun8WVMw4kPZEZheo661MeD3-wuBPdqgHl6mE1WKSDHU79ix6lD9WC3p-SSeMs2CKnjQM0oiOUjlYmqk-dx0WlFUZ5uBV4LyLSNIB_9Zh51hU2xIB3nuRlEH6dklyK7medbK1CyDaaD05dHIAD1Ysi1QVzdYwRcKwG2mddr5YPeY9NLqsVXG4RVumfnByDTin1kAoEwJKiVMREiCdCODwifyYq_f8y8rZPgYB76_=w1109-h188-no" alt="page error message"></p><p>此訊息已經說明找不到對應連接的程式，所以需要安裝 MSSQL 的對應套件。安裝流程在 <a href="https://stackoverflow.com/questions/37245795/sqlsrv-could-not-find-driver-laravel-on-azure" target="_blank" rel="noopener"><strong>stackoverflow</strong></a> 有人說明了，以下針對此次的流程進行說明</p><h2 id="發生情形的環境"><a href="#發生情形的環境" class="headerlink" title="發生情形的環境"></a>發生情形的環境</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">資料庫--&gt;docker for window / mssql-server-linux</span><br><span class="line">PHP 開發環境--&gt;XAMPP</span><br><span class="line">PHP Version 5.6.36</span><br></pre></td></tr></table></figure><h2 id="安裝方法"><a href="#安裝方法" class="headerlink" title="安裝方法"></a>安裝方法</h2><p>首先檢核目前的 <strong>PHP</strong> 版本，找尋對應的 <strong>dll</strong> 元件版本，其詳細對應可以參考 <a href="https://docs.microsoft.com/en-us/sql/connect/php/system-requirements-for-the-php-sql-driver?view=sql-server-2017" target="_blank" rel="noopener"><strong>microsoft</strong></a> ，我的 <strong>PHP</strong> 版本是 <strong>5.6.36</strong> 所以需要安裝的是 <strong>3.2</strong></p><p><img src="https://lh3.googleusercontent.com/T66cbUAR_dZA0gBKUA3EynI2BG7gHo7cKt5K6ZDvQW8L69Chqgm7rvV-igXK3QxvnhxatSAd6rXSlJUsy_yMkJQo29jEqbqSM3mI0Ugef98EFqPnv91NA4Aj7iPDgoADWSdrZFhwPnePMuB1q9mTQ1AvBhCGlfvnWxwMBYUwAtgnqyV3dieYOEzyKnkpOs13x48rCYVDRPVDs_oFcbECG8FFgxyYoNHAc3IdpH0lRNdeKtUnE3fF57dlGZcg3QGsXCZ9CjWNMUAdDOQfASPUl8uzlNww_8-8lPCYWaGYZEg5pInp_RlHd7ydMCYimL8Jb8BGqUcxKUlSRmxSuhxUhzswVEU1pzOC3neoq4tcP0-8YclLmC4jN_koYLCvuLyfZVwzg3SgdtKqoHFC7BYEg7xw667KGfT6RBAhD9KQ8J3dhPvqGbkkkZWeAUhgabY5hrHJ2bV0Qil-m1bT3M_S9ge616e1xVBJ8scCoboW1ZkxwlogXH64PW1W_Q85ji1MLxSucMDqGS1B31RL2UTuloIIaq8J1reCBJkn1boEd8jfw1Bf53fajOr-FJRHDcRTrYS9DicV213pUIP7Rt2M7pQC7Q2sDlo_7sNoWH5p44AFHvnvg0nGlKWPpuluwYMGVUxscdkaPRGdgSFCMu5Be5tVpKIoBdqR=w1031-h601-no" alt="sql server driver Version and php"></p><ul><li><strong>PHP 7.x</strong> 版本，可以到 <a href="https://github.com/Microsoft/msphpsql/releases" target="_blank" rel="noopener">Github msphpsql</a> 下載</li><li><strong>PHP 5.x</strong> 版本，參考 <a href="https://docs.microsoft.com/en-us/sql/connect/php/system-requirements-for-the-php-sql-driver?view=sql-server-2017" target="_blank" rel="noopener"><strong>microsoft</strong></a> 對照表內的<a href="https://docs.microsoft.com/en-us/sql/connect/php/download-drivers-php-sql-server?view=sql-server-2017" target="_blank" rel="noopener">下載連結</a></li></ul><p>下載完成後，將對應的 <strong>php_sqlsrv.dll</strong> 檔案放至 <code>C:\xampp\php\ext</code> (因為我是使用 <strong>XAMPP</strong>)，之後進行 <strong>php.ini</strong> 檔案的設定</p><p>以我的環境而言，就是在檔案內容最後添加，此檔案設定完後， <strong>Apache</strong> 需要 Stop 再重新啟動，這樣設定才會重新讀取</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extension</span>=php_sqlsrv_56_ts.dll</span><br><span class="line"><span class="attr">extension</span>=php_pdo_sqlsrv_56_ts.dll</span><br></pre></td></tr></table></figure><p>此部分的設定還可以參考 <a href="https://docs.microsoft.com/en-us/sql/connect/php/loading-the-php-sql-driver?view=sql-server-2017" target="_blank" rel="noopener"><strong>microsoft docs Loading the Microsoft Drivers for PHP for SQL Server</strong></a></p><p>設定完成指令就可順利執行</p><p><img src="https://lh3.googleusercontent.com/CCNnZIJg31VRAAr6rMSkEgSP52noMUe3Mq_0ZhaYHeXFs8MUlMtLdNY7VUW74-ROJyV1ySHUO6ObvbMhOq7TPsQgOAHlJFPXDqeuGqa6ZUBWBYbhQ87vmDSDyWfllubyF5lh5C_RWrSBh9vYxwifOsx54otsPrYjaI6sAA2sT5MuAQnW0cA5X3b47L4ge4lHHmi46lySq5OAC7izeGFsOn3PYHYPN-XQtLs290CK9J5b3NW65tysP0kBsMIygB-np9qU482YDhLKD1j5C4JIfeOVq121vx6S-S45Vtg9C0VHvoW0rnvdCw8x-mAB1ZZj7s_oIZgXFOh20R_2eAmZ516QeFJShi7P-hTTDuwXUPtvz7EyJWtSKvqdY8NrQPW693JE-1BUhX6YfKbvqy0KzKVQc6ARNhCT2ARghPN10IkcnvUG3fdo-vB8fXndE4f_m-mi571se1vym4EqW4xcvaBrxDP2kGp_T_Pmr3ixGKaj1muFd8VUYbwpcoeDsWiKUafr1WmsP37McdaxXFaa3uo2hOYtH7NSiLmgZ6Lz-e-76u-dC5XV2wgQ9vpezoSeGDMIjG3qK5mjChk9xzSNCe5uMm9iiC-Hy7j41FFZJtGr2Vl8BEVB0VtkU9s3M_dICgylIViAnBtZbEYGq5DXBe0QiXn0YBpv=w715-h412-no" alt="command line success"></p><p><img src="https://lh3.googleusercontent.com/RLSYNkf_9JOZcmk7lJet-igoRl0E-Sfs4qFGxkCZFgdzaMMkKcLrRd8gl_8vEF_VJi9g0AyFx3MZsSzVJkkQz1jSobkpsMdw5CQowDy8PLa-HW0dLK_8ut79chYVTzDRkV-FoeYwBcR77b0M_1eDJwwGC61kGhr2gs4UG5-dKtCba1u70dWSI-ISc-WeyrW1fWuRSHLtwwBHiAsMPxzco9QLSm4tYlCFYN2jqk_4XxBlcJYsVpN4-apYU25yVbL6Hac2X_Lb6RlNt1-X_IsjsKCYZryuuipTsHjHD6T1TwsGz1v2-PRxX1UmlTzU1Mgu213uBySYJoX5AQOHDAAmXbHSGMnNLhb2RW3Zr2tr0QXmf3KeS5iZutDVKBVysi46-3ik7YLdFSnBfmy9jmb2woTGjJds7s6BPrqVfZxXojwCewJBCpX61Y2StUCm4WQO9mcbYjTA73NeQAZ9TfojZlj2HeTFPUvsSwZ7wSjgS_XIwd4P0GYsBsqdTBTU-Cgl3lhHgzDMdF4i4tZm5QqEE7RFv5v5YFc8Nf2NJwuU7YXP5Uio8m254gmjMCoYdmnU6A9bmQ6gpbBQ9xH0mUUYB-DxsdtLmzwelsmuG4haJyfsiRTHeq_dSmU2iIigpgcs6sTeTUkMgZ_fBrGvJHpfUXp8ILym_JQr=w354-h385-no" alt="sqlsrv database"></p><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://stackoverflow.com/questions/37245795/sqlsrv-could-not-find-driver-laravel-on-azure" target="_blank" rel="noopener">stackoverflow</a></li><li><a href="https://docs.microsoft.com/en-us/sql/connect/php/system-requirements-for-the-php-sql-driver?view=sql-server-2017" target="_blank" rel="noopener">microsoft docs system-requirements-for-the-php-sql-driver</a></li><li>找到的中文 step by step 教學 <a href="http://www.ucamc.com/e-learning/computer-skills/146-php-sqlsrv.html" target="_blank" rel="noopener">UCAMC</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;安裝-php-sqlsrv-與-php-pdo-sqlsrv&quot;&gt;&lt;a href=&quot;#安裝-php-sqlsrv-與-php-pdo-sqlsrv&quot; class=&quot;headerlink&quot; title=&quot;安裝 php_sqlsrv 與 php_pdo_sqlsrv&quot;&gt;&lt;/a&gt;安裝 &lt;strong&gt;php_sqlsrv&lt;/strong&gt; 與 &lt;strong&gt;php_pdo_sqlsrv&lt;/strong&gt;&lt;/h1&gt;&lt;p&gt;使用 &lt;strong&gt;PHP&lt;/strong&gt; 連接 MSSQL 進行 database migrate 時，發現出現以下訊息&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://lh3.googleusercontent.com/rUs6dN2BgmXZxn1Fkdf9y9wPlrEkUPai6UC50O_UktnCjzB_6es_Yq_s0YZn1ZcHcsFR53f0DTsgl2X63xVtreav4FFH5coZfiuFYz2TSOUwiRWJZraAA8x4yxnIY4tKKTcrEK-QcOvTuN3OfCgsqgtIscCfd8bBTZl-y4rxQmTeH1qDzZwdIxoaExCloWkYU_oS7RWO58njlu74_2Cjw4R4aVxFiUsyyKtjZEjnNxJc9dTHDDmnYbMeGVSMO6X4_fcU_8-jZytlH9WZrNOof4pw95L1dBpgTJMKMe5GRnXjrkAEU7SGAFX0CEAfyG1a7smaIiAV6WE1CQedbRUfhj8ZYX9MA_SfRTzWFBR5VoFM5yhOWtjUGLxqJpQi0tTAMvj3poH2fJxRJIUVaFXyHQQrYR-ehST5mgjBkrKRfgGlcr2xTsmCO28y1ttUQeut3aFFSjQwqGHOhlNjNxoHVKXWDPvAP9kWJKJiAU6Zh_2jvnOlT_kpVlSJrxmK3wA_U4bUdzXjjNUgeFdk6gcy4jKj-W0TtLJJq7OaZ4EB010E8seYcASu2zpg4oNLjTGH_YeVcFd0UP8fL8jr57W10AOJvzY-e6uy1N-JyyHpXAuqcmunYjamdkxgiHQG6Ztv80vwM43iZMpaawX6BBx8dH0sPm_AhP1J=w494-h340-no&quot; alt=&quot;command line error message]&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="PHP" scheme="https://shunnien.github.io/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>使用 PowerShell 來產生 Database Schema Script</title>
    <link href="https://shunnien.github.io/2018/08/04/powershell-generate-database-schema-script/"/>
    <id>https://shunnien.github.io/2018/08/04/powershell-generate-database-schema-script/</id>
    <published>2018-08-04T12:09:47.000Z</published>
    <updated>2019-06-14T05:58:19.694Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用-PowerShell-來產生-database-schema-script"><a href="#使用-PowerShell-來產生-database-schema-script" class="headerlink" title="使用 PowerShell 來產生 database schema script"></a>使用 PowerShell 來產生 database schema script</h1><p><a href="https://shunnien.github.io/2018/07/21/sqlserver-Data-tier-Applications/">前一篇文章</a>提到了 DAC ，但是遇到了 DAC 匯出失敗的問題，看訊息是部分資料表的因素，但是那些資料又是客戶自己的需求，所以利用 sqlserver 的產生 script 來進行結構備份紀錄，而自動化紀錄可以省時省力，此篇透過 <a href="https://zh.wikipedia.org/wiki/Windows_PowerShell" target="_blank" rel="noopener">PowerShell</a> 來自動產生與處理<br><a id="more"></a></p><h2 id="PowerShell-ISE"><a href="#PowerShell-ISE" class="headerlink" title="PowerShell ISE"></a><a href="https://docs.microsoft.com/zh-tw/powershell/scripting/core-powershell/ise/introducing-the-windows-powershell-ise?view=powershell-6" target="_blank" rel="noopener">PowerShell ISE</a></h2><p>要撰寫 <a href="https://zh.wikipedia.org/wiki/Windows_PowerShell" target="_blank" rel="noopener">PowerShell</a> 可以透過 <a href="https://docs.microsoft.com/zh-tw/powershell/scripting/core-powershell/ise/introducing-the-windows-powershell-ise?view=powershell-6" target="_blank" rel="noopener">PowerShell ISE</a> 這是一個方便撰寫的工具</p><p><img src="https://lh3.googleusercontent.com/SkkjcmzkUIpekZSf-FJb0ynNJakPwDu9doPWbZMmYLfoAjLEEPCv0Ynr8_Vt4mOYzdym5wN9UtuaDOyFJMJvtHzEn4Y_JjQYLbXnielt7jJMV4qrxwFIobJnGXuLRxQqA5IBSyFJsuxEnYiZGBLXPhUBNWQ-bf3wVSPIA15PDgjl3uG-OBZ8Ip13-KTamKtJy_czCHpSXwMnzLBr_8X9MVnUIdCYYd6rJqcF9Zn9U9zppYUXGm7KfMkln-aleKrD0kHWV55ONHU-HzngMGZMONl8AHxQNxVGsI6THw_HoHGPI4M5NMmEU6GsdmQnLjszExpb3Bo8LpLEeSC1xu6yuzvNn-VZUOKArOBPhQWBCii_uNfoNya7BydvrYyty9vEkJ6Mo50Dl73IbcvUmITMjv5I4uF0tM7qzkc-ODG8KHMGrettmViPkTmv_FerEsMVILET2neipsWxG_HPMLctjNmL-XHtO7r4TBjyMQgljNQfQHdUrKXcQTwxzcQFC6QyUZc6NSkhfoGEECt8HH6HB14Vz9xAhvokhsaUfUgs82TsayOKTs_2ygRb3N7FO7WA4prr5JLVQ_Vf-TYdjZ0bdoCdWimOj14iE3oRW48rJc6IyPt8KDNOXxs3f5L1hZvpd6-CXWM3UD9ZeddbhiNv1SxgxYoJ_UFF=w1443-h915-no" alt="powershell ISE"></p><h2 id="撰寫內容"><a href="#撰寫內容" class="headerlink" title="撰寫內容"></a>撰寫內容</h2><p>首先簡單說明處理流程</p><ul><li>將會依使用者變動的部分設定為變數</li><li>檢查目的地資料夾是否存在，並建立</li><li>透過 <a href="https://docs.microsoft.com/zh-tw/sql/relational-databases/server-management-objects-smo/overview-smo?view=sql-server-2017" target="_blank" rel="noopener">SMO</a> 建立連線</li><li>匯出設定</li><li>匯出結構</li></ul><p>以下將程式與註解說明</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最後儲存匯出結構的路徑資料夾</span></span><br><span class="line"><span class="variable">$Filepath</span> = <span class="string">'D:\MyScriptsDirectory'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 資料庫連線的 data source</span></span><br><span class="line"><span class="variable">$DataSource</span> = <span class="string">'127.0.0.1'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 資料庫名稱</span></span><br><span class="line"><span class="variable">$Database</span> = <span class="string">'databaseName'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取得今天日期，後續會利用此日期當檔案名稱的一部份</span></span><br><span class="line"><span class="variable">$today</span> = <span class="built_in">Get-Date</span> -Format yyyy_MM_dd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 防呆設計，當目的資料夾不存在時，建立資料夾</span></span><br><span class="line"><span class="variable">$homedir</span> = <span class="string">"<span class="variable">$Filepath</span>\"</span></span><br><span class="line"><span class="keyword">if</span> (!(<span class="built_in">Test-Path</span> -path <span class="variable">$homedir</span>)) &#123;</span><br><span class="line">  <span class="keyword">Try</span> &#123; <span class="built_in">New-Item</span> <span class="variable">$homedir</span> -type directory | <span class="built_in">out-null</span> &#125;</span><br><span class="line">  Catch [system.exception] &#123;</span><br><span class="line">    <span class="built_in">Write-Error</span> <span class="string">"error while creating '<span class="variable">$homedir</span>' <span class="variable">$_</span>"</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 開啟或關閉指令碼偵錯功能、設定追蹤層級和切換嚴格模式</span></span><br><span class="line"><span class="built_in">set-psdebug</span> -strict</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可自訂 Windows PowerShell 行為的變數</span></span><br><span class="line"><span class="variable">$ErrorActionPreference</span> = <span class="string">"stop"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 讀取 SMO assembly, 假如使用 SQL 2008 DLLs 需要載入 SMOExtended 和 SQLWMIManagement libraries</span></span><br><span class="line"><span class="variable">$ms</span> = <span class="string">'Microsoft.SqlServer'</span></span><br><span class="line"><span class="variable">$v</span> = [System.Reflection.Assembly]::LoadWithPartialName( <span class="string">"<span class="variable">$ms</span>.SMO"</span>)</span><br><span class="line"><span class="keyword">if</span> (((<span class="variable">$v</span>.FullName.Split(<span class="string">','</span>))[<span class="number">1</span>].Split(<span class="string">'='</span>))[<span class="number">1</span>].Split(<span class="string">'.'</span>)[<span class="number">0</span>] <span class="nomarkup">-ne</span> <span class="string">'9'</span>) &#123;</span><br><span class="line">  [System.Reflection.Assembly]::LoadWithPartialName(<span class="string">"<span class="variable">$ms</span>.SMOExtended"</span>) | <span class="built_in">out-null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$My</span> = <span class="string">"<span class="variable">$ms</span>.Management.Smo"</span> <span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 設定連線資訊</span></span><br><span class="line"><span class="variable">$mySrvConn</span> = <span class="built_in">new-object</span> Microsoft.SqlServer.Management.Common.ServerConnection</span><br><span class="line"><span class="variable">$mySrvConn</span>.ServerInstance = <span class="string">"<span class="variable">$DataSource</span>"</span></span><br><span class="line"><span class="variable">$mySrvConn</span>.MultipleActiveResultSets = <span class="literal">$true</span></span><br><span class="line"><span class="variable">$mySrvConn</span>.LoginSecure = <span class="literal">$false</span></span><br><span class="line"><span class="variable">$mySrvConn</span>.Login = <span class="string">"sa"</span></span><br><span class="line"><span class="variable">$mySrvConn</span>.Password = <span class="string">"1qaz@WSX"</span></span><br><span class="line"><span class="variable">$mySrvConn</span>.DatabaseName = <span class="string">"<span class="variable">$Database</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="built_in">new-object</span> (<span class="string">"<span class="variable">$My</span>.Server"</span>) <span class="variable">$mySrvConn</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 進行連線</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$s</span>.Version <span class="nomarkup">-eq</span> <span class="literal">$null</span> ) &#123;<span class="keyword">Throw</span> <span class="string">"Can't find the instance <span class="variable">$Datasource</span>"</span>&#125;</span><br><span class="line"><span class="variable">$db</span> = <span class="variable">$s</span>.Databases[<span class="variable">$Database</span>]</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$db</span>.name <span class="nomarkup">-ne</span> <span class="variable">$Database</span>) &#123;<span class="keyword">Throw</span> <span class="string">"Can't find the database '<span class="variable">$Database</span>' in <span class="variable">$Datasource</span>"</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$transfer</span> = <span class="built_in">new-object</span> (<span class="string">"<span class="variable">$My</span>.Transfer"</span>) <span class="variable">$db</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 匯出設定</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span> = <span class="built_in">new-object</span> (<span class="string">"<span class="variable">$My</span>.ScriptingOptions"</span>)</span><br><span class="line"><span class="comment"># yes, we want these</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.ExtendedProperties = <span class="literal">$true</span></span><br><span class="line"><span class="comment"># and all the constraints</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.DRIAll = <span class="literal">$true</span></span><br><span class="line"><span class="comment"># Yup, these would be nice</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.Indexes = <span class="literal">$true</span></span><br><span class="line"><span class="comment"># This should be included when scripting a database</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.Triggers = <span class="literal">$true</span></span><br><span class="line"><span class="comment"># this only goes to the file</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.ScriptBatchTerminator = <span class="literal">$true</span></span><br><span class="line"><span class="comment"># of course</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.IncludeHeaders = <span class="literal">$true</span>;</span><br><span class="line"><span class="comment">#no need of string output as well</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.ToFileOnly = <span class="literal">$true</span></span><br><span class="line"><span class="comment"># not necessary but it means the script can be more versatile</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.IncludeIfNotExists = <span class="literal">$true</span></span><br><span class="line"><span class="variable">$CreationScriptOptions</span>.Filename = <span class="string">"$(<span class="variable">$FilePath</span>)\$(<span class="variable">$Database</span>)_$(<span class="variable">$today</span>)_Build.sql"</span>;</span><br><span class="line"><span class="variable">$transfer</span> = <span class="built_in">new-object</span> (<span class="string">"<span class="variable">$My</span>.Transfer"</span>) <span class="variable">$s</span>.Databases[<span class="variable">$Database</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># tell the transfer object of our preferences</span></span><br><span class="line"><span class="variable">$transfer</span>.options = <span class="variable">$CreationScriptOptions</span></span><br><span class="line"><span class="variable">$transfer</span>.ScriptTransfer()</span><br><span class="line"><span class="string">"All done"</span></span><br></pre></td></tr></table></figure><p>這是按照 <a href="https://www.red-gate.com/simple-talk/sql/database-administration/automated-script-generation-with-powershell-and-smo/" target="_blank" rel="noopener">Automated Script-generation with Powershell and SMO</a> 此篇文章的資料，重新調整撰寫的範本，目的是設定排程進行定期結構備份，後續還可以參考 <a href="https://www.red-gate.com/simple-talk/sql/database-administration/database-deployment-the-bits---database-version-drift/" target="_blank" rel="noopener">Database Deployment: The Bits – Database Version Drift</a> 進行備份比較等…</p><h2 id="排程設定"><a href="#排程設定" class="headerlink" title="排程設定"></a>排程設定</h2><p>排程設定主要是因為 <strong>.ps1</strong> 不像是 <strong>.bat</strong> 直接執行，所以需要透過 <a href="https://zh.wikipedia.org/wiki/Windows_PowerShell" target="_blank" rel="noopener">PowerShell</a> 程式，再把撰寫的範本路徑設定到引數</p><p><img src="https://lh3.googleusercontent.com/TmrI92StXFgAKpTFhzdJO63tDniKA8gkz4Z9JohXTBVVs0cJkoC4hnB2A-g-VC4nBZ_X1GiN-FPbyllfQHjTwn59JqY5HiU9_9BR-wSNMde5KOt1DDzFLBK5bYA4HpGG3vtQyYbmZGd8NimYqRzYCwnvMrzdVnfNawXB-XaAMEbZyjolNvSKLL_1-unHto5rkMYnX9F-sg3diHECN8tlNGtdyg445m4p582F7aouDJoh6sDUFFT4dsvhnMF_yhTQcus0v9aIRUNwDpVXlbJ3VVvEywS0Dvq7R9z1JmnKWWQWLbauYx_IUobKdbDWm_NInaK91DUbV27qKNo5Qy-MKt5J-yF_Bdr6UN444nCq5aTDUUx_n9GJrxZwdMw79pGgRY6Lm13HPUtN9XNqcgvFXRpxYjY6jPerZmTBANTjUhmjJOBBmCW7jAdmVGvEWFduAukjRa1px9p3CDzvzc6T17FQ8n20IQE3YcCcFkdhfKYcG3idoxumDdu0HWxQTm9qRG-IvBVXGuhhwvH5KbYqJfjYTclAX3PP2Ya2Mp2c8XEx_hv8wcxrMDpIr54yLoeh6k9bhUP5U0C1F4_S-a8Cj5fSyHabE0U0ZlQlvl-zxzkW5OmqGytz7BEWSoKnhC7fGe4nq9Ef5b_Ktw8DoOh9qICwsTPLOJFW=w497-h541-no" alt="schedule setting"></p><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><p><a href="https://gist.github.com/shunnien/1bd60b2d8fe9c06578a214d9313673e8" target="_blank" rel="noopener">我的 GIST</a></p><script src="https://gist.github.com/shunnien/1bd60b2d8fe9c06578a214d9313673e8.js"></script><blockquote><p>powershell 學習資源</p></blockquote><ul><li><a href="https://ithelp.ithome.com.tw/users/20005121/ironman/54?page=1" target="_blank" rel="noopener">IT邦鐵人賽 powershell</a></li></ul><blockquote><p>延伸閱讀</p></blockquote><ul><li><a href="https://www.red-gate.com/simple-talk/sql/database-administration/automated-script-generation-with-powershell-and-smo/" target="_blank" rel="noopener">Automated Script-generation with Powershell and SMO</a></li><li><a href="https://www.red-gate.com/simple-talk/sql/database-administration/database-deployment-the-bits---database-version-drift/" target="_blank" rel="noopener">Database Deployment: The Bits – Database Version Drift</a></li><li><a href="https://blogs.technet.microsoft.com/heyscriptingguy/2010/11/04/use-powershell-to-script-sql-database-objects/" target="_blank" rel="noopener">Use PowerShell to Script SQL Database Objects</a></li><li><a href="https://docs.microsoft.com/en-us/sql/powershell/load-the-smo-assemblies-in-windows-powershell?view=sql-server-2017" target="_blank" rel="noopener">Load the SMO Assemblies in Windows PowerShell</a></li><li><a href="http://s3help.cloudbox.hinet.net/index.php/cloudberry-buckup" target="_blank" rel="noopener">使用Windows PowerShell 來執行 Cloudberry 的指令並進行排程備份</a></li><li><a href="https://dotblogs.com.tw/jamesfu/2014/05/16/autostartservice" target="_blank" rel="noopener">powershell 檢查服務並且重新自動啟動</a> 裡面包含建立排程與工作的設定教學</li><li><a href="https://zh.wikipedia.org/wiki/Windows_PowerShell" target="_blank" rel="noopener">Powershell Wiki</a></li></ul><blockquote><p>其餘工具</p></blockquote><ul><li><a href="http://winmerge.org/?lang=en" target="_blank" rel="noopener">WinMerge</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;使用-PowerShell-來產生-database-schema-script&quot;&gt;&lt;a href=&quot;#使用-PowerShell-來產生-database-schema-script&quot; class=&quot;headerlink&quot; title=&quot;使用 PowerShell 來產生 database schema script&quot;&gt;&lt;/a&gt;使用 PowerShell 來產生 database schema script&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://shunnien.github.io/2018/07/21/sqlserver-Data-tier-Applications/&quot;&gt;前一篇文章&lt;/a&gt;提到了 DAC ，但是遇到了 DAC 匯出失敗的問題，看訊息是部分資料表的因素，但是那些資料又是客戶自己的需求，所以利用 sqlserver 的產生 script 來進行結構備份紀錄，而自動化紀錄可以省時省力，此篇透過 &lt;a href=&quot;https://zh.wikipedia.org/wiki/Windows_PowerShell&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;PowerShell&lt;/a&gt; 來自動產生與處理&lt;br&gt;
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="Powershell" scheme="https://shunnien.github.io/tags/Powershell/"/>
    
  </entry>
  
  <entry>
    <title>使用 Sqlserver Data-Tier Applications 來進行備份</title>
    <link href="https://shunnien.github.io/2018/07/21/sqlserver-Data-tier-Applications/"/>
    <id>https://shunnien.github.io/2018/07/21/sqlserver-Data-tier-Applications/</id>
    <published>2018-07-21T06:10:48.000Z</published>
    <updated>2019-06-14T05:58:19.694Z</updated>
    
    <content type="html"><![CDATA[<h1 id="資料層應用程式-Data-tier-Applications"><a href="#資料層應用程式-Data-tier-Applications" class="headerlink" title="資料層應用程式 (Data-tier Applications)"></a><a href="https://docs.microsoft.com/en-us/sql/relational-databases/data-tier-applications/data-tier-applications?view=sql-server-2017" target="_blank" rel="noopener">資料層應用程式 (<strong>D</strong>ata-tier <strong>A</strong>pplications)</a></h1><p>幾日前公司 MIS 維運 Server ，一些伺服器暫時關閉，所以測試資料庫也停了；幸好有針對資料結構進行版控，只好利用 <strong>docker</strong> 直接來建立資料庫，但是有些關聯資料表的建立，由於相依另外的資料表，變成建立順序需要調整；後來測試資料庫維運完成之後，才想到這些資料結構的建立可以利用 <a href="https://docs.microsoft.com/en-us/sql/relational-databases/data-tier-applications/data-tier-applications?view=sql-server-2017" target="_blank" rel="noopener"><strong>DAC</strong></a> 來建立。<a id="more"></a></p><h2 id="DAC-定義"><a href="#DAC-定義" class="headerlink" title="DAC 定義"></a><a href="https://docs.microsoft.com/en-us/sql/relational-databases/data-tier-applications/data-tier-applications?view=sql-server-2017" target="_blank" rel="noopener">DAC</a> 定義</h2><p><a href="https://docs.microsoft.com/en-us/sql/relational-databases/data-tier-applications/data-tier-applications?view=sql-server-2017" target="_blank" rel="noopener">資料層應用程式 (<strong>D</strong>ata-tier <strong>A</strong>ppli<strong>c</strong>ations)</a> 包含完整的資料庫物件，例如：</p><ul><li>table</li><li>view</li><li>store procedure</li></ul><p>依照這些物件定義來進行資料庫的布署，其封裝檔案可以分為兩種格式：</p><ul><li><p><strong>.dacpac</strong></p><ul><li>僅資料庫結構描述</li><li><strong>用來佈署、升級資料庫 Schema 與版本</strong></li></ul></li><li><p><strong>.bacpac</strong></p><ul><li>資料庫結構描述加上資料 (檔案會較大)</li><li><strong>用來備份、還原，不能用來升級資料庫(內容包含資料庫中的資料)</strong></li></ul></li></ul><p>其實這些產生出的檔案就是一個壓縮檔，加上 <strong>.zip</strong> 副檔名，可以看出裡面有許多 <strong>XML</strong> 檔案，這些檔案來描述資料結構</p><h2 id="BACPAC-操作"><a href="#BACPAC-操作" class="headerlink" title="BACPAC 操作"></a>BACPAC 操作</h2><p>以下附上環境資訊</p><ul><li>測試使用資料庫採用 northwind 北風資料庫</li><li>sql server 2017 採用 docker <a href="https://hub.docker.com/r/microsoft/mssql-server-linux/" target="_blank" rel="noopener">microsoft/mssql-server-linux</a> 的 <strong>SQL Express edition</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ systeminfo | findstr /B /C:<span class="string">"OS Name"</span> /C:<span class="string">"OS Version"</span></span><br><span class="line">OS Name:                   Microsoft Windows 10 專業版</span><br><span class="line">OS Version:                10.0.17134 N/A Build 17134</span><br></pre></td></tr></table></figure><h3 id="匯出步驟"><a href="#匯出步驟" class="headerlink" title="匯出步驟"></a>匯出步驟</h3><p>匯出資料庫 DAC ，將資料庫 Schema 與資料封裝</p><ul><li>目標資料庫右鍵 –&gt; Tasks –&gt; Export Data-tier Application…</li></ul><p><img src="https://lh3.googleusercontent.com/hnffKad8XYVtjt9pGbnxY7X72u8MTGbLcH8Ki-W8din6aoAX3iY6lKDgVO2NYZMQOgiEL9WRKAOFXQ0hnq-2ImH1SmnXKtTH2jci9bUdEJSAtti-q2jURGbvMhWzb_e76PASher1xlg4XLsGos4t7wBLgxHZfKJN4i3NGSZVDUj7I-xiZLuqQFvFxs4v6jhzSpSxlzT2RqKCWFzH_1kpj2Hr5gcEcQPnTY-xS-09fg9UcjBjzNn_oPyFuItDCpn_rszq3Vx9YQrqoXkPkckLB8FEDY3kztj_xUZGKpljOUkLU5Eenrmibq0dRjxTkZfl8atOEL-SlPoy6FvWh1H-976Kr6SvLBcNuvBMeRlDIXeoJeb9zJby1TiQN-EOjMC7mLSmUEbySOPVILRedfQt4qSDx6GDSt0igIS3evvNES-jxCCSKocMgUo5q8wPLhFwJ6oOcRf2CnMIY-AK5Gmt00NcLxFXBUscUDekKRbEo0NKjTxXwfVo5b4RYB5ZE7esr8jidPMbOPFPHXoS5MVWDZOuKWel-en5DA07ktWHgD8aJChskWMQ9_CcBvV8caZ4iixXp41tCptjIsAQQ5BTurikY4n0fzK0rY1m70p5mLB2iKQ6DndkpaN6xEzz-igzvxdc9htmHjircQr8FzxXvP9iVCfrs0xU=w834-h915-no" alt="Export Data-tier Application"></p><ul><li>簡單的說明介紹</li></ul><p><img src="https://lh3.googleusercontent.com/RD8sMRssfFgr8zw_-u9pYG1jMr9Jd09O8iBatm7taLZal9--pZodHwhBwaLeg4D5rV6qzD-1kvc3LKoDXTVUDp4tlZgNO2fKTvHU01_4OcFpf9RlQaRNvyn9otr8rJTVkyDDgHqYS0_KWtE4WNO8sndED_pHFqXd5DQgiarUGwWSGxUJKKANL6s-YlxeVsv6r90TcnubxcLT7OFq0fKaLqKSY9ZmUm7jdLG6SI3-Aro0LZ-on06vJttrDVfOjLYOk74F6NkfTGmC_g-X8kiokEjfCooQc9Nq8aUH0FvNEBtubY-c98xRorovQdPT-BmgxhznQMjgQgFuowosYkkU4nmlKdZM0_POEWnJCE5o25gUtHmHND9CgpUL5MxSZ-XPFxUST20oI91CHFK6fRPch2_HZW3UctOsIdCgw5CylK6_t6pUfmzO_CFVNWVOVlxWWtBRGD_cvgXvnionVoWIfWHTpI65gSHjk_ZT3v33ubqSfuOd2Hv-QR8QkgZ8Z5izigX6nOPAzIltcoFdPGc3b-HNi6sk-vP5zvgkq2_bL4YIOucO4t7oeqp-8YApgi5xFSWuPxtWWDr6UAI097dVMu0Jp0_zSoY8BWBZWruxvFSHhjgMRq5aUBiQpRaR1rAxDLAXYUx49pQn2l2OOToxtBc1OhHsdXMH=w1007-h915-no" alt="Export Introduction"></p><ul><li>匯出設定</li></ul><p><img src="https://lh3.googleusercontent.com/VD2rJmNjGrW4Ok4Kb6cElMB5bZ8vKrG-uOStV_PIFhKTZyD4jzt0owZFepDDF_9IWFXDknDNhU-u_g19xw4YGf3bs9D14TNiwbu3CyplJL3zB1xygrG3MxDS8h2PiEz_34d7eNSPgipS-ZrX4P5pV-dn6lvSax0yG9IXREyVzq4ovNkKigixW4S9YtQKEW43HpuJkFhuvCRsgPkiP2ajAQhoHMuHKrYd-ZpzpFdF9D8Ed1Hi6p7EOqFrRKXxB4BOQ02lXKdJaDaOWEK-JGu8LROH0QHnNKrNNww5MuEJ4JoK336KnLXvbfmuyr1Mo-h4hxY3Uno--Qg2wDWnxDC5SPSf4QiaHndW2AMralSAdegQ4NLgwaKXw2V3XhdasqeWd1TpdhK3XEGSsqWUdv-hoNXPdSdU8hIbE32-7SRWJapvxvEPLF7L6jJMdcXWNM-0TfI4GLdrzkgCr1hcnQArvU1BCPDvZXXWb-FWqzgpvJvdOoxZcAwXruK8w9Ilg3GfYCJlwiqzg-GByX3PR0sY77BMNmpDz8gGnqLzxaqiPl4Q0FkMMZV_FFgf31GHpxzXwS1kADL8Qbp7VKCHslwgE-qni784k0IJ_Wc3kimsMnxgRl_EVHOT8hEQ8rF03-7lj_i9orh1h1PoAj5_cp0RMOBSnXU2IsIC=w1007-h915-no" alt="Export Settings"></p><ul><li>進階設定，指定匯出項目等</li></ul><p><img src="https://lh3.googleusercontent.com/vuFWuhsG8iVPLs4krBCJoIWaolFOq3TgGhgbGgzT53WpmkttGTZjH4W7hOwKrfAaCwjcqkCwZMrHjce4dS5en_EHcSwtt_57-VirvDC13q6koTbC4g9i9VmwswvH8PPSBdt0UOHfqEQID4g5dc9dcVn4Vfzbt0mcGZUCod_svs5BjGhwtpQ49fhz3oI7DybKcno4YSIyDlteOORSisid9Rrctbq9rqxe4f-epZJavWyk7wFfTb6V7uiW7jKTHg41PnXpy8LXdRDS7_jmDUiLX2H0iK7XGHhjgR3sLogETAe0OZD3VtRdoERVRFsrs9J7omtutGQ3U8ejgeupIrkxf0RRsic41tWRtVlb8hSAkPCYhcdyciUMjuLpajNv1j8gj1vk6FQGyoGaGFVUWnr9vAY-fYd1cDv_kqkn8Asz1oP4Yu-uPEAqDaplafG8RF4_dIpyiJfuoxdmK9XSUl_AZ2_h8zIga4aXGkIYOfaT6JFh8aOhl1xjN3F19OggxWm_SIMmx6uqb9YyyKTAPxRnzoUK0iLSv6Dp0xKuKOJ_Q7xFxmV45wnmFZuxd54XiIief_t6Us951xLpzVRU_BhyPfHnHi60jVv9Vz4MnX6PKkyItePDSOMk7QnDH0mAAuv8TGYieq9YUwjTzGmUTr14-KE_E1VXO91r=w1007-h915-no" alt="Export Advanced"></p><ul><li>設定總結</li></ul><p><img src="https://lh3.googleusercontent.com/Kw_T4BI6eQZNa6ugqcq1tS5YHPFwNhwEZY6CZPd4A9riznUvgCKhRVL8RVBWW9HM7jcFVIJ52EreDvx7BzBxwTUeHmeA8Fy86diS25KQMFBB1BCRF-qR4tTRGrpmU6xtH4Q0v_NschZHrJnpbsIIvw6hOEqHk1m0NzMhawLoyynTJ4C7UIbAejxbZ0EysYPufQER8XKp9kSBKUAPi4ciDQePBn4AjjEGR-w7zTujuvwzlmSUgHQiZxD6RazMgxi-jf5COMQZml97C84knTTubL8Xg0b41dRkH0eHGB6y_VukDnwncAZLkYjP0trptsehdEaE3zTG99Kl8WjjV8g82VTk9HOro_rPaoCysZlOgjvTumiJcjF6pmjBtg21GW8M1iHfVg0CM618hPsaCGiL4JlbJ2b66cdC3rBbbRHuRSAUafXblsRYFCFqhiugDNsWAiukMxEeP_O1-308GSzq-seLmjhkaJ9WtQSGlw1SCJ8ORRyglpQhFE04LjU0_Te7_UNrh6pb1ie8Vp6LAYCiFSZpyEplqpb-I-GoTXESEp-4ZITILMI1E_pvEoqf3NsAXinuENI0CrHK9Z0393ht57l-WaDXldZ6-pvyvSGr9pVduxTiTMAoo_YcKmGG7CZX74iAaxfuYqWvsFyEnOaLNM_-n6Jkp5dl=w1007-h915-no" alt="Export Summary"></p><ul><li>匯出結果</li></ul><p><img src="https://lh3.googleusercontent.com/_MkkMU6WuiIJmAELMF0aQgsNxitUj9OaTWrva716ivXig1tge48KVYmqyQ833j5824qnh3ZN-NQ8YPHybIXjDFRemqc2GpuJrEFdGi1aMvAMv7DTtJWt_i0NKepueXAjA8aT6caDCIHKNeKRnWzEUWmobU6bGZ8zbPE3gXkBhnkW16hLOUS3Jn_4SBGzNkUed8gLEBlg5AVOB1RYFNOQI6HPsQ0K0gO7qabVlDjoROt8MTWYwZP86SIjffQbr0jp9SkpXFi5wP_VPqjbrfc9Klp_L-rU6p0zkkmKgYlwoBTRYcaBTgMSYLVv12aFklQ_5n56QBS9bN3DJcKn2rEk36R2rGCWW1I4JqTYmVqKIBgu97ZMWlegIMhxRllQM7D4rRmlXgnOoO_upDJhawtjD_io3k3FBJJBavWXT3FV5smrardlZoUAAVt_mgtsQJ9LQPqvIKSpJrmwqU406NtZHyz39OGqQ4naPiHSIsj0QBVyb625qi7fVP7fy2C9IizZhHQrTGf3RwCH6M0fqv5tnNrDX2gGos-Eiyl92J16BF_2sDx4iYxM_7j5VY1aDbB7pPoxHimt96tAs9JqjBvGkbWBTOMhcqF91gR4gaiE9TT6xNqDIQCGSRCLYTZd6V2mSfrolpHq6WDXqtOWHwVmR9O51OKu47bh=w1007-h915-no" alt="Export Results1"><br><img src="https://lh3.googleusercontent.com/F0rL9wocjnhqf8i4yBhdlCjpJdZ9CqOvI6dVodf4AzUhpZ38mDoDyasMtiZ-nNcadB8l5z9PH6rhb8-Jwxq3ZOVhbs_AwUgSY21it6ry_voVAYiCc5eb4PDQ6pIJvtaNUbf97x3ADEc6vgvmURU0AsttL1oeDrbaybZfGZwDkm0ZrRJkN7cW4EMKPI6shyEXD-3M30WxhkNkqscQwCkIO5XVgWUh6P2Kyu8iqNon0WG01cP4ob3PJ4Jdo_5aK1LeQ81hRKWsv4gXjnc1fZBS2Et-LJ7I6_oL6iyoYqev2FDgzWGzWPtOEEkr3UDTjA-2DMhvrFG0HzOXaQ1z9mOG6x3Ephqa3-mLL8q0sX-2oG9dKkrPJJlqogef9nDHm3Yf9jUyw859KzzFHGd4GzcVxhbhV6up2BeGiavuSHoU6YllHH-eajgGfbLC_vP6StZGwMKlK7xpqEEbs8D-BB43ToKb6PJTmI0GbDYtssJwUz9mgws2LbIEcZWeL4aSEWBhiKK3wpYE-CPByKUww1Ubsh7oDmD8pWb_5Fu55827u00Uj06ypglWQh0q0rVfngxXf7QeS1Y26z3H_rB1kYvjnHFF47dpjx0JvP3jnljsphAFJZD7khVBW06i7fvcOkM2ten9F9vRWFoy9YXJLHVTrfZkxgq0Z1u-=w1007-h915-no" alt="Export Results2"></p><h3 id="匯入步驟"><a href="#匯入步驟" class="headerlink" title="匯入步驟"></a>匯入步驟</h3><p>使用 BACPAC 進行資料與結構匯入</p><ul><li>Databases 資料夾右鍵 –&gt; Import Data-tier Application…</li></ul><p><img src="https://lh3.googleusercontent.com/KehEgN3eVF0Fc7ly9yyyTZ22XAfX2IiP409DFd4Hzz76HhX9b13CLyto8H3BYkmlNjf9UL6FkUtlpEMQGfulW7LAnl0Fr0GbVMP_75T-K9q9dxoPRUEJRziRX0aPio2NdxLUP5kaXOOJYCvEfMSv0eG0EoTDwJl9EMmMMN54_nJbdxwUO6xlDg2CN4pnnJv3IbY3vL6hTpWa2B29HhwgY11Jnd5XsFmMsCGCQAhir6uJzRvZ7z_7aIDMi9ZSkCKk0rN3C7SivMmH1NTWfTCfGI1lvEk7qgYl24JLkEQID3jSr0_0NmOkWr_QFcFSkg-OozfryukhW1WIkf_jsQhL7h6BRju8YBs6u_Mgq1ztbmUDGLgoYZJ6-iAWcwaG17K9B1aSxzyZBln-1Qqexi_hnOTNJJPCQwVIOgLxAcTjLSHDrj4kNIDc9O5lv22qC-XzKxmZ6kZRnsUm0X0obLZLkf4a5Gj61M6EEN2k1sVm0O-GcPrhqbuxx7T42HttwLix_Q38I-otwzYL2ug3ceLAArNCQI4ldRRRLveryTj8-XnpoV_8RxpL9ZkkgzpsXX9DbuXVimQVlvBOiTe23m6b3rbFhkSdOtEr212g4ljeTffm-qxeo0QoJVsHJvfUHf5ONFnM00TGtFD_YPIl9mjJU_uxd75qegbi=w442-h399-no" alt="Import Data-tier Application"></p><ul><li>匯入介紹</li></ul><p><img src="https://lh3.googleusercontent.com/yVZJxQMsLkIf60mo_CYirOuVN29FoBQcuBvYsZf0Bguft35qT4VTdAVGdY4eZ0stloNcrrXmNBpyTUCTP7HjKjxPMr2nv8Nr5z2LclwzholLmCE_bCphapXUGmJlsC2gPTMQN7MSZ-k6mwKs32cKrj8TcSyocO1PNU6BceATrmU5E9RZH3XsHmFT9jURWakfEZeVdHkljZnRwrwVwNwKRsd936kR1I0v5B6uyY4sLsaPwF3e_uivyx6Pgg1MOkttRtv01W37auw-SaYfIz9TY7wFsYsnKs9roA1FG9kEXhIsjprJDYa7c84jEng91gRlpFbp5qJBJDiU0B0xoQY5varxLljhC224EkyA71y62k58RHHgemgiEsWkGDCheZj0DeNmRKzSXt3kXCGPwRc7ur-IH7k__hVmtGRVRlSu7XiyElI7VZjd6IWYRq8DAlgqdN3jrlT76J2wTjuf08f1twJ7ysFQczG2q-97wBSeCWOa3T3uuYYGZx3ds-8bqp1kwmIhO1TjitxjalQA4QHlIG411bBOL_FXx4ebG-c6-BW-u2GkC-FyS2PrcKW5wwgmGIgx3rsz-woKYgRF4oyUWktvHxtYevOfpHgZUT1a7SU090F581VDzS2pqGB5pmEpcbMo9N24tuCHrUIYelNVWwQXZKYosRqe=w1007-h915-no" alt="Import Introduction"></p><ul><li>匯入設定，選擇 bacpac 檔案位置</li></ul><p><img src="https://lh3.googleusercontent.com/lj6HdQr8cdIa4hsfiaLosL8MYLRrHsRUV7OB93zGJazMF3ye4mHSzlWL8GDqhk8Ev1XbO17i6GdtPrEXZN6ATJBgPxpzvUi7tLP-ocI1Ig7jZgqbwZ5-h680lP7p4qNudwVPGtx4NwEQ_h9aHG6TeyEEl4Qku-oAJFZdwd9umwenVnPeDxcLmyjmvyNhXcjdzirOxCdzo4xrN650dFnZ-uD9qApjzR_02MlS_NSYqbVuj-lT9W8nnL_x4ZkI1d1BVajBBQNYBe5h-zO3oY1OPOXPS2GHUb-XFc7pWv0xRdnLfPTe5yVavtPxrOPhdrPvijZqBVOVgYkq7l3_t4j-Jk0IQNcJ1oOkpt3m2Xa1ViM06c4EOi9mGqgP8BMbtxRMf_SGsWaQoMhpJZK-CjBv6P4vZd2BcepWO2nNkscUN9J2J_Myo5pRyZKu52WMq3bm1PQCxYCUzaKKNoKprlIEd_nvdw4ngeRRM-ftDlv9rno2S_JSw_H2S_X2hEG_Pc_rkEgw44LOSmnESQgWCBQ8O8ytYlcwfOBI7NWENFjbzDajSA71zCzu6KXu95vDsiz8swlo14KftqM6afIonS15mjw5HwdlhaojJb_RFITdUnZovVChPQwqiisr537qrbLkfMSvpy91PaAp4r6Y8Ra32Ti6XxSDTu7L=w1007-h915-no" alt="Import Settings"></p><ul><li>資料庫設定，設定資料庫名稱與檔案存放路徑等</li></ul><p><img src="https://lh3.googleusercontent.com/3n1aHUsGEaxCNXCch4tG61Jf-icLIbgq4zjHOOBsJztTKCNHRt3TSl2Fq43EPEbUDyPUIvht2mkEi9OmSO3ebrr8Es7Jh_UMOUqatc2iR1eCVlRhQzHNcYRAb4tOuHBuwpm6I1T9JfhqYGeihBokuFMHtPjBWSR0PfoIRINFjxG-VlsEDWw-XIUF_5_Vd-zxJFZdkEpUl_iDhFhkgStNiFl7FX1qtmY0vPzIy9Skf7i6FTHO42MSWm1VMcX2371YxjnnyW2xYbNK_1OxChdp8Nrpy3qvvMJ2nGPPbdipiAE6pWXmuSRUSi1i6Geak_KBskek6FrzaozI6WifDyBo3nLZk32aP6mbEbVgUiiGsyy9goSpXVzGlPC5zZlZVxDbXnqPb8bOeJOKMct6VXXeLcyd8lhmqQxrYRTMKagzKVmqeyUeJs0je6mQ2XzNtyGSmMAvNQL6IMSQ0qhXBivF0esq4YyGz5LIuyPETnveyhM7TODBZ2LE5Jg0fzRp0fkoxW-KnK_MgLIGPjXfEq5dWXSD52NQ9ekI0iqloAoRPK9KV5tB7TnZCgy-g3AQ1skupLDyhVpvnaLt7tPyVb_cOm4HP9ouJ9AxesrOA6706BHFQfWDtyOb74opKBgeZz4CjwKiBXEVkpjaWORs-EjTr3pW5mgar5mn=w1007-h915-no" alt="Import Database Settings"></p><ul><li>設定項目總結</li></ul><p><img src="https://lh3.googleusercontent.com/fQuyW8-2ZcbSq_nx04BQzPFyQjqU2YNAkYw5fGyDizQtGvyvqACvG3_TR3OrJvmba3PTGn11ELpEdC7H8u_ekmNQ9nC9DXmWpjKxQ3ppaO3CePovSCDUUgK3-oc5VkI8zJSJVb2t3i8K-Z79dcVYvXyL8Rc8sJQlaErLfNsvAeqWwWy2qDKlXQ_G5pzW4xYeo2j1r4vqcZ_BBJY6hrb64d5-ttxO4TsUq0jz3Fl-B-yfhoUXLnYhoQuMIyMT4IJ17ADiVekUcD5h8s48_m2G_aKBXKOPcY5NNUbmovidON-wvFNS92Y78YdBpF5Mv4xGirhZNxQBRa75E6WZ6xjOUUpI_StEb1bTu5u5x3DMG7A8L6TIzfY4mGD1246pT74LWgmQR4mTXlUtpnvJVsSAsfztXPZ3isTjSn9B5J4l1GwDAIOM1kEBzVz0PYCbivZLImhIAMgJI4Wv87YWhXnlsr3_KuFel4PMYrTEyPqdKP639FYMg5aUHawxU1_iHghBd3MANmiQ1PJ2B4zQgfOjrYOYFkqpyZf4_t3H0xszzb1uC45UsHbPpgbXRc9CgenAh_MUYQeoaWuAMJe3V6j85DvtHVBAnoL0SYVVvnaNU-YuDmbF5xTjMRg3-V8YKr5YAZZY4EeXrxysHngU7ImB6uEuLbzdNwYH=w1007-h915-no" alt="Import Summary"></p><ul><li>匯入結果</li></ul><p><img src="https://lh3.googleusercontent.com/nev9zcExZUboy3JSohWqdykli9SdHFYJhxUSEregMU5QYLTdu2ZLxupxfTufWKL3Wt91cT_XpawsPJBSmRNeylkISz6QJ18Yiksm-L5gL8WEn4s8ki9e0Oa1I2tqCcxs2Vj4eFUQz7zIQH82lsP3bCMtsSfx5Ho6f3DelEc5pjxL0hkXFByRz3M-qahWUjIhQyq91xyS8rXrdVe1pTBFcDUMgsqRw4f71Cl7kcE1LFkq8HfbYLX9nHHSvos7_Ta6izAAfAbz2_JfeWqy-qqCgokgcG4-I04LEXDjkcC3B34EP_J0_-DWJFLJT4SNOFtn7CTvgkjWPqea1kioQGZuJpcvmh9YIe_rGJT2gJcYPx7etnzWgB6nelJgIDhuSDtiNDRY0WsaLbYyxXbSo8TUgfBzwtnRN4Hymd7G0WT9b2KtGHDlQ3Oe8MHPVK4BiS3540LndnU2wx_905Y7ERnRQFVm2-NDIEyrCdzYI9jYKTXvrtooXk08TLEux9r0-Ef5tegiK9JSzv47JK5QnYjcEzWV6CifL5mL7APHVBIrNT04XocNOz_hDnmn8wYOgvjSiWvGTAPQ5Oq_XVRVd1ySOoyw_rqJxubnuiK_GBt_zDzJ1LRHbi2O9Sc9J6qbHyhfK4UiR4oyTcRAAvz7Y3uRfq-HflPXz0fu=w1007-h915-no" alt="Import results1"><br><img src="https://lh3.googleusercontent.com/O4eQ4B7FPwJKjhRe5dIb2Y3J1dV1JYccDS25k6LLX2DSgRJOSAygRkGaT6w-NXsJnqHwX6OHw-iPUzviZuzYgQO-TiXUYTuEJim8n-RsVLTE_mQKHm1yaQ-62DG4mWPgbCJloGPgc7wWcdt7y8dU-A5stKylmzuH-TZ-ILTr7OfXr02ve5maXE8dfrZzuj5cuigm0NKZwxNT1rgbSo7wuENtE-o1nMYH33EBbOxz4X8N2LPoVrMzZv6bkC3ujo564qsP-8Qdj5Du9WJC1E4xKQby-HbMHqhkucnOCHInYIvx0oFCLY68SdZbujV9z_xnQJtrGKvbDlPdGtT7JIctqqBQZ3gGPdUOGZbKylnPrtgdfAE351rt3rr8NDdL5MUkvzZ6KsQvqlJ5cxj6FGagN2zvw-x3jAl_gFvkJZocp1NHsYnG5L7jtsEmRpm-kKDhsDk0lWsIZpaFmvOqLokh6grFF8_V1oOBqkdB85zBzH78IfM99VmNHeXjJIMxeIL3Jp9S2jAqzpyxK1aUjCOacjrgGLjvx2ReKmuouHtnW8T761X9rtKPQDRD2ObGMrp_9fOZPhIk7Gx3-LyGEc_B8iLiC8DUeKp0P8xzPBjSSY7_DtsUUCgq2UdiWyuwQKm5T8R-Pz9vtmI7Yd_-r9cNYDegN02E_Ayv=w1007-h915-no" alt="Import Results2"></p><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://docs.microsoft.com/en-us/sql/relational-databases/data-tier-applications/data-tier-applications?view=sql-server-2017" target="_blank" rel="noopener">DAC</a></li><li><a href="https://channel9.msdn.com/Series/SQL-PASS-TAIWAN/SQL-Server-realase-management" target="_blank" rel="noopener">channel9 保哥 SQL Server 資料庫版本控管影片</a>]</li><li><a href="https://blog.yowko.com/2017/04/sql-server-dac.html" target="_blank" rel="noopener">Yowko’s Notes 各操作的 step by step 操作</a></li><li><a href="https://www.red-gate.com/simple-talk/sql/database-administration/automated-script-generation-with-powershell-and-smo/" target="_blank" rel="noopener">Powershell SMO 匯出資料結構</a></li><li><a href="https://www.slideshare.net/WillHuangTW/sql-server-49883851" target="_blank" rel="noopener">保哥 SQL Server 資料庫版本控管簡報</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;資料層應用程式-Data-tier-Applications&quot;&gt;&lt;a href=&quot;#資料層應用程式-Data-tier-Applications&quot; class=&quot;headerlink&quot; title=&quot;資料層應用程式 (Data-tier Applications)&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/sql/relational-databases/data-tier-applications/data-tier-applications?view=sql-server-2017&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;資料層應用程式 (&lt;strong&gt;D&lt;/strong&gt;ata-tier &lt;strong&gt;A&lt;/strong&gt;pplications)&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;幾日前公司 MIS 維運 Server ，一些伺服器暫時關閉，所以測試資料庫也停了；幸好有針對資料結構進行版控，只好利用 &lt;strong&gt;docker&lt;/strong&gt; 直接來建立資料庫，但是有些關聯資料表的建立，由於相依另外的資料表，變成建立順序需要調整；後來測試資料庫維運完成之後，才想到這些資料結構的建立可以利用 &lt;a href=&quot;https://docs.microsoft.com/en-us/sql/relational-databases/data-tier-applications/data-tier-applications?view=sql-server-2017&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;DAC&lt;/strong&gt;&lt;/a&gt; 來建立。
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="SQLServer" scheme="https://shunnien.github.io/tags/SQLServer/"/>
    
  </entry>
  
  <entry>
    <title>Json.net 的自訂 Serialize 與 Deserialize</title>
    <link href="https://shunnien.github.io/2018/07/06/json-net-deserialize-object/"/>
    <id>https://shunnien.github.io/2018/07/06/json-net-deserialize-object/</id>
    <published>2018-07-06T02:21:17.000Z</published>
    <updated>2019-06-14T05:58:19.693Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Json-net-的自訂序列化與反序列化"><a href="#Json-net-的自訂序列化與反序列化" class="headerlink" title="Json.net 的自訂序列化與反序列化"></a><a href="https://bridge.net/jsonnet/" target="_blank" rel="noopener">Json.net</a> 的自訂序列化與反序列化</h1><p>會使用 <a href="https://bridge.net/jsonnet/" target="_blank" rel="noopener"><strong>Json.net</strong></a> 此自訂序列化 (Serialize) 或是 反序列化 (Deserialize) 的原因主要是希望在序列化 <strong>Json</strong> 的時候，可以直接將時間的部分按照客戶要求輸出<a id="more"></a></p><p>先附上使用環境與套件版本</p><ul><li><strong>Newtonsoft.Json</strong> 版本 : <strong>10.0.2</strong></li><li>編輯器 <a href="https://www.linqpad.net/" target="_blank" rel="noopener"><strong>LINQPad</strong></a> 版本 : <strong>5.31.00(AnyCPU)</strong></li></ul><p>首先建立一個範例 <strong>Class</strong> 叫做 <strong>SampleModel</strong> ，然後利用時區讓兩個 <strong>DateTime</strong> 格式的屬性來做範例輸出</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SampleModel model = <span class="keyword">new</span> SampleModel();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 格式化輸出</span></span><br><span class="line">  <span class="keyword">var</span> indented = Newtonsoft.Json.Formatting.Indented;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> jsonModel = JsonConvert.SerializeObject(model, indented);</span><br><span class="line">  jsonModel.Dump();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Class SampleModel.</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SampleModel</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">public</span> DateTime UtcDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = DateTime.UtcNow;</span><br><span class="line">  <span class="keyword">public</span> DateTime NowDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = DateTime.Now;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://lh3.googleusercontent.com/6ZSwRiXLjv0RPKdducbzn5V03BYCTOF2ksUk4INfviiTCK4nPGXdlsG4LXKQE7j8A0EjPgGQkbCcgvPFD1H3dbyQkQbIDwx_uOf-nfEW0mIyNNWViW9r9SXNaJ8XJw-QetNFEx_SUuG5oj6wYMOyRhdt44tdTtS6j6xpYgElBCuxeQ26EX0yOv2WJyarXKdppZDFg-BZaxwq3WWlBJ92O4kerLbbkCkKgCRc9UlkhKo4AdWgrN5w2eMIK0hN90o64B5wPpVa4sV9WioqH1691tZxY9IGUb7dLUTcgiHbNRrDoVFsU5IqYU3EVFOCr8f2u4G3Mjt8lHSKg-mPDxjcLEeXKSekJhTljBlsDQKg8aXRfipgeK3t-wf7LAILzU3_o26OkafRRSL4oMZoqmUxphn9h_co1ds_sg1ZldLjaY83CyVgVNSZ1P1FcXxO46OuOrO23DNtTNMCEEM6bZGGvRGX-SXmAmNj619nY-WrsY-VBxMwsX7Uf-Hd0fNCVBr-3YHVXA6xzHn_IUglymecryqysab_clIuFy8H31m33_Ppe20-RWRKn0hFtIMxmMS4YRl9xbb83Fm9hCRRpMjUdo9dw8-3Ky5X9oQZkpUeDHkCpisdHliglbsOY36z2_BamoNj-2xTErGMMToNIs_JOOZahaLILKmI=w500-h504-no" alt="sample class serialize"></p><h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><p>承襲上述的 <strong>SampleModel</strong> ，此部分針對 <strong>Json.net</strong> 的 <strong>JsonConverter</strong> 來自訂規則，主要需要撰寫的部分有 <strong>CanConvert</strong> 與 <strong>WriteJson</strong> 兩個方法</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SampleModel model = <span class="keyword">new</span> SampleModel();</span><br><span class="line">  <span class="comment">// 格式化輸出</span></span><br><span class="line">  <span class="keyword">var</span> indented = Newtonsoft.Json.Formatting.Indented;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 設定自訂規則轉換 DateTime 格式</span></span><br><span class="line">  <span class="keyword">var</span> jsonModel = JsonConvert.SerializeObject(model, indented, <span class="keyword">new</span> SampleModelConverter(<span class="keyword">typeof</span>(DateTime)));</span><br><span class="line">  jsonModel.Dump();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Class SampleModel. 請參照上述，此處省略</span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Class SampleModelConverter.</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;seealso cref="Newtonsoft.Json.JsonConverter" /&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SampleModelConverter</span> : <span class="title">JsonConverter</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> Type[] _types;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> 建構式</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="types"&gt;</span>The types.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">SampleModelConverter</span>(<span class="params"><span class="keyword">params</span> Type[] types</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    _types = types;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> Writes the JSON representation of the object.</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="writer"&gt;</span>The <span class="doctag">&lt;see cref="T:Newtonsoft.Json.JsonWriter" /&gt;</span> to write to.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="value"&gt;</span>The value.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="serializer"&gt;</span>The calling serializer.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">WriteJson</span>(<span class="params">JsonWriter writer, <span class="keyword">object</span> <span class="keyword">value</span>, JsonSerializer serializer</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    Type type = <span class="keyword">value</span>.GetType();</span><br><span class="line">    <span class="keyword">if</span> (type == <span class="keyword">typeof</span>(DateTime))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">var</span> date = (DateTime)<span class="keyword">value</span>;</span><br><span class="line">      serializer.Serialize(writer, date.ToLocalTime().ToString(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 想寫入 json 物件，使用以下語法</span></span><br><span class="line">      <span class="comment">// writer.WriteStartObject();</span></span><br><span class="line">      <span class="comment">// writer.WritePropertyName(type.Name);</span></span><br><span class="line">      <span class="comment">// writer.WriteEndObject();</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> Reads the JSON representation of the object.</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="reader"&gt;</span>The <span class="doctag">&lt;see cref="T:Newtonsoft.Json.JsonReader" /&gt;</span> to read from.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="objectType"&gt;</span>Type of the object.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="existingValue"&gt;</span>The existing value of object being read.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="serializer"&gt;</span>The calling serializer.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>The object value.<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">object</span> <span class="title">ReadJson</span>(<span class="params">JsonReader reader, Type objectType, <span class="keyword">object</span> existingValue, JsonSerializer serializer</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> 判斷此物件是否符合自訂規則的設定型別，符合即可進行轉換</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="objectType"&gt;</span>Type of the object.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;c&gt;</span>true<span class="doctag">&lt;/c&gt;</span> if this instance can convert the specified object type; otherwise, <span class="doctag">&lt;c&gt;</span>false<span class="doctag">&lt;/c&gt;</span>.<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">bool</span> <span class="title">CanConvert</span>(<span class="params">Type objectType</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    <span class="keyword">var</span> result = _types.Any(t =&gt; t == objectType);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://lh3.googleusercontent.com/brBkvtfSaLvogg4aom4jx43gn6QOrzkftLCPssmh3tEMZNWx6f0J0GEzjGD7zaWRs1Me74cxbDHKFgOarCctLtTYBjo7EYQ2ivBrqb0s5x4dGfzmcJqBDCHO2LoAuF82Zfz79RMMMs2dclcrOnIVdFsAgFCWGMneHiKfYslciCJrPFZMrVz-JwxYd352fWWYEdYPgdpD-UFyH9BBL0ZuYwNxTGIlsiUUH7-h7271f_Y0tR_dVNMPckHruicB86vbRksaHISVN_e5ZSwpcgHgdfNy4AaB-UP9n1SBg9FGEBpz_w85dK1bj3-4Im32O2iSULgqF3-zNclA8RrSyhjKr1oA5SXjXBCjVHOH8lMXJYWiAt9MN_OB931MbyB_HBxjRzQ6rNJq8TTNOw8RiDz2YrZhAZlvF_KQu7UYOgGeUnBef9AMZTbeyKsy5h7ActjsyQYXq55Nl4o0jCr_1DNPWFkw06_JtpXpd3YZu65ZvShfcQ7oZgof3j_36hWhgvg6aPHVGkKtB5RcX8-OiRMAxxMH3eMR2jt93-p9ilMNcpsA6e7lVG4qAKbzvptcsbpdrzy6BM7-CjstvgwhkpZguMmXZbvTA-fcT19h3qs4sK7UOkyjl5sgtebbzMHCVw-bpry1qta944ZCCSoFokS43EeTfoRIqQRP=w531-h508-no" alt="serializer result"></p><h2 id="Deserialize反序列化"><a href="#Deserialize反序列化" class="headerlink" title="Deserialize反序列化"></a>Deserialize反序列化</h2><p>反序列化要注意的是要自訂 <strong>ReadJson</strong> 這個方法</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SampleModel model = <span class="keyword">new</span> SampleModel();</span><br><span class="line">  <span class="comment">// 格式化輸出</span></span><br><span class="line">  <span class="keyword">var</span> indented = Newtonsoft.Json.Formatting.Indented;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 設定自訂規則轉換 DateTime 格式</span></span><br><span class="line">  <span class="keyword">var</span> jsonModel = JsonConvert.SerializeObject(model, indented, <span class="keyword">new</span> SampleModelConverter(<span class="keyword">typeof</span>(DateTime)));</span><br><span class="line">  jsonModel.Dump();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 設定自訂規則轉換 DateTime 格式</span></span><br><span class="line">  <span class="keyword">var</span> deserializeJson = JsonConvert.DeserializeObject&lt;SampleModel&gt;(jsonModel, <span class="keyword">new</span> SampleModelConverter(<span class="keyword">typeof</span>(DateTime)));</span><br><span class="line">  deserializeJson.Dump();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Class SampleModel. 請參照上述，此處省略</span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Class SampleModelConverter.</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;seealso cref="Newtonsoft.Json.JsonConverter" /&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SampleModelConverter</span> : <span class="title">JsonConverter</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ... 其他方法與屬性同序列化的自訂，除 ReadJson 方法不同</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> Reads the JSON representation of the object.</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="reader"&gt;</span>The <span class="doctag">&lt;see cref="T:Newtonsoft.Json.JsonReader" /&gt;</span> to read from.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="objectType"&gt;</span>Type of the object.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="existingValue"&gt;</span>The existing value of object being read.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="serializer"&gt;</span>The calling serializer.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>The object value.<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">object</span> <span class="title">ReadJson</span>(<span class="params">JsonReader reader, Type objectType, <span class="keyword">object</span> existingValue, JsonSerializer serializer</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    <span class="comment">// reader Json 讀取出來的類型為 Date 格式就進行轉換</span></span><br><span class="line">    <span class="comment">// 當序列化使用此規則時，此處可以省略，因為會沒有 Date 格式</span></span><br><span class="line">    <span class="keyword">if</span> (reader.TokenType == JsonToken.Date)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> ((DateTime)existingValue).ToLocalTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (DateTime.TryParse(existingValue.ToString(), <span class="keyword">out</span> DateTime dateValue))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> dateValue.ToLocalTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://lh3.googleusercontent.com/MWk2hU-1Ghawd-_EhIG5lfp40ORJ4UWE7TkTxV3D7sg5rQ8nmrD6fOijHJ16Nz9vltNarzWIm5x1ejOYhuHYbPStgLsnv0ApxzxNIHC_cXLZflse710XeLHVQDg-rOT_Sysfy-nAIM3eAngGJ2pzElOryO20B9xbrNJhpsh43VzZ1HD5EzYqYu13UCFzOy6ZqC0LWYwZW7KJ0ElFeDlFJLRuDAuOAt4fAXkBbA5pl14556bpo0jmPCJUbwHs41-1s7PjNJmsyvZMwhnr9ObUmCMBA_6bIhuI9Kse8uehN2m8hWhYsER2xpEg3n0DYOlbRrN6sdN1ETXDGYydIwGrx50dgjZ-lHfbS4sE56aGafXcuslWGgPigmMJOVYUShW-2KdUbaVHmGIFOFF-uI-y6D6JcZS5UyVk61IH3bVSzy4Lqm-E3jnK9-BpWRIz4aTKOqzn1duO-9V3_WwJtgUMRyk-AON-py25aFbYKHwngooI2PMx_FNMiRI66bOZPNPmPklx618OFET7X402qB0bUv5sEjKXA9DhfoCo153p1AHfcnCB7ldMLSWMHQNEDmJGqc6FKFl2IcCV6DyMtDgeXXOcwmUyJ7Z0okqH-rJnRzoMresfa5nEPm2ZVMsThusEpestkmbEXvGWa97pAIdcJxxBxDsylFbz=w404-h288-no" alt="Deserialization result"></p><h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><p><a href="https://bridge.net/jsonnet/" target="_blank" rel="noopener">Json.net</a> 的 <a href="https://www.newtonsoft.com/json/help/html/CustomJsonConverter.htm" target="_blank" rel="noopener"><strong>JsonConverter</strong></a> 訂立的規則是通用的，不是針對單一型別的規則，當然此範例還可以使用 <a href="https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonSerializer_DateFormatString.htm" target="_blank" rel="noopener"><strong>JsonSerializer.DateFormatString </strong></a> 等各種方式達到目的，不過此範例重點在於自訂規則與轉換型別的部分，最後附上完整的 sample code</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SampleModel model = <span class="keyword">new</span> SampleModel();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 格式化輸出</span></span><br><span class="line">  <span class="keyword">var</span> indented = Newtonsoft.Json.Formatting.Indented;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> jsonModel = JsonConvert.SerializeObject(model, indented, <span class="keyword">new</span> SampleModelConverter(<span class="keyword">typeof</span>(DateTime)));</span><br><span class="line">  jsonModel.Dump();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> deserializeJson = JsonConvert.DeserializeObject&lt;SampleModel&gt;(jsonModel, <span class="keyword">new</span> SampleModelConverter(<span class="keyword">typeof</span>(DateTime)));</span><br><span class="line">  deserializeJson.Dump();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Class SampleModel.</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SampleModel</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">public</span> DateTime UtcDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = DateTime.UtcNow;</span><br><span class="line">  <span class="keyword">public</span> DateTime NowDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = DateTime.Now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Class SampleModelConverter.</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;seealso cref="Newtonsoft.Json.JsonConverter" /&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SampleModelConverter</span> : <span class="title">JsonConverter</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> Type[] _types;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> Initializes a new instance of the <span class="doctag">&lt;see cref="SampleModelConverter"/&gt;</span> class.</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="types"&gt;</span>The types.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">SampleModelConverter</span>(<span class="params"><span class="keyword">params</span> Type[] types</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    _types = types;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> Writes the JSON representation of the object.</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="writer"&gt;</span>The <span class="doctag">&lt;see cref="T:Newtonsoft.Json.JsonWriter" /&gt;</span> to write to.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="value"&gt;</span>The value.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="serializer"&gt;</span>The calling serializer.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">WriteJson</span>(<span class="params">JsonWriter writer, <span class="keyword">object</span> <span class="keyword">value</span>, JsonSerializer serializer</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    Type type = <span class="keyword">value</span>.GetType();</span><br><span class="line">    <span class="keyword">if</span> (type == <span class="keyword">typeof</span>(DateTime))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">var</span> date = (DateTime)<span class="keyword">value</span>;</span><br><span class="line">      serializer.Serialize(writer, date.ToLocalTime().ToString(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> Reads the JSON representation of the object.</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="reader"&gt;</span>The <span class="doctag">&lt;see cref="T:Newtonsoft.Json.JsonReader" /&gt;</span> to read from.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="objectType"&gt;</span>Type of the object.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="existingValue"&gt;</span>The existing value of object being read.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="serializer"&gt;</span>The calling serializer.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>The object value.<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">object</span> <span class="title">ReadJson</span>(<span class="params">JsonReader reader, Type objectType, <span class="keyword">object</span> existingValue, JsonSerializer serializer</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    <span class="keyword">if</span> (reader.TokenType == JsonToken.Date)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> ((DateTime)existingValue).ToLocalTime();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (DateTime.TryParse(existingValue.ToString(), <span class="keyword">out</span> DateTime dateValue))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> dateValue.ToLocalTime();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> 判斷此物件是否符合自訂規則的設定型別，符合即可進行轉換</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="objectType"&gt;</span>Type of the object.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;c&gt;</span>true<span class="doctag">&lt;/c&gt;</span> if this instance can convert the specified object type; otherwise, <span class="doctag">&lt;c&gt;</span>false<span class="doctag">&lt;/c&gt;</span>.<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">bool</span> <span class="title">CanConvert</span>(<span class="params">Type objectType</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    <span class="keyword">var</span> result = _types.Any(t =&gt; t == objectType);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="延伸閱讀"><a href="#延伸閱讀" class="headerlink" title="延伸閱讀"></a>延伸閱讀</h2><p>文中的時區轉換都比較偷懶，都是使用 <strong>ToLocalTime</strong> 等方式處理，要執行轉換的話，建議可以使用 <strong>TimeZoneInfo</strong> 來轉換，如下範例</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> twtzinfo = TimeZoneInfo.FindSystemTimeZoneById(<span class="string">"Taipei Standard Time"</span>);</span><br><span class="line">DateTime localdt = TimeZoneInfo.ConvertTime(DateTime.UtcNow,TimeZoneInfo.Utc, twtzinfo);</span><br><span class="line">DateTime localdt2 = TimeZoneInfo.ConvertTime(DateTime.UtcNow, twtzinfo);</span><br><span class="line">DateTime localdt3 = TimeZoneInfo.ConvertTimeFromUtc(DateTime.UtcNow, twtzinfo);</span><br><span class="line">localdt.Dump();</span><br><span class="line">localdt2.Dump();</span><br><span class="line">localdt3.Dump();</span><br></pre></td></tr></table></figure><p>附上拉取時區名稱與時區 ID 的作法，或是參考 <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc749073(v=ws.10)" target="_blank" rel="noopener">microsoft 時區 ID</a> 文件</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">TimeZoneInfo localZone = TimeZoneInfo.Local;</span><br><span class="line"></span><br><span class="line">Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; timeZoneIdName = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  &#123; localZone.Id, localZone.DisplayName&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">timeZoneIdName.Dump();</span><br><span class="line">ReadOnlyCollection&lt;TimeZoneInfo&gt; list = TimeZoneInfo.GetSystemTimeZones();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> zone <span class="keyword">in</span> list)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (!timeZoneIdName.ContainsKey(zone.Id))</span><br><span class="line">    timeZoneIdName.Add(zone.Id, zone.DisplayName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">timeZoneIdName.Dump();</span><br></pre></td></tr></table></figure><ul><li><a href="https://docs.microsoft.com/zh-tw/dotnet/standard/datetime/converting-between-time-zones" target="_blank" rel="noopener">microsoft docs 時區轉換時間</a></li><li><a href="https://www.newtonsoft.com/json/help/html/DeserializeDateFormatString.htm" target="_blank" rel="noopener">Newtonsoft DeserializeDateFormatString</a></li><li><a href="https://www.newtonsoft.com/json/help/html/CustomJsonConverter.htm" target="_blank" rel="noopener">Newtonsoft CustomJsonConverter</a></li><li><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc749073(v=ws.10)" target="_blank" rel="noopener">microsoft 時區 ID 參考</a></li><li><a href="https://blog.miniasp.com/post/2010/04/30/Concept-DateTime-TimeZone.aspx" target="_blank" rel="noopener">Will 保哥 .NET 日期結構(DateTime) 與 時區轉換</a></li><li><a href="http://blog.darkthread.net/post-2013-06-24-datetime-timezone-issue.aspx" target="_blank" rel="noopener">Darkthread DateTime時區與比較</a></li><li><a href="https://skrift.io/articles/archive/bulletproof-interface-deserialization-in-jsonnet/" target="_blank" rel="noopener">Bulletproof Interface Deserialization in Json.NET</a></li><li><a href="https://www.jerriepelser.com/blog/custom-converters-in-json-net-case-study-1/" target="_blank" rel="noopener">Using custom converters in JSON.NET: Array or Object?</a></li><li><a href="http://blog.maskalik.com/asp-net/json-net-implement-custom-serialization/" target="_blank" rel="noopener">JSON.NET Implementing Custom Serialization</a></li><li><a href="https://thomasfreudenberg.com/archive/2017/02/11/encrypting-values-when-serializing-with-json-net/" target="_blank" rel="noopener">Encrypting values when serializing with JSON.NET</a></li><li><a href="https://github.com/rhythmagency/formulate/blob/1e60ce07a3c6af4dd13436915bc4f3439a55a828/src/formulate.app/Serialization/FieldsJsonConverter.cs#L50" target="_blank" rel="noopener">Github 上的 Serialization</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Json-net-的自訂序列化與反序列化&quot;&gt;&lt;a href=&quot;#Json-net-的自訂序列化與反序列化&quot; class=&quot;headerlink&quot; title=&quot;Json.net 的自訂序列化與反序列化&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://bridge.net/jsonnet/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Json.net&lt;/a&gt; 的自訂序列化與反序列化&lt;/h1&gt;&lt;p&gt;會使用 &lt;a href=&quot;https://bridge.net/jsonnet/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;Json.net&lt;/strong&gt;&lt;/a&gt; 此自訂序列化 (Serialize) 或是 反序列化 (Deserialize) 的原因主要是希望在序列化 &lt;strong&gt;Json&lt;/strong&gt; 的時候，可以直接將時間的部分按照客戶要求輸出
    
    </summary>
    
      <category term="程式技術筆記" scheme="https://shunnien.github.io/categories/%E7%A8%8B%E5%BC%8F%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="C#" scheme="https://shunnien.github.io/tags/C/"/>
    
  </entry>
  
</feed>
